<!DOCTYPE html>
<html lang="en">
  <head>
    


<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="copyright" content="Keymetrics Inc." />
<meta name="description" content="Advanced process manager for production Node.js applications. Load balancer, logs facility, startup script, micro service management, at a glance.">

<meta property="og:url" content="https://pm2.keymetrics.io/docs/usage/application-declaration/" />
<meta property="og:type" content="website" />
<meta property="og:title" content="PM2 - Ecosystem File" />
<meta property="og:description" content="Advanced process manager for production Node.js applications. Load balancer, logs facility, startup script, micro service management, at a glance." />
<meta property="og:image" content="https://raw.githubusercontent.com/unitech/pm2/master/pres/pm2.20d3ef.png" />
<meta name="google-site-verification" content="ELR1mLPjKnUWvC62UIAp4fpVUvO4ToECWOK_jb922bI" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@keymetrics_io" />
<meta name="twitter:title" content="PM2 - Ecosystem File" />
<meta name="twitter:description" content="Advanced process manager for production Node.js applications. Load balancer, logs facility, startup script, micro service management, at a glance." />
<meta name="twitter:image:src" content="https://raw.githubusercontent.com/unitech/pm2/master/pres/pm2.20d3ef.png" />
<meta name="twitter:url" content="https://pm2.keymetrics.io/docs/usage/application-declaration/" />
<link rel="canonical" href="https://pm2.keymetrics.io/docs/usage/application-declaration/">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Exo:300,500,800|Roboto&display=swap">
<link rel="stylesheet" href="https://pm2.keymetrics.io/assets/main.css" />
<link rel="icon" type="image/png" href="https://pm2.keymetrics.io/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="https://pm2.keymetrics.io/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="https://pm2.keymetrics.io/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/x-icon" href="https://pm2.keymetrics.io/favicon.ico" />

<title>PM2 - Ecosystem File</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  </head>
  <body>
    <header id="menu">
  <div class="header-wrapper">
    <nav class="main-nav">
      <a href="https://pm2.keymetrics.io" title="Go to home page" class="logo-link">
        <img width="206" alt="PM2 logo" src="https://pm2.keymetrics.io/assets/pm2-logo-1.png" />
      </a>
      <div class="menu">
        <a
          title="Open menu"
          href="#menu"
          class="button accent-border border-corners inner-shadows menu-button"
        >
          <div class="menu-icon"></div>
        </a>
        <a class="menu-overlay" href="#" title="Close the menu"></a>
        <div class="menu-content">
          <div class="doc-links">
            <a
              href="https://github.com/Unitech/pm2"
              title="Github Source Code">
              Github
            </a>
            <a
              href="https://pm2.keymetrics.io/docs/usage/quick-start/"
              title="Go to Quick start"
              class=""
            >
              Quick start
            </a>
            <a
              href="https://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/"
              title="Go to Documentation"
              class=""
            >
              Documentation
            </a>
            <a
              href="https://pm2.keymetrics.io/docs/usage/use-pm2-with-cloud-providers/"
              title="Go to Integrations"
              class=""
            >
              Integrations
            </a>
          </div>
          <a
            href="https://id.keymetrics.io/api/oauth/register"
            title="Get started"
            class="button accent-border border-corners inner-shadows"
          >
            Monitor PM2
          </a>
        </div>
      </div>
    </nav>
  </div>
</header>

    <main>
      <section class="section-doc">
        <div class="section-background">
          <div class="section-wrapper">
            <div class="hexagon hexagon-1"></div>
            <div class="hexagon hexagon-2"></div>
            <div class="hexagon hexagon-3"></div>
            <div class="hexagon hexagon-4"></div>
          </div>
        </div>
        <div class="section-wrapper">
          <h1>Ecosystem File</h1>
          <div class="doc-nav-and-content">
            <nav>
              <div class="search-field">
                <input type="text" placeholder="Search" />
                <i class="fa fa-search"></i>
              </div>
              <ul>
                
                <li class="nav-section ">

                  <a class="nav-section-title" href="/docs/usage/quick-start/">Quick Start</a>

                  <ul class="nav-section-content">
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/quick-start/"
                        title="Quick Start"
                        
                      >
                        Quick Start
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/process-management/"
                        title="Process Management"
                        
                      >
                        Process Management
                      </a>
                    </li>
                    
                  </ul>
                </li>
                
                <li class="nav-section ">

                  <a class="nav-section-title" href="/docs/usage/pm2-doc-single-page/">Documentation</a>

                  <ul class="nav-section-content">
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/"
                        title="Single Page Doc"
                        
                      >
                        Single Page Doc
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/cluster-mode"
                        title="Cluster Mode"
                        
                      >
                        Cluster Mode
                      </a>
                    </li>
                    
                    <li class="nav-section-entry active">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/application-declaration/"
                        title="Ecosystem File"
                        
                      >
                        Ecosystem File
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/signals-clean-restart/"
                        title="Graceful Start/Shutdown"
                        
                      >
                        Graceful Start/Shutdown
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/environment/"
                        title="Environment Variables"
                        
                      >
                        Environment Variables
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/log-management/"
                        title="Logs"
                        
                      >
                        Logs
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/restart-strategies/"
                        title="Restart Strategies"
                        
                      >
                        Restart Strategies
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/memory-limit/"
                        title="Memory Limit Reload"
                        
                      >
                        Memory Limit Reload
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/update-pm2/"
                        title="Update PM2"
                        
                      >
                        Update PM2
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/deployment/"
                        title="Deployment"
                        
                      >
                        Deployment
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/startup/"
                        title="Startup Script"
                        
                      >
                        Startup Script
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/process-metrics/"
                        title="Custom Metrics"
                        
                      >
                        Custom Metrics
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/process-actions/"
                        title="Process Actions"
                        
                      >
                        Process Actions
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/watch-and-restart/"
                        title="Watch & Restart"
                        
                      >
                        Watch & Restart
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/monitoring/"
                        title="Monitoring"
                        
                      >
                        Monitoring
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/source-map-support/"
                        title="Source map support"
                        
                      >
                        Source map support
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/specifics/"
                        title="Specifics"
                        
                      >
                        Specifics
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/pm2-api/"
                        title="PM2 API"
                        
                      >
                        PM2 API
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/advanced/pm2-module-system/"
                        title="Module System"
                        
                      >
                        Module System
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/expose/"
                        title="Expose static file over http"
                        
                      >
                        Expose static file over http
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://github.com/Unitech/PM2/releases"
                        title="Download as ZIP"
                        
                        target="_blank"
                        
                      >
                        Download as ZIP
                      </a>
                    </li>
                    
                  </ul>
                </li>
                
                <li class="nav-section ">

                  <a class="nav-section-title" href="/docs/usage/use-pm2-with-cloud-providers/">Integrations</a>

                  <ul class="nav-section-content">
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/use-pm2-with-cloud-providers/"
                        title="Use PM2 in Cloud Providers"
                        
                      >
                        Use PM2 in Cloud Providers
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/usage/docker-pm2-nodejs/"
                        title="Docker Integration"
                        
                      >
                        Docker Integration
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/integrations/heroku/"
                        title="Heroku Integration"
                        
                      >
                        Heroku Integration
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/tutorials/pm2-nginx-production-setup"
                        title="Production Setup with Nginx"
                        
                      >
                        Production Setup with Nginx
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/tutorials/using-transpilers-with-pm2"
                        title="Using transpilers with PM2"
                        
                      >
                        Using transpilers with PM2
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/tutorials/use-pm2-with-aws-elastic-beanstalk/"
                        title="PM2 in ElasticBeanstalk"
                        
                      >
                        PM2 in ElasticBeanstalk
                      </a>
                    </li>
                    
                    <li class="nav-section-entry ">
                      <a
                        href="https://pm2.keymetrics.io/docs/tutorials/capistrano-like-deployments"
                        title="Capistrano like deployments"
                        
                      >
                        Capistrano like deployments
                      </a>
                    </li>
                    
                  </ul>
                </li>
                
              </ul>
            </nav>
            <article class="doc-content">

            <h2 id="ecosystem-file">Ecosystem File</h2>

<p>PM2 empowers your process management workflow. It allows you to fine-tune the behavior, options, environment variables, logs files of each application via a process file. It’s particularly useful for micro-service based applications.</p>

<p>Configuration format supported are Javascript, JSON and YAML.</p>

<h2 id="generate-configuration">Generate configuration</h2>

<p>To generate a sample process file you can type this command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 ecosystem
</code></pre></div></div>

<p>This will generate a sample <code class="language-plaintext highlighter-rouge">ecosystem.config.js</code>:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">apps</span> <span class="p">:</span> <span class="p">[{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">app</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">script</span><span class="p">:</span> <span class="dl">"</span><span class="s2">./app.js</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">env</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">NODE_ENV</span><span class="p">:</span> <span class="dl">"</span><span class="s2">development</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">env_production</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">NODE_ENV</span><span class="p">:</span> <span class="dl">"</span><span class="s2">production</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Once edited at your convenience you can start/restart/stop/delete this file via CLI:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pm2 <span class="o">[</span>start|restart|stop|delete] ecosystem.config.js
</code></pre></div></div>

<p>Checkout <a href="#cli">the section about acting with CLI</a> on ecosystem.config.js to know more.</p>

<h3 id="javascript-format">Javascript format</h3>

<p>You can declare multiple application easily and specify different options for each of them:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">apps</span> <span class="p">:</span> <span class="p">[{</span>
    <span class="na">name</span>        <span class="p">:</span> <span class="dl">"</span><span class="s2">worker</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">script</span>      <span class="p">:</span> <span class="dl">"</span><span class="s2">./worker.js</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">watch</span>       <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">env</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">NODE_ENV</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">development</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">env_production</span> <span class="p">:</span> <span class="p">{</span>
       <span class="dl">"</span><span class="s2">NODE_ENV</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">production</span><span class="dl">"</span>
    <span class="p">}</span>
  <span class="p">},{</span>
    <span class="na">name</span>       <span class="p">:</span> <span class="dl">"</span><span class="s2">api-app</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">script</span>     <span class="p">:</span> <span class="dl">"</span><span class="s2">./api.js</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">instances</span>  <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="na">exec_mode</span>  <span class="p">:</span> <span class="dl">"</span><span class="s2">cluster</span><span class="dl">"</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Note that using a Javascript configuration file requires to end the file name with <code class="language-plaintext highlighter-rouge">.config.js</code></strong></p>

<h3 id="yaml-format">YAML format</h3>

<p>You can also create a Ecosystem file in YAML format.
Example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apps</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">script   </span><span class="pi">:</span> <span class="s">./api.js</span>
    <span class="na">name     </span><span class="pi">:</span> <span class="s1">'</span><span class="s">api-app'</span>
    <span class="na">instances</span><span class="pi">:</span> <span class="m">4</span>
    <span class="na">exec_mode</span><span class="pi">:</span> <span class="s">cluster</span>
  <span class="pi">-</span> <span class="na">script </span><span class="pi">:</span> <span class="s">./worker.js</span>
    <span class="na">name   </span><span class="pi">:</span> <span class="s1">'</span><span class="s">worker'</span>
    <span class="na">watch  </span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">env    </span><span class="pi">:</span>
      <span class="na">NODE_ENV</span><span class="pi">:</span> <span class="s">development</span>
    <span class="na">env_production</span><span class="pi">:</span>
      <span class="na">NODE_ENV</span><span class="pi">:</span> <span class="s">production</span>
</code></pre></div></div>

<h3 id="cli">CLI</h3>

<p>Then you can run and manage your processes easily:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Start all applications</span>
pm2 start ecosystem.config.js

<span class="c"># Start only the app named worker-app</span>
pm2 start ecosystem.config.js <span class="nt">--only</span> worker-app

<span class="c"># Stop all</span>
pm2 stop ecosystem.config.js

<span class="c"># Restart all</span>
pm2 start   ecosystem.config.js
<span class="c">## Or</span>
pm2 restart ecosystem.config.js

<span class="c"># Reload all</span>
pm2 reload ecosystem.config.js

<span class="c"># Delete all</span>
pm2 delete ecosystem.config.js
</code></pre></div></div>

<h3 id="act-on-a-specific-process">Act on a specific process</h3>

<p>You can also act on a particular application by using its name and the option <code class="language-plaintext highlighter-rouge">--only &lt;app_name&gt;</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 start   ecosystem.config.js <span class="nt">--only</span> api-app
pm2 restart ecosystem.config.js <span class="nt">--only</span> api-app
pm2 reload  ecosystem.config.js <span class="nt">--only</span> api-app
pm2 delete  ecosystem.config.js <span class="nt">--only</span> api-app
</code></pre></div></div>

<p>For multiple processes use:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 start ecosystem.config.js <span class="nt">--only</span> <span class="s2">"api-app,worker-app"</span>
</code></pre></div></div>

<h3 id="switching-environments">Switching environments</h3>

<p>You may have noticed that you can declare environment-specific variables with the attribute <code class="language-plaintext highlighter-rouge">env_*</code> (e.g. env_production, env_staging…). They can be switched easily. You just need to specify the <code class="language-plaintext highlighter-rouge">--env &lt;environment_name&gt;</code> when acting on the application declaration.</p>

<p>Example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Inject what is declared in env_production</span>
pm2 start process.json <span class="nt">--env</span> production

<span class="c"># Inject what is declared in env_staging</span>
pm2 restart process.json <span class="nt">--env</span> staging
</code></pre></div></div>

<h2 id="attributes-available">Attributes available</h2>

<p>Application behavior and configuration can be fine-tuned with the following attributes:</p>

<h3 id="general">General</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Field</th>
      <th style="text-align: center">Type</th>
      <th style="text-align: center">Example</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">name</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center">“my-api”</td>
      <td style="text-align: left">application name (default to script filename without extension)</td>
    </tr>
    <tr>
      <td style="text-align: left">script</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center">”./api/app.js”</td>
      <td style="text-align: left">script path relative to pm2 start</td>
    </tr>
    <tr>
      <td style="text-align: left">cwd</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center">“/var/www/”</td>
      <td style="text-align: left">the directory from which your app will be launched</td>
    </tr>
    <tr>
      <td style="text-align: left">args</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center">“-a 13 -b 12”</td>
      <td style="text-align: left">string containing all arguments passed via CLI to script</td>
    </tr>
    <tr>
      <td style="text-align: left">interpreter</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center">“/usr/bin/python”</td>
      <td style="text-align: left">interpreter absolute path (default to node)</td>
    </tr>
    <tr>
      <td style="text-align: left">interpreter_args</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center">”–harmony”</td>
      <td style="text-align: left">option to pass to the interpreter</td>
    </tr>
    <tr>
      <td style="text-align: left">node_args</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">alias to interpreter_args</td>
    </tr>
  </tbody>
</table>

<h3 id="advanced-features">Advanced features</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Field</th>
      <th style="text-align: center">Type</th>
      <th style="text-align: center">Example</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">instances</td>
      <td style="text-align: center">number</td>
      <td style="text-align: center">-1</td>
      <td style="text-align: left">number of app instance to be launched</td>
    </tr>
    <tr>
      <td style="text-align: left">exec_mode</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">“cluster”</td>
      <td style="text-align: left">mode to start your app, can be “cluster” or “fork”, default fork</td>
    </tr>
    <tr>
      <td style="text-align: left">watch</td>
      <td style="text-align: center">boolean or []</td>
      <td style="text-align: center">true</td>
      <td style="text-align: left">enable watch &amp; restart feature, if a file change in the folder or subfolder, your app will get reloaded</td>
    </tr>
    <tr>
      <td style="text-align: left">ignore_watch</td>
      <td style="text-align: center">list</td>
      <td style="text-align: center">[”[\/\\]\./”, “node_modules”]</td>
      <td style="text-align: left">list of regex to ignore some file or folder names by the watch feature</td>
    </tr>
    <tr>
      <td style="text-align: left">max_memory_restart</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">“150M”</td>
      <td style="text-align: left">your app will be restarted if it exceeds the amount of memory specified. human-friendly format : it can be “10M”, “100K”, “2G” and so on…</td>
    </tr>
    <tr>
      <td style="text-align: left">env</td>
      <td style="text-align: center">object</td>
      <td style="text-align: center">{“NODE_ENV”: “development”, “ID”: “42”}</td>
      <td style="text-align: left">env variables which will appear in your app</td>
    </tr>
    <tr>
      <td style="text-align: left">env_<ENV_NAME></ENV_NAME></td>
      <td style="text-align: center">object</td>
      <td style="text-align: center">{“NODE_ENV”: “production”, “ID”: “89”}</td>
      <td style="text-align: left">inject <ENV_NAME> when doing pm2 restart app.yml --env <ENV_NAME></ENV_NAME></ENV_NAME></td>
    </tr>
    <tr>
      <td style="text-align: left">source_map_support</td>
      <td style="text-align: center">boolean</td>
      <td style="text-align: center">true</td>
      <td style="text-align: left">default to true, [enable/disable source map file]</td>
    </tr>
    <tr>
      <td style="text-align: left">instance_var</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">“NODE_APP_INSTANCE”</td>
      <td style="text-align: left"><a href="http://pm2.keymetrics.io/docs/usage/environment/#specific-environment-variables">see documentation</a></td>
    </tr>
    <tr>
      <td style="text-align: left">filter_env</td>
      <td style="text-align: center">array of string</td>
      <td style="text-align: center">[ “REACT_” ]</td>
      <td style="text-align: left">Excludes global variables starting with “REACT_” and will not allow their penetration into the cluster.</td>
    </tr>
  </tbody>
</table>

<h3 id="log-files">Log files</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Field</th>
      <th style="text-align: center">Type</th>
      <th style="text-align: center">Example</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">log_date_format</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center">“YYYY-MM-DD HH:mm Z”</td>
      <td style="text-align: left">log date format (see log section)</td>
    </tr>
    <tr>
      <td style="text-align: left">error_file</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">error file path (default to $HOME/.pm2/logs/XXXerr.log)</td>
    </tr>
    <tr>
      <td style="text-align: left">out_file</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">output file path (default to $HOME/.pm2/logs/XXXout.log)</td>
    </tr>
    <tr>
      <td style="text-align: left">combine_logs</td>
      <td style="text-align: center">boolean</td>
      <td style="text-align: center">true</td>
      <td style="text-align: left">if set to true, avoid to suffix logs file with the process id</td>
    </tr>
    <tr>
      <td style="text-align: left">merge_logs</td>
      <td style="text-align: center">boolean</td>
      <td style="text-align: center">true</td>
      <td style="text-align: left">alias to combine_logs</td>
    </tr>
    <tr>
      <td style="text-align: left">pid_file</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">pid file path (default to $HOME/.pm2/pid/app-pm_id.pid)</td>
    </tr>
  </tbody>
</table>

<h3 id="control-flow">Control flow</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Field</th>
      <th style="text-align: center">Type</th>
      <th style="text-align: center">Example</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">min_uptime</td>
      <td style="text-align: center">(string)</td>
      <td style="text-align: center"> </td>
      <td style="text-align: left">min uptime of the app to be considered started</td>
    </tr>
    <tr>
      <td style="text-align: left">listen_timeout</td>
      <td style="text-align: center">number</td>
      <td style="text-align: center">8000</td>
      <td style="text-align: left">time in ms before forcing a reload if app not listening</td>
    </tr>
    <tr>
      <td style="text-align: left">kill_timeout</td>
      <td style="text-align: center">number</td>
      <td style="text-align: center">1600</td>
      <td style="text-align: left">time in milliseconds before sending <a href="http://pm2.keymetrics.io/docs/usage/signals-clean-restart/#cleaning-states-and-jobs">a final SIGKILL</a></td>
    </tr>
    <tr>
      <td style="text-align: left">shutdown_with_message</td>
      <td style="text-align: center">boolean</td>
      <td style="text-align: center">false</td>
      <td style="text-align: left">shutdown an application with process.send(‘shutdown’) instead of process.kill(pid, SIGINT)</td>
    </tr>
    <tr>
      <td style="text-align: left">wait_ready</td>
      <td style="text-align: center">boolean</td>
      <td style="text-align: center">false</td>
      <td style="text-align: left">Instead of reload waiting for listen event, wait for process.send(‘ready’)</td>
    </tr>
    <tr>
      <td style="text-align: left">max_restarts</td>
      <td style="text-align: center">number</td>
      <td style="text-align: center">10</td>
      <td style="text-align: left">number of consecutive unstable restarts (less than 1sec interval or custom time via min_uptime) before your app is considered errored and stop being restarted</td>
    </tr>
    <tr>
      <td style="text-align: left">restart_delay</td>
      <td style="text-align: center">number</td>
      <td style="text-align: center">4000</td>
      <td style="text-align: left">time to wait before restarting a crashed app (in milliseconds). defaults to 0.</td>
    </tr>
    <tr>
      <td style="text-align: left">autorestart</td>
      <td style="text-align: center">boolean</td>
      <td style="text-align: center">false</td>
      <td style="text-align: left">true by default. if false, PM2 will not restart your app if it crashes or ends peacefully</td>
    </tr>
    <tr>
      <td style="text-align: left">cron_restart</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">“1 0 * * *”</td>
      <td style="text-align: left">a cron pattern to restart your app. Application must be running for cron feature to work</td>
    </tr>
    <tr>
      <td style="text-align: left">vizion</td>
      <td style="text-align: center">boolean</td>
      <td style="text-align: center">false</td>
      <td style="text-align: left">true by default. if false, PM2 will start without vizion features (versioning control metadatas)</td>
    </tr>
    <tr>
      <td style="text-align: left">post_update</td>
      <td style="text-align: center">list</td>
      <td style="text-align: center">[“npm install”, “echo launching the app”]</td>
      <td style="text-align: left">a list of commands which will be executed after you perform a Pull/Upgrade operation from Keymetrics dashboard</td>
    </tr>
    <tr>
      <td style="text-align: left">force</td>
      <td style="text-align: center">boolean</td>
      <td style="text-align: center">true</td>
      <td style="text-align: left">defaults to false. if true, you can start the same script several times which is usually not allowed by PM2</td>
    </tr>
  </tbody>
</table>

<h3 id="deployment">Deployment</h3>

<table>
  <thead>
    <tr>
      <th>Entry name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>key</td>
      <td>SSH key path</td>
      <td>String</td>
      <td>$HOME/.ssh</td>
    </tr>
    <tr>
      <td>user</td>
      <td>SSH user</td>
      <td>String</td>
      <td> </td>
    </tr>
    <tr>
      <td>host</td>
      <td>SSH host</td>
      <td>[String]</td>
      <td> </td>
    </tr>
    <tr>
      <td>ssh_options</td>
      <td>SSH options with no command-line flag, see ‘man ssh’</td>
      <td>String or [String]</td>
      <td> </td>
    </tr>
    <tr>
      <td>ref</td>
      <td>GIT remote/branch</td>
      <td>String</td>
      <td> </td>
    </tr>
    <tr>
      <td>repo</td>
      <td>GIT remote</td>
      <td>String</td>
      <td> </td>
    </tr>
    <tr>
      <td>path</td>
      <td>path in the server</td>
      <td>String</td>
      <td> </td>
    </tr>
    <tr>
      <td>pre-setup</td>
      <td>Pre-setup command or path to a script on your local machine</td>
      <td>String</td>
      <td> </td>
    </tr>
    <tr>
      <td>post-setup</td>
      <td>Post-setup commands or path to a script on the host machine</td>
      <td>String</td>
      <td> </td>
    </tr>
    <tr>
      <td>pre-deploy-local</td>
      <td>pre-deploy action</td>
      <td>String</td>
      <td> </td>
    </tr>
    <tr>
      <td>post-deploy</td>
      <td>post-deploy action</td>
      <td>String</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h2 id="considerations">Considerations</h2>

<p>All command line options passed when using the JSON app declaration will be dropped i.e.</p>

<h3 id="multiple-json">Multiple JSON</h3>

<p>You can start as many JSON application declarations as you want.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat </span>node-app-1.json
<span class="o">{</span>
  <span class="s2">"name"</span> : <span class="s2">"node-app-1"</span>,
  <span class="s2">"script"</span> : <span class="s2">"app.js"</span>,
  <span class="s2">"cwd"</span> : <span class="s2">"/srv/node-app-1/current"</span>
<span class="o">}</span>

<span class="nv">$ </span><span class="nb">cat </span>node-app-2.json
<span class="o">{</span>
  <span class="s2">"name"</span> : <span class="s2">"node-app-2"</span>,
  <span class="s2">"script"</span> : <span class="s2">"app2.js"</span>,
  <span class="s2">"cwd"</span> : <span class="s2">"/srv/node-app-2/current"</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 start node-app-1.json
pm2 start node-app-2.json
</code></pre></div></div>

<p>Will result in two apps launched:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ps aux | grep node-app
root  14735  5.8  1.1  752476  83932 ? Sl 00:08 0:00 pm2: node-app-1
root  24271  0.0  0.3  696428  24208 ? Sl 17:36 0:00 pm2: node-app-2
</code></pre></div></div>

<h3 id="cwd">CWD</h3>

<p><strong>cwd:</strong> your JSON declaration does not need to reside with your script.  If you wish to maintain the JSON(s) in a location other than your script (say, <code class="language-plaintext highlighter-rouge">/etc/pm2/conf.d/node-app.json</code>) you will need to use the <code class="language-plaintext highlighter-rouge">cwd</code> feature (Note, this can be really helpful for capistrano style directory structures that uses symlinks). Files can be either relative to the <code class="language-plaintext highlighter-rouge">cwd</code> directory, or absolute (see example below).</p>

<h3 id="clijson-options">CLI/JSON options</h3>

<p>All the keys can be used in a JSON configured file, but will remain almost the same on the command line e.g.:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exec_mode         -&gt; --execute-command
max_restarts      -&gt; --max-restarts
force             -&gt; --force
</code></pre></div></div>

<p>Using quotes to make an ESC, e.g.:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$pm2</span> start test.js <span class="nt">--node-args</span> <span class="s2">"port=3001 sitename='first pm2 app'"</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">nodeArgs</code> argument will be parsed as</p>

<pre><code class="language-JSON">[
  "port=3001",
  "sitename=first pm2 app"
]
</code></pre>

<p>but not</p>

<pre><code class="language-JSON">[
  "port=3001",
  "sitename='first",
  "pm2",
  "app'"
]
</code></pre>

<h3 id="disabling-logs">Disabling logs</h3>

<p>You can pass <code class="language-plaintext highlighter-rouge">/dev/null</code> to error_file or out_file to disable logs saving.
Note: starting PM2 <code class="language-plaintext highlighter-rouge">2.4.0</code>, <code class="language-plaintext highlighter-rouge">/dev/null</code> or <code class="language-plaintext highlighter-rouge">NULL</code> disable logs independently of the platform.</p>

<h3 id="logs-suffix">Logs suffix</h3>

<p>You can disable automatic ID suffixs on logs (e.g. <code class="language-plaintext highlighter-rouge">app-name-ID.log</code>) by passing enabling the option <code class="language-plaintext highlighter-rouge">merge_logs: true</code></p>

<h3 id="environment-definition">Environment definition</h3>

<p>You’ll need to use <code class="language-plaintext highlighter-rouge">--env &lt;envname&gt;</code> to tell pm2 to use specific environment defined inside a process file :</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"apps"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nl">"name"</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="s2">"worker"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"script"</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="s2">"./worker.js"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"watch"</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"env"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"NODE_ENV"</span><span class="p">:</span><span class="w"> </span><span class="s2">"development"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"env_production"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nl">"NODE_ENV"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},{</span><span class="w">
    </span><span class="nl">"name"</span><span class="w">       </span><span class="p">:</span><span class="w"> </span><span class="s2">"api-app"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"script"</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="s2">"./api.js"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"instances"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="nl">"exec_mode"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"cluster"</span><span class="w">
  </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>In this example, you will run <code class="language-plaintext highlighter-rouge">pm2 start ecosystem.json</code> and it will start your application with the default environment (in development so).
Then you use <code class="language-plaintext highlighter-rouge">pm2 start ecosystem.json --env production</code> and it will use the attribute <code class="language-plaintext highlighter-rouge">env_&lt;name&gt;</code> where name is <code class="language-plaintext highlighter-rouge">production</code> here, so it will start your app with <code class="language-plaintext highlighter-rouge">NODE_ENV=production</code>.</p>

<h3 id="special-ext_type">Special <code class="language-plaintext highlighter-rouge">ext_type</code></h3>

<ul>
  <li>min_uptime
Value of <code class="language-plaintext highlighter-rouge">min_uptime</code> can be:
    <ul>
      <li><strong>Number</strong>
e.g. <code class="language-plaintext highlighter-rouge">"min_uptime": 3000</code> means 3000 milliseconds.</li>
      <li><strong>String</strong>
Therefore, we are making it short and easy to configure: <code class="language-plaintext highlighter-rouge">h</code>, <code class="language-plaintext highlighter-rouge">m</code> and <code class="language-plaintext highlighter-rouge">s</code>, e.g.: <code class="language-plaintext highlighter-rouge">"min_uptime": "1h"</code> means one hour, <code class="language-plaintext highlighter-rouge">"min_uptime": "5m"</code> means five minutes and <code class="language-plaintext highlighter-rouge">"min_uptime": "10s"</code> means ten seconds (those will be transformed into milliseconds).</li>
    </ul>
  </li>
  <li>max_memory_restart
Value of <code class="language-plaintext highlighter-rouge">max_memory_restart</code> can be:
    <ul>
      <li><strong>Number</strong>
  e.g. <code class="language-plaintext highlighter-rouge">"max_memory_restart": 1024</code> means 1024 bytes (<strong>NOT BITS</strong>).</li>
      <li><strong>String</strong>
  Therefore, we are making it short and easy to configure: <code class="language-plaintext highlighter-rouge">G</code>, <code class="language-plaintext highlighter-rouge">M</code> and <code class="language-plaintext highlighter-rouge">K</code>, e.g.: <code class="language-plaintext highlighter-rouge">"max_memory_restart": "1G"</code> means one gigabyte, <code class="language-plaintext highlighter-rouge">"max_memory_restart": "5M"</code> means five megabytes and <code class="language-plaintext highlighter-rouge">"max_memory_restart": "10K"</code> means ten kilobytes (those will be transformed into byte(s)).</li>
    </ul>
  </li>
  <li>
    <p>Optional values
For example <code class="language-plaintext highlighter-rouge">exec_mode</code> can take <code class="language-plaintext highlighter-rouge">cluster</code> (<code class="language-plaintext highlighter-rouge">cluster_mode</code>) or <code class="language-plaintext highlighter-rouge">fork</code> (<code class="language-plaintext highlighter-rouge">fork_mode</code>) as possible values.</p>
  </li>
  <li>Things to know
    <ul>
      <li><code class="language-plaintext highlighter-rouge">"instances": 0</code> means that PM2 will launch the maximum processes possible according to the numbers of CPUs (cluster mode)</li>
      <li>array
<code class="language-plaintext highlighter-rouge">args</code>, <code class="language-plaintext highlighter-rouge">node_args</code> and <code class="language-plaintext highlighter-rouge">ignore_watch</code> could be type of <code class="language-plaintext highlighter-rouge">Array</code> (e.g.: <code class="language-plaintext highlighter-rouge">"args": ["--toto=heya coco", "-d", "1"]</code>) or <code class="language-plaintext highlighter-rouge">string</code> (e.g.: <code class="language-plaintext highlighter-rouge">"args": "--to='heya coco' -d 1"</code>)</li>
    </ul>
  </li>
</ul>


            <a class="edit-page-button" target="_blank" href="https://github.com/pm2-hive/pm2-hive.github.io/tree/master/docs/features/app-declaration.md" title="Edit Page">
              <i class="fa fa-2x fa-github" aria-hidden="true"></i>
              Contribute to this page
            </a>

            <div id="disqus_thread"></div>
            <script type="text/javascript">
              /* * * CONFIGURATION VARIABLES * * */
              var disqus_shortname = 'pm2';

              /* * * DON'T EDIT BELOW THIS LINE * * */
              (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </article>
          </div>
        </div>
      </section>
    </main>
    <footer>
  <div class="section-background">
    <div class="section-wrapper">
      <div class="hexagon hexagon-10"></div>
      <div class="hexagon hexagon-11"></div>
    </div>
  </div>
  <div class="section-wrapper">
    <nav class="main-nav">
      <a href="https://pm2.keymetrics.io" title="Go to home page" class="logo-link">
        <img alt="PM2 logo" src="https://pm2.keymetrics.io/assets/logo.png" />
      </a>
      <div class="doc-links">
        <a href="https://pm2.keymetrics.io/docs/usage/quick-start/" title="Go to Quick start">
          Quick start
        </a>
        <a href="https://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/" title="Go to Documentation">
          Documentation
        </a>
        <a
          href="https://pm2.keymetrics.io/docs/usage/use-pm2-with-cloud-providers/"
          title="Go to Integrations"
        >
          Integrations
        </a>
      </div>
      <div class="button-border">
        <a
          href="https://id.keymetrics.io/api/oauth/register"
          title="Get started"
          class="button accent-border border-corners big inner-shadows"
        >
          Get started
        </a>
      </div>
    </nav>
    <div class="below-nav">
      <div class="copyright">© 2019 PM2. All Rights Reserved.</div>
      <div>
        <a
          href="https://pm2.keymetrics.io/assets/terms_conditions.pdf"
          title="Open Terms of Use"
          >Terms of Use</a
        >
        //
        <a
          href="https://pm2.keymetrics.io/assets/privacy_policy.pdf"
          title="Open Privacy Policy"
          >Privacy Policy</a
        >
      </div>
    </div>
  </div>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-51734350-5', 'auto');
  ga('require', 'linkid');
  ga('send', 'pageview');
</script>


    <script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script>
      docsearch({
        apiKey: '1d274d1e258b11c96ef6cfc32455be56',
        indexName: 'keymetrics',
        inputSelector: '.search-field input',
      });
    </script>
    <script src="https://pm2.keymetrics.io/assets/docs.js"></script>
    <script src="https://pm2.keymetrics.io/assets/menu.js"></script>
  </body>
</html>
