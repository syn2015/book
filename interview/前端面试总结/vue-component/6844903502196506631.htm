<!doctype html>
<html data-n-head-ssr>
  <head >
    <title>聊聊Vue.js的template编译</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, viewport-fit=cover"><meta data-n-head="ssr" name="google-site-verification" content="cCHsgG9ktuCTgWgYfqCJql8AeR4gAne4DTZqztPoirE"><meta data-n-head="ssr" name="google-site-verification" content="nPvn9R5NJLsZKTv5VKIbn0OmkRcJ4PC6KdDoTX3n5Mw"><meta data-n-head="ssr" name="apple-itunes-app" content="app-id=987739104"><meta data-n-head="ssr" name="baidu-site-verification" content="qiK2a1kcFc"><meta data-n-head="ssr" name="360-site-verification" content="4c3c7d57d59f0e1a308462fbc7fd7e51"><meta data-n-head="ssr" name="sogou_site_verification" content="c49WUDZczQ"><meta data-n-head="ssr" name="msapplication-config" content="https://b-gold-cdn.xitu.io/favicons/v2/browserconfig.xml"><meta data-n-head="ssr" name="theme-color" content="#ffffff"><meta data-n-head="ssr" vmid="keywords" name="keywords" content="掘金,稀土,Vue.js,微信小程序,Kotlin,RxJava,React Native,Wireshark,敏捷开发,Bootstrap,OKHttp,正则表达式,WebGL,Webpack,Docker,MVVM"><meta data-n-head="ssr" vmid="description" name="description" content="掘金是一个帮助开发者成长的社区，是给开发者用的 Hacker News，给设计师用的 Designer News，和给产品经理用的 Medium。掘金的技术文章由稀土上聚集的技术大牛和极客共同编辑为你筛选出最优质的干货，其中包括：Android、iOS、前端、后端等方面的内容。用户每天都可以在这里找到技术世界的头条内容。与此同时，掘金内还有沸点、掘金翻译计划、线下活动、专栏文章等内容。即使你是 GitHub、StackOverflow、开源中国的用户，我们相信你也可以在这里有所收获。"><meta data-n-head="ssr" vmid="keywords" name="keywords" content="Vue.js,GitHub,前端,编译器"><meta data-n-head="ssr" vmid="description" name="description" content="&lt;h2 id=&quot;-&quot;&gt;写在前面&lt;/h2&gt; &lt;p&gt;因为对Vue.js很感兴趣，而且平时工作的技术栈也是Vue.js，这几个月花了些时间研究学习了一下Vue.js源码，并做了总结与输出。&lt;/p&gt; &lt;p&gt;文章的原地址：&lt;a href=&quot;https://github."><link data-n-head="ssr" rel="apple-touch-icon" sizes="180x180" href="https://b-gold-cdn.xitu.io/favicons/v2/apple-touch-icon.png"><link data-n-head="ssr" rel="icon" type="image/png" sizes="32x32" href="https://b-gold-cdn.xitu.io/favicons/v2/favicon-32x32.png"><link data-n-head="ssr" rel="icon" type="image/png" sizes="16x16" href="https://b-gold-cdn.xitu.io/favicons/v2/favicon-16x16.png"><link data-n-head="ssr" rel="manifest" href="https://b-gold-cdn.xitu.io/favicons/v2/manifest.json"><link data-n-head="ssr" rel="mask-icon" color="#5bbad5" href="https://b-gold-cdn.xitu.io/favicons/v2/safari-pinned-tab.svg"><link data-n-head="ssr" rel="shortcut icon" href="https://b-gold-cdn.xitu.io/favicons/v2/favicon.ico"><link data-n-head="ssr" rel="search" title="掘金" href="https://b-gold-cdn.xitu.io/conf/search.xml" type="application/opensearchdescription+xml"><link data-n-head="ssr" rel="stylesheet" href="https://b-gold-cdn.xitu.io/ionicons/2.0.1/css/ionicons.min.css"><link data-n-head="ssr" rel="stylesheet" href="https://b-gold-cdn.xitu.io/asset/fw-icon/1.0.9/iconfont.css"><link rel="preload" href="//s3.pstatp.com/toutiao/xitu_juejin_web/runtime.796cbbc.js" as="script"><link rel="preload" href="//s3.pstatp.com/toutiao/xitu_juejin_web/commons/app.3b100c6.js" as="script"><link rel="preload" href="//s3.pstatp.com/toutiao/xitu_juejin_web/vendors~app.204899d.js" as="script"><link rel="preload" href="//s3.pstatp.com/toutiao/xitu_juejin_web/app.093ff49.js" as="script"><link rel="preload" href="//s3.pstatp.com/toutiao/xitu_juejin_web/layouts/default.be35d34.js" as="script"><link rel="preload" href="//s3.pstatp.com/toutiao/xitu_juejin_web/commons/layouts.default.57a59a5.js" as="script"><link rel="preload" href="//s3.pstatp.com/toutiao/xitu_juejin_web/17.0da3d5d.js" as="script"><link rel="preload" href="//s3.pstatp.com/toutiao/xitu_juejin_web/commons/.7974887.js" as="script"><style data-vue-ssr-id="6d4e8b07:0 580fe052:0 19f03031:0 5c3d9f7f:0 bc0d363a:0 00da2bb5:0 0094bb9d:0 5ccbe406:0 10d680ba:0 291dc925:0 0df5c402:0 6d1bad94:0 451eb286:0 c277c556:0">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}@font-face{font-family:iconfont;src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358);src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358#iefix) format("embedded-opentype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.woff?t=1470110358) format("woff"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.ttf?t=1470110358) format("truetype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.svg?t=1470110358#iconfont) format("svg")}.iconfont{font-family:iconfont!important;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-xlcollection:before{content:"\e600"}.icon-xlchatbox:before{content:"\e601"}.markdown-body embed,.markdown-body iframe,.markdown-body img:not(.equation),.markdown-body video{max-width:100%!important;margin:0}.markdown-body li{list-style:disc outside none;list-style:initial}.markdown-body img.lazyload{visibility:hidden}.markdown-body img.inited{background-color:#f8f9fa;background-position:50%;background-repeat:no-repeat;visibility:visible}.markdown-body img.loaded{background-image:none;background-color:transparent}.markdown-body img.error{background-image:url(//s3.pstatp.com/toutiao/xitu_juejin_web/img/image-error.3338abe.png)}.markdown-body img.equation{margin:0 .1em;max-width:100%!important;vertical-align:middle}.markdown-body img:not(.equation){cursor:zoom-in}.markdown-body blockquote.warning{position:relative;border-left-color:#f75151;margin-left:8px}.markdown-body blockquote.warning:before{position:absolute;top:14px;left:-12px;background:#f75151;border-radius:50%;content:"!";width:20px;height:20px;color:#fff;display:flex;align-items:center;justify-content:center}.markdown-body pre{position:relative}.markdown-body pre>code.hljs[lang]:before{content:attr(lang);position:absolute;right:15px;top:2px;color:hsla(0,0%,54.9%,.8)}.markdown-body pre>code.hljs[lang][lang=bash]:before{content:""}.markdown-body pre>code.copyable .copy-code-btn{position:absolute;top:6px;right:15px;font-size:12px;line-height:1;cursor:pointer;color:hsla(0,0%,54.9%,.8);transition:color .1s}.markdown-body pre>code.copyable .copy-code-btn:hover{color:#8c8c8c}.markdown-body pre>code.copyable.hljs[lang]:before{right:70px}.markdown-body pre pre>code .copy-code-btn{display:none}.markdown-body pre pre>code.hljs[lang]:before{top:2px;right:15px}@media (max-width:720px){.markdown-body pre>code.copyable.hljs[lang]:before{right:1rem}}#nprogress{pointer-events:none}#nprogress .bar{background:#007fff;position:fixed;z-index:1031;top:0;left:0;width:100%;height:2px}#nprogress .peg{display:block;position:absolute;right:0;width:100px;height:100%;box-shadow:0 0 10px #007fff,0 0 5px #007fff;opacity:1;transform:rotate(3deg) translateY(-4px)}.nprogress-custom-parent{overflow:hidden;position:relative}.nprogress-custom-parent #nprogress .bar,.nprogress-custom-parent #nprogress .spinner{position:absolute}@-webkit-keyframes nprogress-spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes nprogress-spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}body{font-size:12px;line-height:normal}a,button,input{margin:initial}img{width:auto;height:auto}#juejin{overflow-x:visible;overflow-x:initial}html{font-size:12px;font-family:-apple-system,system-ui,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial;word-break:break-word;text-rendering:optimizeLegibility;color:#333;background-color:#f4f5f5}html.white{background-color:#fff}body{word-break:break-word;overflow-y:scroll}a{text-decoration:none;cursor:pointer;color:#909090}a:hover{color:#007fff}button{list-style:1}button:disabled{cursor:not-allowed}button.disabled,button.disabled:hover{background-color:#d2d2d2;cursor:not-allowed}ul{padding:0;margin:0}li{list-style:none}#juejin-seo-meta{display:none}.container{position:relative;margin:0 auto;width:100%;max-width:960px}.container:after{display:table;content:"";clear:both}.hidden{display:none}.root-view-bg{position:fixed;top:0;left:0;right:0;bottom:0;pointer-events:none;z-index:-1}.shadow{box-shadow:0 1px 2px 0 rgba(0,0,0,.05)}.align-center{text-align:center}.align-right{text-align:right}.align-middle{vertical-align:middle}.center{margin-left:auto;margin-right:auto}.text-normal{color:#333}.text-muted{color:#666}.text-muted1{color:#909090}.text-muted2{color:#838383}.text-gray{color:#909090}.text-light{color:#d2d2d2}.text-blue{color:#007fff}.text-blue-hover{color:#0371df}.text-green{color:#37c700}.text-green-hover{color:#3cb40e}.text-orange{color:#ff8900}.text-red{color:#e22323}.text-a,.text-link{cursor:pointer;color:#333}@include transition(color $speed-normal);.text-a:active,.text-a:hover,.text-link:active,.text-link:hover{color:#275b8c}.text-link{color:#259}.text-pointer{cursor:pointer}.line-wrap{white-space:pre-wrap;word-break:break-all}.ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.text-bold,b,strong{font-weight:700}.view-nav{position:fixed;top:5rem;width:100%;height:3.833rem;z-index:100;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);transition:all .2s;transform:translateZ(0)}.view-nav,.view-nav:before{left:0;background-color:#fff}.view-nav:before{content:"";position:absolute;right:0;bottom:0;height:200%;z-index:-1}.view-nav.top{transform:translate3d(0,-5rem,0)}.view-nav .nav-list{max-width:960px;height:100%;margin:auto;display:flex;align-items:center;line-height:1}.view-nav .nav-list .nav-item{height:100%;align-items:center;display:flex;flex-shrink:0;font-size:1.16rem;color:#71777c;padding:0 1rem}.view-nav .nav-list .nav-item:first-child{padding:0 1rem 0 0}.view-nav .nav-list .nav-item:last-child{padding:0 0 0 1rem}.view-nav .nav-list .nav-item.active,.view-nav .nav-list .nav-item:hover{color:#007fff}.view-nav .nav-list .nav-item a{color:inherit}.nav-item{position:relative;cursor:pointer}.nav-item>a:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0}@media (max-width:980px){.view-nav .nav-list{width:auto;overflow-x:auto}.view-nav .nav-list .nav-item:first-child,.view-nav .nav-list .nav-item:last-child{padding:0 1.5rem}}.list-header{padding:1.3rem 1rem;border-bottom:1px solid hsla(0,0%,59.2%,.1)}.list-header .list-nav,.list-header .nav-list{display:flex;justify-content:space-between}.list-header .nav-list{align-items:center;line-height:1}.list-header .nav-list .nav-item.active a,.list-header .nav-list .nav-item a:hover{color:#007fff}.list-header .left .nav-item{padding:0 1.2rem;font-size:1.16rem;border-right:1px solid hsla(0,0%,59.2%,.2)}.list-header .left .nav-item:last-child{border:none}.list-header .right .nav-item{font-size:1.16rem;padding:0 .7rem;position:relative}.list-header .right .nav-item:not(:last-child):after{width:2px;height:2px;border-radius:50%;transform:translate(-50%,-50%);content:"";position:absolute;left:100%;top:50%;background-color:#2b445d;transform:translateY(-50%);opacity:.5}@media (max-width:600px){.list-header .right{display:none}}.button,button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#007fff;color:#fff;border-radius:2px;border:none;padding:.5rem 1.3rem;outline:none;transition:background-color .3s,color .3s;cursor:pointer}.button:hover,button:hover{background-color:#0371df;color:#fff}i+span{margin-left:.6rem}button+button{margin-left:.8rem}.subscribe-btn{border:1px solid #37c700;background-color:#fff;color:#37c700;margin:1rem auto;font-size:1.1rem}.subscribe-btn:hover{background-color:#fff;color:#3cb40e;border-color:#3cb40e}.subscribe-btn.subscribed{background-color:#37c700;color:#fff}.subscribe-btn.subscribed:hover{background-color:#3cb40e}.radio-group{cursor:pointer;display:flex;align-items:center;font-size:14px}.radio-group .radio-label{margin-left:6px}input[type=radio]{width:16px;height:16px;border:1px solid #bfcbd9;border-radius:50%;background-color:#fff;cursor:pointer;box-sizing:border-box;position:relative;outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=radio]:after{width:6px;height:6px;border-radius:50%;background-color:#fff;content:"";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) scale(0);transition:transform .15s cubic-bezier(.71,-.46,.88,.6)}input[type=radio]:checked{border-color:#20a0ff;background:#3a9afc}input[type=radio]:checked:after{transform:translate(-50%,-50%) scale(1)}input[type=radio]:disabled{background-color:#eef1f6;border-color:#d1dbe5;cursor:not-allowed}input[type=radio]:disabled:checked{border-color:#d1dbe5;background-color:#d1dbe5}input[name=registerSmsCode]::-webkit-contacts-auto-fill-button{display:none;visibility:hidden}.editable,input[type=password],input[type=text],input[type=url],textarea{resize:none;outline:none;width:100%;display:block;box-shadow:none;border:1px solid #ddd;border-radius:2px;transition:border .3s;background-color:#fff;box-sizing:border-box}.aside-top-section{background-color:#fff;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);border-radius:2px;margin-bottom:1.3rem;font-size:1.16rem;line-height:1.29;color:#333}.aside-top-section .aside-header{padding:1rem 1.3rem;border-bottom:1px solid hsla(0,0%,59.2%,.1);color:#333;font-size:1.16rem}.aside-top-section .aside-list{padding:1rem 1.3rem}.aside-top-section .aside-list .item{margin-bottom:1.5rem}.busy-icon:before{-webkit-animation:busy-ani 1s linear infinite;animation:busy-ani 1s linear infinite}@-webkit-keyframes busy-ani{to{transform:rotate(1turn)}}@keyframes busy-ani{to{transform:rotate(1turn)}}
.request-health-alert[data-v-ded0787a]{position:fixed;left:2rem;bottom:2rem;padding:1rem;max-width:50%;color:#e33;background-color:#f6e3e3;border:1px solid #e99;z-index:10000}@media (max-width:600px){.request-health-alert[data-v-ded0787a]{display:none}}.title[data-v-ded0787a]{margin:0 0 .4em;font-size:1.5em}.content[data-v-ded0787a]{line-height:1.5}.btn[data-v-ded0787a]{color:inherit;text-decoration:underline;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.close[data-v-ded0787a]{position:absolute;top:0;right:0;padding:1rem;cursor:pointer;opacity:.5}.close[data-v-ded0787a]:hover{opacity:1}
.emoji-barrage .full-screen[data-v-68506677]{position:fixed;left:0;top:0;width:100%;height:100%;z-index:1001;overflow:hidden}.emoji-inner-screen[data-v-68506677]{position:absolute;left:0;width:100%;height:100%;transform:translate3d(-100%,-100%,0)}.emoji-inner-screen .template[data-v-68506677]{position:relative;width:100%;height:100%}.emojin-inner-screen__0.animate[data-v-68506677]{-webkit-animation:left-data-v-68506677 6s ease-in;animation:left-data-v-68506677 6s ease-in}.emojin-inner-screen__1.animate[data-v-68506677]{-webkit-animation:6s ease-in normal-data-v-68506677;animation:6s ease-in normal-data-v-68506677}.emojin-inner-screen__2.animate[data-v-68506677]{-webkit-animation:right-data-v-68506677 6s ease-in;animation:right-data-v-68506677 6s ease-in}@-webkit-keyframes left-data-v-68506677{0%{transform:translate3d(-50%,-100%,0)}to{transform:translate3d(0,100%,0)}}@keyframes left-data-v-68506677{0%{transform:translate3d(-50%,-100%,0)}to{transform:translate3d(0,100%,0)}}@-webkit-keyframes normal-data-v-68506677{0%{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,100%,0)}}@keyframes normal-data-v-68506677{0%{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,100%,0)}}@-webkit-keyframes right-data-v-68506677{0%{transform:translate3d(50%,-100%,0)}to{transform:translate3d(0,100%,0)}}@keyframes right-data-v-68506677{0%{transform:translate3d(50%,-100%,0)}to{transform:translate3d(0,100%,0)}}
.modal-mask[data-v-06e234c4]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.3);z-index:501}.bind-phone-number-form[data-v-06e234c4]{position:fixed;padding:1.83rem 2.08rem;width:26.5rem;max-width:100%;font-size:1.167rem;background-color:#fff;border-radius:3px;box-sizing:border-box;top:50%;left:50%;z-index:502;transform:translate(-50%,-60%);box-shadow:0 2px 3px 0 rgba(0,0,0,.2)}.close-btn[data-v-06e234c4]{float:right;cursor:pointer;opacity:.4}.close-btn[data-v-06e234c4]:hover{opacity:1}.title[data-v-06e234c4]{font-size:1.42rem;color:#000;font-weight:600;margin:0 0 1rem}.hint[data-v-06e234c4]{font-size:1.25rem;line-height:1.6;font-weight:400;color:#000;margin-bottom:2rem}.hint>a[data-v-06e234c4]{color:#007fff}.input-group[data-v-06e234c4]{margin-bottom:1.5rem}.input-box[data-v-06e234c4]{position:relative;margin-bottom:.8rem}.dropdown-box[data-v-06e234c4]{padding:0 10px;border:1px solid #d9d9d9;display:flex;border-radius:2px;justify-content:center;align-items:center}.dropdown-box .input[data-v-06e234c4]{border:none}.dropdown-box.focus[data-v-06e234c4]{border-color:#007fff}.input[data-v-06e234c4]{width:100%;border:1px solid #e9e9e9;border-radius:2px;outline:none;box-sizing:border-box;padding:.67rem .67rem .67rem 4px}.input[data-v-06e234c4]:focus{border-color:#007fff}.number-input[data-v-06e234c4]{width:74%}.btn[data-v-06e234c4]{width:100%;height:2.92rem;color:#fff;background-color:#007fff;border-radius:2px;outline:none;box-sizing:border-box;cursor:pointer}.btn[data-v-06e234c4]:disabled{background-color:#909090;cursor:default}.vcode-box[data-v-06e234c4]{display:flex;justify-content:center;align-items:center}.vcode-box .input[data-v-06e234c4]{width:auto;flex-grow:1;overflow:hidden}.vcode-box .img-vcode[data-v-06e234c4]{border:1px solid #ddd;position:relative;box-sizing:border-box;overflow:hidden;z-index:0;width:160px;color:#333;height:40px;margin-left:15px;flex-shrink:0}.vcode-box .img-vcode img[data-v-06e234c4]{max-height:46px}.vcode-box .img-vcode .hint[data-v-06e234c4]{position:absolute;z-index:-1;top:0;left:0;display:flex;height:100%;width:100%;justify-content:center;align-items:center}.send-vcode-btn[data-v-06e234c4]{position:absolute;top:0;right:0;height:100%;color:#007fff;font-size:1.25rem;line-height:1;background-color:transparent}.send-vcode-btn[data-v-06e234c4]:disabled{color:#909090;cursor:default}.send-vcode-btn[data-v-06e234c4]:hover(:not(:disabled)){opacity:.8}.masker-fade-enter-active[data-v-06e234c4],.masker-fade-leave-active[data-v-06e234c4]{transition:opacity .3s}.masker-fade-enter[data-v-06e234c4],.masker-fade-leave-to[data-v-06e234c4]{opacity:0}.form-fade-enter-active[data-v-06e234c4],.form-fade-leave-active[data-v-06e234c4]{transition:.3s}.form-fade-enter[data-v-06e234c4],.form-fade-leave-to[data-v-06e234c4]{transform:translate(-50%,-52%);opacity:0}
.dropdown-input-container[data-v-4e5eda86]{height:100%;display:flex}.dropdown-input-container input[data-v-4e5eda86]{border:none;outline:none;width:32px;margin:0;padding:0}.dropdown-input-container .dropdown-input-box[data-v-4e5eda86]:before{content:"+"}.dropdown-input-container .arrow[data-v-4e5eda86]{cursor:pointer;transition:all .45s cubic-bezier(.8,.15,.15,.86)}.dropdown-input-container .dropdown-pannel[data-v-4e5eda86]{position:absolute;width:220px;max-height:188px;border-radius:4px;box-shadow:0 2px 5px 0 rgba(0,0,0,.08);border:1px solid #e8e8e8;background-color:#fff;overflow-y:auto;z-index:200;top:40px;left:-2px}.dropdown-input-container li.item[data-v-4e5eda86]{padding:8px 10px;font-size:14px;line-height:20px;justify-content:space-between;display:flex}.dropdown-input-container li.item[data-v-4e5eda86]:hover{cursor:pointer;background-color:#f5f5f5}.dropdown-input-container li.item.selected[data-v-4e5eda86]{color:#007fff}.dropdown-input-container li>span[data-v-4e5eda86]:last-child{color:#999}
@font-face{font-family:iconfont;src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358);src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358#iefix) format("embedded-opentype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.woff?t=1470110358) format("woff"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.ttf?t=1470110358) format("truetype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.svg?t=1470110358#iconfont) format("svg")}.iconfont[data-v-064b8453]{font-family:iconfont!important;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-xlcollection[data-v-064b8453]:before{content:"\e600"}.icon-xlchatbox[data-v-064b8453]:before{content:"\e601"}.column-view[data-v-064b8453]{padding:0 0 8rem}.main-area[data-v-064b8453]{position:relative;width:700px;max-width:100%;background-color:#fff;border-radius:2px;box-sizing:border-box}.main-area[data-v-064b8453]:after{display:table;content:"";clear:both}.article-area[data-v-064b8453]{margin-bottom:1.5rem;padding:0 2rem}.article[data-v-064b8453]{margin-bottom:3rem;padding:2rem 0 0}.article-placeholder[data-v-064b8453]{width:100%}.author-info-block[data-v-064b8453]{display:flex;align-items:center;margin-bottom:2rem}.author-info-block .avatar-link[data-v-064b8453]{font-size:0}.author-info-block .avatar[data-v-064b8453]{flex:0 0 auto;margin-right:1rem;width:3.333rem;height:3.333rem;border-radius:50%}.author-info-block .author-info-box[data-v-064b8453]{min-width:0;flex-grow:1;flex:1}.author-info-block .username[data-v-064b8453]{display:inline-block;width:100%;font-size:1.3rem;font-weight:700;color:#333}.author-info-block .meta-box[data-v-064b8453]{font-size:1.1rem;color:#909090}.author-info-block .time[data-v-064b8453]{letter-spacing:1px}.author-info-block .views-count[data-v-064b8453]{margin-left:.5em}.author-info-block .dot[data-v-064b8453]{margin:0 .5em}@media (max-width:600px){.author-info-block .dot[data-v-064b8453]{margin:0 .2em}}@media (max-width:600px){.author-info-block .follow[data-v-064b8453]{margin-top:12px}}.author-info-block .edit-btn[data-v-064b8453]{color:#1264b6;cursor:pointer}.author-info-block .edit-btn[data-v-064b8453]:hover{text-decoration:underline}.article-hero[data-v-064b8453]{margin-bottom:2rem;width:100%}.article-hero[data-v-064b8453]:after{content:"";display:block;padding-top:56.29%;width:100%;pointer-events:none}.article-title[data-v-064b8453]{margin:.67em 0;font-size:2.5rem;font-weight:700;line-height:1.5}@media (max-width:600px){.article-title[data-v-064b8453]{font-size:2rem}}.article-title .audit-tag-wrap[data-v-064b8453]{transform:translateY(-.5em)}.tag-list-box[data-v-064b8453]{margin-bottom:2rem}.tag-list-box .tag-list-title[data-v-064b8453]{margin-bottom:2rem;padding:0 0 0 2rem;font-size:1.25rem;font-weight:600;color:#000;border-left:6px solid #ddd}.tag-list-box .tag-list[data-v-064b8453]{display:flex;flex-wrap:wrap}.tag-list-box .tag-list .item[data-v-064b8453]{display:flex;align-items:center;margin:0 1.25rem 1rem 0;padding:.167rem;background-color:#fff;border:1px solid #e3e3e3;border-radius:2px}.tag-list-box .tag-list .tag-icon[data-v-064b8453]{width:1.75rem;height:1.75rem;border-radius:2px}@media (max-width:600px){.tag-list-box .tag-list .tag-icon[data-v-064b8453]{display:none}}.tag-list-box .tag-list .tag-title[data-v-064b8453]{padding:0 .75rem;font-size:1rem;line-height:1.75rem;color:#919191}.wechat-banner[data-v-064b8453]{margin-bottom:2rem}@media (min-width:960px){.wechat-banner[data-v-064b8453]{display:none}}.book-box[data-v-064b8453]{margin-bottom:2rem}@media (min-width:960px){.book-box[data-v-064b8453]{display:none}}.footer-author-block[data-v-064b8453]{padding:15px 17px;border-radius:2px;background-color:#f4f5f5;margin-bottom:2rem}@media (max-width:600px){.footer-author-block[data-v-064b8453]{padding:15px 1rem}}.article-banner[data-v-064b8453]{margin-bottom:2.5rem;padding:0 0 0 2rem;border-left:6px solid #ddd}.article-banner .banner-title[data-v-064b8453]{font-size:1.3rem;line-height:1.6;color:#007fff}.article-banner .banner-content[data-v-064b8453]{margin-top:.2rem;font-size:1.1rem;line-height:1.4;color:#909090}.comment-box[data-v-064b8453]{padding:0 2rem}.comment-box.extended[data-v-064b8453]{padding-bottom:2rem}@media (max-width:600px){.comment-box[data-v-064b8453]{padding:0}}.comment-box .comment-title[data-v-064b8453]{margin-bottom:1.3rem;font-size:1.3rem;font-weight:500;text-align:center;color:#909090}.comment-box .comment-form[data-v-064b8453]{margin-bottom:1rem}.recommended-entry-list-title[data-v-064b8453]{padding:1.3rem 2rem;font-size:1.25rem;font-weight:600;color:#909090;border-bottom:1px solid rgba(178,186,194,.15)}.sidebar[data-v-064b8453]{position:absolute;top:0;right:0;width:20rem}.article-suspended-panel[data-v-064b8453]{position:fixed;margin-left:-7rem;top:16rem}.action-bar[data-v-064b8453]{position:fixed;z-index:1;bottom:0;width:100%;left:0}@media (max-width:960px){.sidebar[data-v-064b8453]{display:none}.main-area[data-v-064b8453]{width:100%}.article-area[data-v-064b8453]{margin-bottom:0}.open-in-app[data-v-064b8453]{bottom:6rem}}.border[data-v-064b8453]{border-bottom:1px solid rgba(178,186,194,.15)}
.main-header-box[data-v-6a3e47cf]{position:relative;height:5rem}.main-header[data-v-6a3e47cf]{position:fixed;top:0;left:0;right:0;transition:all .2s;transform:translate3d(0,-100%,0)}.main-header.visible[data-v-6a3e47cf]{transform:translateZ(0)}.main-container>.view[data-v-6a3e47cf]{margin-top:1.767rem}.main-container.with-view-nav>.view[data-v-6a3e47cf]{margin-top:4.67rem}.main-container.tight>.view[data-v-6a3e47cf]{margin-top:0}.main-container.tight.with-view-nav>.view[data-v-6a3e47cf]{margin-top:3.833rem}
@font-face{font-family:iconfont;src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358);src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358#iefix) format("embedded-opentype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.woff?t=1470110358) format("woff"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.ttf?t=1470110358) format("truetype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.svg?t=1470110358#iconfont) format("svg")}.iconfont[data-v-73840133]{font-family:iconfont!important;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-xlcollection[data-v-73840133]:before{content:"\e600"}.icon-xlchatbox[data-v-73840133]:before{content:"\e601"}.logo[data-v-73840133]{min-width:98px;margin-right:2rem}.nav-item a[data-v-73840133]{color:#71777c}.nav-item.active>.icon[data-v-73840133],.nav-item.active>a[data-v-73840133]{color:#007fff}.nav-item.discount[data-v-73840133]:after{content:"";position:absolute;width:35px;height:28px;background:url(//s3.pstatp.com/toutiao/xitu_juejin_web/img/half_discount.3daad5d.gif);background-size:35px 28px;right:-14px;top:10px}.nav-menu-item>a[data-v-73840133]{display:block;color:#71777c}.avatar[data-v-73840133]{width:2.5rem;height:2.5rem;position:relative}.avatar[data-v-73840133],.badge[data-v-73840133]{border-radius:50%}.badge[data-v-73840133]{position:absolute;top:10px;right:-5px;width:11px;height:11px;background-color:#2f74e9}.main-header[data-v-73840133]{background:#fff;border-bottom:1px solid #f1f1f1;color:#909090;height:5rem;z-index:250}.main-header .container[data-v-73840133]{max-width:960px;margin:auto}.container[data-v-73840133]{display:flex;align-items:center;height:100%}.main-nav[data-v-73840133]{height:100%;flex:1 0 auto}.main-nav-list[data-v-73840133]{display:flex}.phone-show-menu[data-v-73840133]{cursor:pointer;display:none}.phone-hide[data-v-73840133]{display:flex}.nav-list[data-v-73840133]{justify-content:flex-end;position:relative}.nav-item[data-v-73840133],.nav-list[data-v-73840133]{display:flex;align-items:center;height:100%;margin:0}.nav-item[data-v-73840133]{color:#71777c;padding:0 1.2rem;font-size:1.33rem;justify-content:center;cursor:pointer}.nav-item.activities .tip[data-v-73840133]{z-index:2;cursor:auto;width:17rem;background:#fff;padding:1rem;display:flex;justify-content:flex-start;position:absolute;top:4.5rem;left:-50%;margin-left:-3.7rem;color:#17181a;font-size:15px;border-radius:2px;box-shadow:0 2px 20px 0 rgba(0,0,0,.12)}.nav-item.activities .tip .panfish[data-v-73840133]{height:63px;width:57px;flex:0 0 auto;background-repeat:no-repeat;background-size:contain}.nav-item.activities .tip .content[data-v-73840133]{display:flex;flex-direction:column;padding:.5rem 0 0 .5rem;color:#17181a}.nav-item.activities .tip .content button[data-v-73840133]{padding:0;width:6.41rem;height:2rem;color:#fff;font-size:13px;border-radius:12px;margin-top:.5rem}.nav-item.activities .tip .triangle[data-v-73840133]{display:block;position:absolute;top:0;left:50%;width:1rem;height:1rem;transform:translate(-50%,-50%) rotate(45deg);background:#fff;border-top:1px solid #f4f5f5;border-left:1px solid #f4f5f5}.nav-item.activities .tip .close[data-v-73840133]{cursor:pointer;width:1rem;height:1rem;position:absolute;top:.5rem;right:.5rem;border-radius:50%;background:#fff;transform:rotate(45deg)}.nav-item.activities .tip .close[data-v-73840133]:after,.nav-item.activities .tip .close[data-v-73840133]:before{content:"";width:.8rem;height:2px;display:block;position:absolute;background:#c5c5c5;left:50%;top:50%;transform:translate(-50%,-50%)}.nav-item.activities .tip .close[data-v-73840133]:after{transform:translate(-50%,-50%) rotate(90deg)}.nav-item.activities .tip .close[data-v-73840133]:hover{opacity:.8}.nav-item .login-button[data-v-73840133]{border:1px solid #007fff;background-color:#fff;padding:.3rem 1.6rem;color:#007fff;line-height:1.9rem}.nav-item:hover>a[data-v-73840133]{color:#007fff}.nav-item[data-v-73840133]:last-child{padding-right:0}.nav-item.link-item[data-v-73840133]{padding:0 1.5rem;height:5rem}.nav-item.book.new-year a[data-v-73840133]:after{left:0;top:0;position:absolute;content:"";background-position:50%;background-repeat:no-repeat;background-size:60px auto;width:100%;height:100%}.nav-item.search[data-v-73840133]{flex:1 1 auto;justify-content:flex-end;cursor:auto}.nav-item.add[data-v-73840133]{cursor:default}.nav-item.notification:hover .icon[data-v-73840133]{color:#007fff}.nav-item.menu[data-v-73840133],.nav-item.submit[data-v-73840133]{position:relative}.nav-item.submit[data-v-73840133]{color:#007fff}.nav-item.submit[data-v-73840133]:hover{color:#0371df}.nav-item.submit[data-v-73840133]:after{content:"|";position:absolute;top:20px;left:100%;color:hsla(0,0%,59.2%,.4)}.nav-item.submit .submit-panel[data-v-73840133]{position:absolute;top:101%;left:-123px;width:326px;box-sizing:border-box;padding:2.5rem 2rem;border-radius:2px;color:#909090;font-size:1.1rem;background-color:#fff;box-shadow:0 1px 2px 0 rgba(0,0,0,.1);border:1px solid rgba(178,181,187,.5);cursor:default;z-index:11}.nav-item.submit .submit-panel[data-v-73840133]:before{content:"";position:absolute;top:0;left:50%;width:1rem;height:1rem;border-top:1px solid rgba(178,181,187,.5);border-left:1px solid rgba(178,181,187,.5);background-color:#fff;transform:rotate(45deg) translate(-50%,-50%);transform-origin:0 0}.nav-item.submit .submit-panel .title[data-v-73840133]{font-size:1.4rem;line-height:1;font-weight:700;color:#000;text-align:center;margin-bottom:2rem}.nav-item.submit .submit-panel .benefit-list[data-v-73840133]{margin-left:2rem}.nav-item.submit .submit-panel .item[data-v-73840133]{list-style:disc outside none;list-style:initial;margin-bottom:1rem}.nav-item.submit .submit-panel .link[data-v-73840133]{color:#6cbd45;text-decoration:underline}.nav-item.submit .submit-panel button[data-v-73840133]{display:block;margin:2rem auto 0;background-color:#83c73a;font-size:1.2rem;padding:1rem 4rem}.nav-item.auth[data-v-73840133]{color:#007fff;padding:0}.nav-item.auth span[data-v-73840133]:hover{color:#0371df}.nav-item.auth .login[data-v-73840133]:after{content:"·";margin:0 .4rem}.nav-item .icon[data-v-73840133]{font-size:2rem;color:#71777c}.nav-item .icon[data-v-73840133]:hover{color:#007fff}.submit-fixed-bg[data-v-73840133]{position:fixed;top:0;left:0;right:0;bottom:0;opacity:0;z-index:10}.search-form[data-v-73840133]{border:1px solid hsla(0,0%,59.2%,.2);background-color:rgba(227,231,236,.2);display:flex;align-items:center;justify-content:space-between;border-radius:2px}.search-form.active[data-v-73840133]{background-color:#fff;border:1px solid #007fff}.search-form .search-icon[data-v-73840133]{padding:0 .5rem;cursor:pointer}.search-form .search-input[data-v-73840133]{border:none;width:11rem;padding:.6rem 0 .6rem 1rem;box-shadow:none;outline:none;font-size:1.1rem;color:#666;background-color:transparent}.nav-menu[data-v-73840133]{position:absolute;width:11rem;left:50%;top:100%;transform:translateX(-50%);margin:0;padding:0;list-style:none;background-color:#fff;box-shadow:0 1px 2px 0 rgba(0,0,0,.1);border:1px solid rgba(177,180,185,.45);border-radius:4px;font-size:1.2rem}.nav-menu .nav-menu-item-group[data-v-73840133]{padding:1rem 0}.nav-menu .nav-menu-item[data-v-73840133]{font-size:1.3rem;cursor:pointer}.nav-menu .nav-menu-item[data-v-73840133]:hover{background-color:hsla(0,0%,94.9%,.5)}.nav-menu .nav-menu-item>a[data-v-73840133]{display:flex;align-items:center;padding:.5rem 1rem}.nav-menu .nav-menu-item>a>span[data-v-73840133]{margin-left:0;flex-grow:1}.nav-menu .nav-menu-item>a.link-icon[data-v-73840133]{padding-right:.5rem}.nav-menu .nav-menu-item .collect[data-v-73840133],.nav-menu .nav-menu-item .zan[data-v-73840133]{margin-right:.8rem;width:18.72px;height:18px}.nav-menu .nav-menu-item .icon-2018[data-v-73840133]{width:38px;height:20px;border-radius:1rem;margin-left:2px;background-image:url(https://gold-cdn.xitu.io/asset/2018/2018-icon.png);background-size:102% 100%;background-repeat:no-repeat;box-shadow:3px 3px 6px -3px #999}.nav-menu .nav-menu-item .icon-2018[data-v-73840133]:hover{opacity:.9}.nav-menu .more[data-v-73840133]{position:relative}.nav-menu .more:hover .more-dropdown-list[data-v-73840133]{display:block}.nav-menu .more .more-icon[data-v-73840133]{float:right;color:#b2bac2;font-size:1.2rem;line-height:2rem}.nav-menu.user-dropdown-list[data-v-73840133]{width:13.1rem;right:0;left:auto;transform:translateX(0)}.nav-menu.user-dropdown-list .nav-menu-item-group[data-v-73840133]:not(:last-child){border-bottom:1px solid rgba(0,0,0,.04)}.add-group[data-v-73840133]{display:flex;align-items:center;position:relative;height:2.667rem;cursor:pointer}.add-group.active .more-list[data-v-73840133]{display:block}.add-group .add-btn[data-v-73840133],.add-group .more[data-v-73840133]{height:100%;color:#fff;background-color:#007fff;border-radius:3px}.add-group .add-btn.active[data-v-73840133],.add-group .add-btn[data-v-73840133]:hover,.add-group .more.active[data-v-73840133],.add-group .more[data-v-73840133]:hover{background-color:#0876e4}.add-group .add-btn[data-v-73840133]{padding:0 .9rem;font-size:1.167rem;border-top-right-radius:0;border-bottom-right-radius:0}.add-group .more[data-v-73840133]{flex:0 0 auto;display:flex;align-items:center;justify-content:center;width:1.25rem;border-left:1px solid hsla(0,0%,100%,.1);border-top-left-radius:0;border-bottom-left-radius:0}.add-group .more .more-icon[data-v-73840133]{margin-top:.2rem;font-size:1rem}.add-group .more-list[data-v-73840133]{position:absolute;top:100%;left:0;right:0;padding:.417rem 0;font-size:1.167rem;color:#3b76c5;background-color:#fff;border:1px solid #ebebeb;border-radius:2px;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);display:none;z-index:1}.add-group .more-list .item[data-v-73840133]{padding:0 0 0 .8rem;line-height:1.9}.add-group .more-list .item[data-v-73840133]:hover{background-color:#f9f9f9}.more-dropdown-list[data-v-73840133]{position:absolute;left:auto;top:0;right:102%;transform:translateX(0);display:none}.more-dropdown-list[data-v-73840133]:after{content:"";position:absolute;top:0;left:100%;width:1.3rem;height:4rem}.notification[data-v-73840133]{position:relative}.notification.active .icon[data-v-73840133]{color:#007fff}.notification .count[data-v-73840133]{position:absolute;left:50%;bottom:43%;margin:0;font-size:1rem;line-height:1;text-align:center;background-color:#007fff;border-radius:3rem;word-break:normal;display:inline-block;color:#f1f1f1;transform:scale(.8);font-size:13px;font-weight:500;padding:3px 6px;background:#f03535;border-radius:100px;border:2px solid #fff}.fengwei[data-v-73840133]{display:inline-block;width:1em;height:1em;margin-right:.8rem;font-size:1.2em;vertical-align:middle;color:#b2bac2}.fix-bg[data-v-73840133]{position:fixed;top:0;left:0;bottom:0;right:0;opacity:0}.mobile[data-v-73840133]{display:none}@media (max-width:980px){.logo[data-v-73840133]{margin-right:0;margin-left:.67rem}.container[data-v-73840133]{width:96%}.main-nav-list[data-v-73840133]{display:block;position:absolute;left:0;top:0;background-color:#fff;z-index:1}.phone-show-menu[data-v-73840133]{height:5rem;display:flex;align-items:center;color:#007fff;font-size:1.33rem;justify-content:center;padding:0;width:5.66rem}.phone-show-menu span[data-v-73840133]{margin-right:.6rem}.phone-hide[data-v-73840133]{display:none;background-color:#fff;box-shadow:0 1px 2px 0 rgba(0,0,0,.1);border:1px solid rgba(177,180,185,.45);border-radius:4px;font-size:1.2rem}.phone-hide.show[data-v-73840133]{display:block}.nav-item.link-item[data-v-73840133]{height:4rem}.nav-item.add[data-v-73840133],.nav-item.submit[data-v-73840133],.pinTip[data-v-73840133]{display:none}.tip[data-v-73840133]{display:none!important}.nav-menu .nav-menu-item .icon-2018[data-v-73840133]{width:35px;margin-left:0}}@media (max-width:700px){.nav-item.search[data-v-73840133]{display:flex;padding-right:1.2rem}.nav-item .search-form .search-input[data-v-73840133]{width:11rem;padding:.6rem}.nav-item .search-form .search-icon[data-v-73840133]{display:none}.logo[data-v-73840133]{min-width:3.75rem}.logo-img[data-v-73840133]{display:none}.mobile[data-v-73840133]{display:block}.notification[data-v-73840133]{padding:0 .8rem}}@media (max-width:375px){.nav-item .search-form .search-input[data-v-73840133]{width:10rem}}@media (max-width:330px){.nav-item.search[data-v-73840133]{display:none}.nav-item.search .search-form .search-input[data-v-73840133]{width:5rem}}.tip-fade-enter-active[data-v-73840133],.tip-fade-leave-active[data-v-73840133]{transition:.3s}.tip-fade-enter[data-v-73840133],.tip-fade-leave-to[data-v-73840133]{transform:translateY(-10px);opacity:0}
.avatar[data-v-1c418ef0]{display:inline-block;position:relative;background-size:cover;background-color:#eee}.avatar[data-v-1c418ef0],.avatar.xmas[data-v-1c418ef0]:after{background-position:50%;background-repeat:no-repeat}.avatar.xmas[data-v-1c418ef0]:after{content:"";position:absolute;left:25%;bottom:30%;width:90%;height:90%;background-size:contain;background-image:url(//s3.pstatp.com/toutiao/xitu_juejin_web/img/hats.12a740a.svg);transform:rotate(15deg);transform-origin:bottom right;transition:all .2s}.avatar.xmas[data-v-1c418ef0]:hover:after{transform:rotate(20deg)}
.lazy[data-v-47cc2604]{position:relative}.lazy[data-v-47cc2604]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:inherit;border-radius:inherit}.lazy[data-v-47cc2604]:not(.immediate):before{transition:opacity .2s}.lazy.loaded[data-v-47cc2604]:before{opacity:0;pointer-events:none}
.username[data-v-1b6b7cba]{font-size:1.25rem;font-weight:600;color:#2e3135}.username .name[data-v-1b6b7cba]{display:inline-block;vertical-align:top;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.recommend-author-block .username .name[data-v-1b6b7cba]{max-width:130px}.recommendation-index-view .username .name[data-v-1b6b7cba]{max-width:200px}
.follow-button[data-v-06c7d5b3]{margin:0 0 0 auto;padding:0;width:55px;height:26px;font-size:13px;border:1px solid #6cbd45;color:#6cbd45;background-color:#fff}.follow-button[data-v-06c7d5b3]:hover{opacity:.8}.follow-button.followed[data-v-06c7d5b3]{color:#fff;border-color:#6cbd45;background-color:#6cbd45}
[data-v-78c9b824] .image-viewer{position:fixed;top:0;left:0;right:0;bottom:0;z-index:10000}[data-v-78c9b824] .image-viewer.loading:after{content:"";position:absolute;top:0;right:100%;width:50%;height:.2rem;background-color:#007fff;z-index:1;-webkit-animation:pro-data-v-78c9b824 1s ease-in-out infinite;animation:pro-data-v-78c9b824 1s ease-in-out infinite;-webkit-animation-delay:1s;animation-delay:1s}@-webkit-keyframes pro-data-v-78c9b824{0%{transform:translateZ(0)}to{transform:translate3d(300%,0,0)}}@keyframes pro-data-v-78c9b824{0%{transform:translateZ(0)}to{transform:translate3d(300%,0,0)}}
.panel-btn[data-v-19356a56]{position:relative;margin-bottom:.75rem;width:3rem;height:3rem;background-color:#fff;background-position:50%;background-repeat:no-repeat;border-radius:50%;box-shadow:0 2px 4px 0 rgba(0,0,0,.04);cursor:pointer}.panel-btn:not(.share-btn).active.with-badge[data-v-19356a56]:after{background-color:#74ca46}.panel-btn.with-badge[data-v-19356a56]:after{content:attr(badge);position:absolute;top:0;left:75%;padding:.1rem .4rem;font-size:1rem;text-align:center;line-height:1;white-space:nowrap;color:#fff;background-color:#b2bac2;border-radius:.7rem;transform-origin:left top;transform:scale(.75)}.panel-btn.like-btn[data-v-19356a56]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNSIgdmlld0JveD0iMCAwIDE2IDE1Ij4KICAgIDxwYXRoIGZpbGw9IiNCMkJBQzIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTIuODc0IDYuMDQ0VjE1aC0xLjczQy41MTMgMTUgMCAxNC4zODIgMCAxMy42MjRWNy41MjljMC0uNzkuNTM1LTEuNDg1IDEuMTQzLTEuNDg1aDEuNzMxek03LjYwNyAxLjI1QzcuNzIuNTA3IDguMzQ0LS4wMTMgOS4wMyAwYy45OC4wMTkgMS41NjMuODMzIDEuNzY2IDEuMjM1LjM3LjczNS4zOCAxLjk0Ni4xMjYgMi43MjQtLjIzLjcwNC0uNzYxIDEuNjI5LS43NjEgMS42MjloMy45ODJjLjQyIDAgLjgxMS4yMDYgMS4wNzIuNTYzYTEuNSAxLjUgMCAwIDEgLjIzMiAxLjI3MmwtMS44MDEgNi41MTNjLS4xNjQuNjI3LS43MDcgMS4wNjQtMS4zMiAxLjA2NEg0LjVWNS44OThDNi4yOTkgNS41MSA3LjQwNCAyLjU5IDcuNjA3IDEuMjQ5eiIvPgo8L3N2Zz4K)}.panel-btn.like-btn[data-v-19356a56]:hover{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNSIgdmlld0JveD0iMCAwIDE2IDE1Ij4KICAgIDxwYXRoIGZpbGw9IiM4QTkzQTAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTIuODc0IDYuMDQ0VjE1aC0xLjczQy41MTMgMTUgMCAxNC4zODIgMCAxMy42MjRWNy41MjljMC0uNzkuNTM1LTEuNDg1IDEuMTQzLTEuNDg1aDEuNzMxek03LjYwNyAxLjI1QzcuNzIuNTA3IDguMzQ0LS4wMTMgOS4wMyAwYy45OC4wMTkgMS41NjMuODMzIDEuNzY2IDEuMjM1LjM3LjczNS4zOCAxLjk0Ni4xMjYgMi43MjQtLjIzLjcwNC0uNzYxIDEuNjI5LS43NjEgMS42MjloMy45ODJjLjQyIDAgLjgxMS4yMDYgMS4wNzIuNTYzYTEuNSAxLjUgMCAwIDEgLjIzMiAxLjI3MmwtMS44MDEgNi41MTNjLS4xNjQuNjI3LS43MDcgMS4wNjQtMS4zMiAxLjA2NEg0LjVWNS44OThDNi4yOTkgNS41MSA3LjQwNCAyLjU5IDcuNjA3IDEuMjQ5eiIvPgo8L3N2Zz4K)}.panel-btn.like-btn.active[data-v-19356a56]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNSIgdmlld0JveD0iMCAwIDE2IDE1Ij4KICAgIDxwYXRoIGZpbGw9IiM2Q0JENDUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTIuODc0IDYuMDQ0VjE1aC0xLjczQy41MTMgMTUgMCAxNC4zODIgMCAxMy42MjRWNy41MjljMC0uNzkuNTM1LTEuNDg1IDEuMTQzLTEuNDg1aDEuNzMxek03LjYwNyAxLjI1QzcuNzIuNTA3IDguMzQ0LS4wMTMgOS4wMyAwYy45OC4wMTkgMS41NjMuODMzIDEuNzY2IDEuMjM1LjM3LjczNS4zOCAxLjk0Ni4xMjYgMi43MjQtLjIzLjcwNC0uNzYxIDEuNjI5LS43NjEgMS42MjloMy45ODJjLjQyIDAgLjgxMS4yMDYgMS4wNzIuNTYzYTEuNSAxLjUgMCAwIDEgLjIzMiAxLjI3MmwtMS44MDEgNi41MTNjLS4xNjQuNjI3LS43MDcgMS4wNjQtMS4zMiAxLjA2NEg0LjVWNS44OThDNi4yOTkgNS41MSA3LjQwNCAyLjU5IDcuNjA3IDEuMjQ5eiIvPgo8L3N2Zz4K)}.panel-btn.like-btn.like-adjust[data-v-19356a56]{background-position:53% 46%}.panel-btn.comment-btn[data-v-19356a56]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNCIgaGVpZ2h0PSIxMyIgdmlld0JveD0iMCAwIDE0IDEzIj4KICAgIDxwYXRoIGZpbGw9IiNCMkJBQzIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTE0IDB2OS4yM0g4LjgxNUwzLjM3IDEzVjkuMjNIMFYweiIvPgo8L3N2Zz4K)}.panel-btn.comment-btn[data-v-19356a56]:hover{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNCIgaGVpZ2h0PSIxMyIgdmlld0JveD0iMCAwIDE0IDEzIj4KICAgIDxwYXRoIGZpbGw9IiM4QTkzQTAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTE0IDB2OS4yM0g4LjgxNUwzLjM3IDEzVjkuMjNIMFYweiIvPgo8L3N2Zz4K)}.panel-btn.comment-btn.comment-adjust[data-v-19356a56]{background-position:50% 55%}.panel-btn.collect-btn[data-v-19356a56]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNyIgaGVpZ2h0PSIxNyIgdmlld0JveD0iMCAwIDE3IDE3Ij4KICAgIDxwYXRoIGZpbGw9IiNCMkJBQzIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTkuMzMyIDE0Ljk2OGMtLjQ2LS4yNTUtMS4yMDUtLjI1NS0xLjY2NiAwTDQuMzUgMTYuNzk0Yy0uOTIxLjUwNi0xLjUyMy4wNDQtMS4zNDktMS4wMjdsLjYzNS0zLjg2N2MuMDg4LS41MzctLjE0Mi0xLjI4LS41MTYtMS42NkwuNDM2IDcuNWMtLjc0NS0uNzYtLjUxMS0xLjUwNC41MTYtMS42NmwzLjcwNy0uNTY0Yy41MTQtLjA4IDEuMTE5LS41MzggMS4zNDgtMS4wMjdMNy42NjUuNzMxYy40NjItLjk3NiAxLjIwOC0uOTczIDEuNjY3IDBsMS42NiAzLjUxOWMuMjMuNDg5LjgzMy45NSAxLjM0OSAxLjAyN2wzLjcwOC41NjRjMS4wMjkuMTU2IDEuMjU4LjkwMi41MTUgMS42NmwtMi42ODUgMi43MzljLS4zNzIuMzgtLjYwMyAxLjEyMy0uNTE1IDEuNjZsLjYzNCAzLjg2N2MuMTc2IDEuMDc0LS40MyAxLjUzMy0xLjM0OCAxLjAyN2wtMy4zMTgtMS44MjZ6Ii8+Cjwvc3ZnPgo=)}.panel-btn.collect-btn[data-v-19356a56]:hover{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNyIgaGVpZ2h0PSIxNyIgdmlld0JveD0iMCAwIDE3IDE3Ij4KICAgIDxwYXRoIGZpbGw9IiM4QTkzQTAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTkuMzMyIDE0Ljk2OGMtLjQ2LS4yNTUtMS4yMDUtLjI1NS0xLjY2NiAwTDQuMzUgMTYuNzk0Yy0uOTIxLjUwNi0xLjUyMy4wNDQtMS4zNDktMS4wMjdsLjYzNS0zLjg2N2MuMDg4LS41MzctLjE0Mi0xLjI4LS41MTYtMS42NkwuNDM2IDcuNWMtLjc0NS0uNzYtLjUxMS0xLjUwNC41MTYtMS42NmwzLjcwNy0uNTY0Yy41MTQtLjA4IDEuMTE5LS41MzggMS4zNDgtMS4wMjdMNy42NjUuNzMxYy40NjItLjk3NiAxLjIwOC0uOTczIDEuNjY3IDBsMS42NiAzLjUxOWMuMjMuNDg5LjgzMy45NSAxLjM0OSAxLjAyN2wzLjcwOC41NjRjMS4wMjkuMTU2IDEuMjU4LjkwMi41MTUgMS42NmwtMi42ODUgMi43MzljLS4zNzIuMzgtLjYwMyAxLjEyMy0uNTE1IDEuNjZsLjYzNCAzLjg2N2MuMTc2IDEuMDc0LS40MyAxLjUzMy0xLjM0OCAxLjAyN2wtMy4zMTgtMS44MjZ6Ii8+Cjwvc3ZnPgo=)}.panel-btn.collect-btn.active[data-v-19356a56]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNyIgaGVpZ2h0PSIxNyIgdmlld0JveD0iMCAwIDE3IDE3Ij4KICAgIDxwYXRoIGZpbGw9IiNGRkMzNDciIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTkuMzMyIDE0Ljk2OGMtLjQ2LS4yNTUtMS4yMDUtLjI1NS0xLjY2NiAwTDQuMzUgMTYuNzk0Yy0uOTIxLjUwNi0xLjUyMy4wNDQtMS4zNDktMS4wMjdsLjYzNS0zLjg2N2MuMDg4LS41MzctLjE0Mi0xLjI4LS41MTYtMS42NkwuNDM2IDcuNWMtLjc0NS0uNzYtLjUxMS0xLjUwNC41MTYtMS42NmwzLjcwNy0uNTY0Yy41MTQtLjA4IDEuMTE5LS41MzggMS4zNDgtMS4wMjdMNy42NjUuNzMxYy40NjItLjk3NiAxLjIwOC0uOTczIDEuNjY3IDBsMS42NiAzLjUxOWMuMjMuNDg5LjgzMy45NSAxLjM0OSAxLjAyN2wzLjcwOC41NjRjMS4wMjkuMTU2IDEuMjU4LjkwMi41MTUgMS42NmwtMi42ODUgMi43MzljLS4zNzIuMzgtLjYwMyAxLjEyMy0uNTE1IDEuNjZsLjYzNCAzLjg2N2MuMTc2IDEuMDc0LS40MyAxLjUzMy0xLjM0OCAxLjAyN2wtMy4zMTgtMS44MjZ6Ii8+Cjwvc3ZnPgo=)}.panel-btn.weibo-btn[data-v-19356a56]{background-image:url(//s3.pstatp.com/toutiao/xitu_juejin_web/img/weibo.2076a57.svg)}.panel-btn.weibo-btn[data-v-19356a56]:hover{background-image:url(//s3.pstatp.com/toutiao/xitu_juejin_web/img/weibo-hover.9abf502.svg)}.panel-btn.qq-btn[data-v-19356a56]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNSIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE1IDE2Ij4KICAgIDxwYXRoIGZpbGw9IiNCMkJBQzIiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTE0LjQ2OCAxMC4zMTJjLS4wMS0uOTU3LS4zOC0xLjQ3Ni0uODA3LTIuMTUzLS4xOTEtLjI4My0uNDEzLS40NzMtLjYwNS0uNzU1LS4wMy0uMTU0LjAzMy0uMjY4LS4wMTItLjY3MS0uMDQyLS42MDQtLjI2My0uODM4LS4zMS0uOTEyLjAyLS4xNi0uMDQzLTEuNDg1LS41MjMtMi4yNjhDMTAuNzUxLjk0MSA3Ljk4Mi44NDYgNy42NDMuODQ0SDcuNjRjLS4zMzkuMDAyLTMuMTA3LjA5Ny00LjU2OCAyLjcxLS40NzkuNzgyLS41NDMgMi4xMDYtLjUyMyAyLjI2Ny0uMDQ2LjA3NC0uMjY3LjMwOC0uMzEuOTEyLS4wNDQuNDAzLjAxOC41MTctLjAxMi42Ny0uMTkyLjI4NC0uNDEzLjQ3My0uNjA1Ljc1Ni0uNDI2LjY3Ny0uNzk3IDEuMTk2LS44MDYgMi4xNTMtLjAwNy43MTQuMTYyIDEuNjg3LjY2MyAxLjcuMTU4LS4wMTIuMjkyLS4xMTcuNTY2LS40MjQuMDgyLS4wOTIuMzctLjQ4LjQyOS0uNTg3LjA1Ni4xNDguMTkgMS4xODMgMS4xMiAxLjcyMy0uOTU2LjQ1LTEuNDI0LjczNS0xLjQ0IDEuMzE5LjAyLjMzOC40MjMuNzg3IDEuMTY1Ljk5NmE2LjA1IDYuMDUgMCAwIDAgMi45MjcuMDVjLjUzNS0uMTMuNjk2LS4yNiAxLjM5Ni0uNjQ0LjcuMzg1Ljg2LjUxNCAxLjM5NS42NDNhNi4wNTIgNi4wNTIgMCAwIDAgMi45MjctLjA0OWMuNzQyLS4yMDkgMS4xNDYtLjY1OCAxLjE2Ni0uOTk2LS4wMTYtLjU4NC0uNDg0LS44Ny0xLjQ0LTEuMzIuOTMtLjUzOCAxLjA2My0xLjU3NCAxLjEyLTEuNzIyLjA1OC4xMDcuMzQ2LjQ5NS40MjguNTg3LjI3NC4zMDcuNDA5LjQxMi41NjcuNDI0LjUtLjAxMy42Ny0uOTg2LjY2My0xLjd6Ii8+Cjwvc3ZnPgo=)}.panel-btn.qq-btn[data-v-19356a56]:hover{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNSIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE1IDE2Ij4KICAgIDxwYXRoIGZpbGw9IiM1NUIyRjEiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTE0LjQ2OCAxMC4zMTJjLS4wMS0uOTU3LS4zOC0xLjQ3Ni0uODA3LTIuMTUzLS4xOTEtLjI4My0uNDEzLS40NzMtLjYwNS0uNzU1LS4wMy0uMTU0LjAzMy0uMjY4LS4wMTItLjY3MS0uMDQyLS42MDQtLjI2My0uODM4LS4zMS0uOTEyLjAyLS4xNi0uMDQzLTEuNDg1LS41MjMtMi4yNjhDMTAuNzUxLjk0MSA3Ljk4Mi44NDYgNy42NDMuODQ0SDcuNjRjLS4zMzkuMDAyLTMuMTA3LjA5Ny00LjU2OCAyLjcxLS40NzkuNzgyLS41NDMgMi4xMDYtLjUyMyAyLjI2Ny0uMDQ2LjA3NC0uMjY3LjMwOC0uMzEuOTEyLS4wNDQuNDAzLjAxOC41MTctLjAxMi42Ny0uMTkyLjI4NC0uNDEzLjQ3My0uNjA1Ljc1Ni0uNDI2LjY3Ny0uNzk3IDEuMTk2LS44MDYgMi4xNTMtLjAwNy43MTQuMTYyIDEuNjg3LjY2MyAxLjcuMTU4LS4wMTIuMjkyLS4xMTcuNTY2LS40MjQuMDgyLS4wOTIuMzctLjQ4LjQyOS0uNTg3LjA1Ni4xNDguMTkgMS4xODMgMS4xMiAxLjcyMy0uOTU2LjQ1LTEuNDI0LjczNS0xLjQ0IDEuMzE5LjAyLjMzOC40MjMuNzg3IDEuMTY1Ljk5NmE2LjA1IDYuMDUgMCAwIDAgMi45MjcuMDVjLjUzNS0uMTMuNjk2LS4yNiAxLjM5Ni0uNjQ0LjcuMzg1Ljg2LjUxNCAxLjM5NS42NDNhNi4wNTIgNi4wNTIgMCAwIDAgMi45MjctLjA0OWMuNzQyLS4yMDkgMS4xNDYtLjY1OCAxLjE2Ni0uOTk2LS4wMTYtLjU4NC0uNDg0LS44Ny0xLjQ0LTEuMzIuOTMtLjUzOCAxLjA2My0xLjU3NCAxLjEyLTEuNzIyLjA1OC4xMDcuMzQ2LjQ5NS40MjguNTg3LjI3NC4zMDcuNDA5LjQxMi41NjcuNDI0LjUtLjAxMy42Ny0uOTg2LjY2My0xLjd6Ii8+Cjwvc3ZnPgo=)}.panel-btn.wechat-btn[data-v-19356a56]{background-image:url(//s3.pstatp.com/toutiao/xitu_juejin_web/img/wechat.63e1ce0.svg)}.panel-btn.wechat-btn[data-v-19356a56]:hover{background-image:url(//s3.pstatp.com/toutiao/xitu_juejin_web/img/wechat-hover.c8ce019.svg)}.panel-btn.wechat-btn:hover .wechat-qr-code-img[data-v-19356a56]{display:block}.share-title[data-v-19356a56]{margin:2.5rem 0 1rem;font-size:1rem;text-align:center;color:#c6c6c6;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.wechat-qr-code-img[data-v-19356a56]{position:absolute;top:100%;left:50%;width:8rem;height:8rem;margin-top:1rem;border:.5rem solid #fff;transform:translateX(-50%);display:none}</style>
  </head>
  <body >
    <div data-server-rendered="true" id="__nuxt"><div id="__layout"><div id="juejin"><div class="global-component-box"><!----> <!----> <!----> <!----> <!----> <div class="emoji-barrage" data-v-68506677><!----></div> <!----> <!----> <div class="bind-phone-number-modal-box" data-v-06e234c4><div st:block="bindPhoneNumberModal" class="modal-mask" style="display:none;" data-v-06e234c4 data-v-06e234c4></div> <form class="bind-phone-number-form" style="display:none;" data-v-06e234c4 data-v-06e234c4><i title="关闭" class="close-btn ion-close-round" data-v-06e234c4></i> <h1 class="title" data-v-06e234c4>提示</h1> <h2 class="hint" data-v-06e234c4>根据我国<a href="http://www.cac.gov.cn/2016-11/07/c_1119867116.htm" target="_blank" style="color:#007fff">《网络安全法》</a>，您需要绑定手机号后才可在掘金社区内发布内容。</h2> <div class="input-group" data-v-06e234c4><div class="input-box dropdown-box" data-v-06e234c4><div class="dropdown-input-container" style="width:26%;" data-v-4e5eda86 data-v-06e234c4><div class="dropdown-input-box" data-v-4e5eda86><input autocomplete="off" value="86" data-v-4e5eda86> <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgdmlld0JveD0iMCAwIDEyIDEyIj4KICAgIDxwYXRoIGZpbGw9IiM5OTkiIGZpbGwtcnVsZT0ibm9uemVybyIgZD0iTTYgNy42NTlsMy4xNDYtMy40OTZhLjQ2NS40NjUgMCAwIDEgLjcwOCAwIC42LjYgMCAwIDEgMCAuNzg1bC0zLjUgMy44OWEuNDY1LjQ2NSAwIDAgMS0uNzA4IDBsLTMuNS0zLjg5YS42LjYgMCAwIDEgMC0uNzg1LjQ2NS40NjUgMCAwIDEgLjcwOCAwTDYgNy42NTl6Ii8+Cjwvc3ZnPg==" class="arrow" style="transform:rotate(0deg);" data-v-4e5eda86></div> <div class="dropdown-pannel" style="display:none;" data-v-4e5eda86 data-v-4e5eda86><ul data-v-4e5eda86><li class="item selected" data-v-4e5eda86><span data-v-4e5eda86>中国</span> <span data-v-4e5eda86>+86</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>中国澳门</span> <span data-v-4e5eda86>+853</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>中国台湾</span> <span data-v-4e5eda86>+886</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>中国香港</span> <span data-v-4e5eda86>+852</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>阿尔巴尼亚</span> <span data-v-4e5eda86>+355</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>阿尔及利亚</span> <span data-v-4e5eda86>+213</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>阿富汗</span> <span data-v-4e5eda86>+93</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>阿根廷</span> <span data-v-4e5eda86>+54</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>阿拉伯联合酋长国</span> <span data-v-4e5eda86>+971</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>阿鲁巴岛</span> <span data-v-4e5eda86>+297</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>阿曼</span> <span data-v-4e5eda86>+968</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>阿塞拜疆</span> <span data-v-4e5eda86>+994</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>阿森松</span> <span data-v-4e5eda86>+247</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>埃及</span> <span data-v-4e5eda86>+20</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>埃塞俄比亚</span> <span data-v-4e5eda86>+251</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>爱尔兰</span> <span data-v-4e5eda86>+353</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>爱沙尼亚</span> <span data-v-4e5eda86>+372</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>安道尔</span> <span data-v-4e5eda86>+376</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>安哥拉</span> <span data-v-4e5eda86>+244</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>安圭拉</span> <span data-v-4e5eda86>+1264</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>安提瓜和巴布达</span> <span data-v-4e5eda86>+1268</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>奥地利</span> <span data-v-4e5eda86>+43</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>奥兰群岛</span> <span data-v-4e5eda86>+358</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>澳大利亚</span> <span data-v-4e5eda86>+61</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>巴巴多斯</span> <span data-v-4e5eda86>+1246</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>巴哈马</span> <span data-v-4e5eda86>+1242</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>巴基斯坦</span> <span data-v-4e5eda86>+92</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>巴拉圭</span> <span data-v-4e5eda86>+595</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>巴勒斯坦</span> <span data-v-4e5eda86>+970</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>巴林</span> <span data-v-4e5eda86>+973</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>巴拿马</span> <span data-v-4e5eda86>+507</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>巴西</span> <span data-v-4e5eda86>+55</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>白俄罗斯</span> <span data-v-4e5eda86>+375</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>百慕大</span> <span data-v-4e5eda86>+1441</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>保加利亚</span> <span data-v-4e5eda86>+359</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>北马里亚纳群岛</span> <span data-v-4e5eda86>+1670</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>贝宁</span> <span data-v-4e5eda86>+229</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>比利时</span> <span data-v-4e5eda86>+32</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>冰岛</span> <span data-v-4e5eda86>+354</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>波多黎各</span> <span data-v-4e5eda86>+1787</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>波黑</span> <span data-v-4e5eda86>+387</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>波兰</span> <span data-v-4e5eda86>+48</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>玻利维亚</span> <span data-v-4e5eda86>+591</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>伯利兹</span> <span data-v-4e5eda86>+501</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>博茨瓦纳</span> <span data-v-4e5eda86>+267</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>不丹</span> <span data-v-4e5eda86>+975</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>布基拉法索</span> <span data-v-4e5eda86>+226</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>布隆迪</span> <span data-v-4e5eda86>+257</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>朝鲜</span> <span data-v-4e5eda86>+850</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>赤道几内亚</span> <span data-v-4e5eda86>+240</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>丹麦</span> <span data-v-4e5eda86>+45</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>德国</span> <span data-v-4e5eda86>+49</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>多哥</span> <span data-v-4e5eda86>+228</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>多米尼加共和国</span> <span data-v-4e5eda86>+1809</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>多米尼克</span> <span data-v-4e5eda86>+1767</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>俄罗斯</span> <span data-v-4e5eda86>+7</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>厄瓜多尔</span> <span data-v-4e5eda86>+593</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>厄立特里亚</span> <span data-v-4e5eda86>+291</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>法国</span> <span data-v-4e5eda86>+33</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>法罗群岛</span> <span data-v-4e5eda86>+298</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>法属波利尼西亚</span> <span data-v-4e5eda86>+689</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>法属圭亚那</span> <span data-v-4e5eda86>+594</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>梵蒂冈</span> <span data-v-4e5eda86>+379</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>菲律宾</span> <span data-v-4e5eda86>+63</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>斐济</span> <span data-v-4e5eda86>+679</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>芬兰</span> <span data-v-4e5eda86>+358</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>佛得角</span> <span data-v-4e5eda86>+238</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>冈比亚</span> <span data-v-4e5eda86>+220</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>刚果</span> <span data-v-4e5eda86>+242</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>刚果民主共和国</span> <span data-v-4e5eda86>+243</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>哥伦比亚</span> <span data-v-4e5eda86>+57</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>哥斯达黎加</span> <span data-v-4e5eda86>+506</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>格林纳达</span> <span data-v-4e5eda86>+1473</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>格陵兰岛</span> <span data-v-4e5eda86>+299</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>格鲁吉亚</span> <span data-v-4e5eda86>+995</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>瓜德罗普</span> <span data-v-4e5eda86>+590</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>关岛</span> <span data-v-4e5eda86>+1671</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>圭亚那</span> <span data-v-4e5eda86>+592</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>海地</span> <span data-v-4e5eda86>+509</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>韩国</span> <span data-v-4e5eda86>+82</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>荷兰</span> <span data-v-4e5eda86>+31</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>荷属安的列斯</span> <span data-v-4e5eda86>+599</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>洪都拉斯</span> <span data-v-4e5eda86>+504</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>吉布提</span> <span data-v-4e5eda86>+253</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>加拿大</span> <span data-v-4e5eda86>+1</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>吉尔吉斯斯坦</span> <span data-v-4e5eda86>+996</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>几内亚</span> <span data-v-4e5eda86>+224</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>加那利群岛</span> <span data-v-4e5eda86>+3491</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>加纳</span> <span data-v-4e5eda86>+233</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>加蓬</span> <span data-v-4e5eda86>+241</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>柬埔寨</span> <span data-v-4e5eda86>+855</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>捷克</span> <span data-v-4e5eda86>+420</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>喀麦隆</span> <span data-v-4e5eda86>+237</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>卡塔尔</span> <span data-v-4e5eda86>+974</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>开曼群岛</span> <span data-v-4e5eda86>+1345</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>科摩罗</span> <span data-v-4e5eda86>+269</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>科索沃</span> <span data-v-4e5eda86>+883</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>科特迪瓦</span> <span data-v-4e5eda86>+225</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>科威特</span> <span data-v-4e5eda86>+965</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>克罗地亚</span> <span data-v-4e5eda86>+385</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>肯尼亚</span> <span data-v-4e5eda86>+254</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>拉脱维亚</span> <span data-v-4e5eda86>+371</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>莱索托</span> <span data-v-4e5eda86>+266</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>老挝</span> <span data-v-4e5eda86>+856</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>黎巴嫩</span> <span data-v-4e5eda86>+961</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>立陶宛</span> <span data-v-4e5eda86>+370</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>利比里亚</span> <span data-v-4e5eda86>+231</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>利比亚</span> <span data-v-4e5eda86>+218</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>列支敦士登</span> <span data-v-4e5eda86>+423</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>留尼旺岛</span> <span data-v-4e5eda86>+262</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>卢森堡</span> <span data-v-4e5eda86>+352</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>卢旺达</span> <span data-v-4e5eda86>+250</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>罗马尼亚</span> <span data-v-4e5eda86>+40</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>马达加斯加</span> <span data-v-4e5eda86>+261</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>马尔代夫</span> <span data-v-4e5eda86>+960</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>马耳他</span> <span data-v-4e5eda86>+356</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>马拉维</span> <span data-v-4e5eda86>+265</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>马来西亚</span> <span data-v-4e5eda86>+60</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>马里</span> <span data-v-4e5eda86>+223</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>马其顿</span> <span data-v-4e5eda86>+389</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>马绍尔群岛</span> <span data-v-4e5eda86>+692</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>马提尼克</span> <span data-v-4e5eda86>+596</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>马约特</span> <span data-v-4e5eda86>+262</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>毛里求斯</span> <span data-v-4e5eda86>+230</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>毛里塔尼亚</span> <span data-v-4e5eda86>+222</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>美国</span> <span data-v-4e5eda86>+1</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>美属萨摩亚</span> <span data-v-4e5eda86>+1684</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>美属维尔京群岛</span> <span data-v-4e5eda86>+1340</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>蒙古</span> <span data-v-4e5eda86>+976</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>蒙塞拉特岛</span> <span data-v-4e5eda86>+1664</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>蒙特內哥羅</span> <span data-v-4e5eda86>+382</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>孟加拉国</span> <span data-v-4e5eda86>+880</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>秘鲁</span> <span data-v-4e5eda86>+51</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>密克罗尼西亚联邦</span> <span data-v-4e5eda86>+691</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>缅甸</span> <span data-v-4e5eda86>+95</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>摩尔多瓦</span> <span data-v-4e5eda86>+373</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>摩洛哥</span> <span data-v-4e5eda86>+212</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>摩纳哥</span> <span data-v-4e5eda86>+377</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>莫桑比克</span> <span data-v-4e5eda86>+258</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>墨西哥</span> <span data-v-4e5eda86>+52</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>纳米比亚</span> <span data-v-4e5eda86>+264</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>南非</span> <span data-v-4e5eda86>+27</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>尼泊尔</span> <span data-v-4e5eda86>+977</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>尼加拉瓜</span> <span data-v-4e5eda86>+505</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>尼日尔</span> <span data-v-4e5eda86>+227</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>尼日利亚</span> <span data-v-4e5eda86>+234</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>挪威</span> <span data-v-4e5eda86>+47</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>帕劳</span> <span data-v-4e5eda86>+680</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>葡萄牙</span> <span data-v-4e5eda86>+351</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>千里达及托巴哥</span> <span data-v-4e5eda86>+1868</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>日本</span> <span data-v-4e5eda86>+81</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>瑞典</span> <span data-v-4e5eda86>+46</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>瑞士</span> <span data-v-4e5eda86>+41</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>圣诞岛</span> <span data-v-4e5eda86>+61</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>圣基茨和尼维斯</span> <span data-v-4e5eda86>+1869</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>圣卢西亚</span> <span data-v-4e5eda86>+1758</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>圣马力诺</span> <span data-v-4e5eda86>+223</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>圣马力诺</span> <span data-v-4e5eda86>+378</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>圣皮埃尔和密克隆群岛</span> <span data-v-4e5eda86>+508</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>圣文森特和格林纳丁斯</span> <span data-v-4e5eda86>+1784</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>斯里兰卡</span> <span data-v-4e5eda86>+94</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>斯洛伐克</span> <span data-v-4e5eda86>+421</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>斯洛文尼亚</span> <span data-v-4e5eda86>+386</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>斯威士兰</span> <span data-v-4e5eda86>+268</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>苏丹</span> <span data-v-4e5eda86>+249</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>苏里南</span> <span data-v-4e5eda86>+597</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>索马里</span> <span data-v-4e5eda86>+252</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>塔吉克斯坦</span> <span data-v-4e5eda86>+992</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>沙特阿拉伯</span> <span data-v-4e5eda86>+966</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>塞舌尔</span> <span data-v-4e5eda86>+248</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>塞浦路斯</span> <span data-v-4e5eda86>+357</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>塞内加尔</span> <span data-v-4e5eda86>+221</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>塞拉利昂</span> <span data-v-4e5eda86>+232</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>塞尔维亚</span> <span data-v-4e5eda86>+381</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>萨尔瓦多</span> <span data-v-4e5eda86>+503</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>萨尔瓦多</span> <span data-v-4e5eda86>+503</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>汤加</span> <span data-v-4e5eda86>+676</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>坦桑尼亚</span> <span data-v-4e5eda86>+255</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>泰国</span> <span data-v-4e5eda86>+66</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>特克斯和凯科斯群岛</span> <span data-v-4e5eda86>+1649</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>突尼斯</span> <span data-v-4e5eda86>+216</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>图瓦卢</span> <span data-v-4e5eda86>+688</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>土耳其</span> <span data-v-4e5eda86>+90</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>土库曼斯坦</span> <span data-v-4e5eda86>+993</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>乌兹别克斯坦</span> <span data-v-4e5eda86>+998</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>乌拉圭</span> <span data-v-4e5eda86>+598</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>乌克兰</span> <span data-v-4e5eda86>+380</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>乌干达</span> <span data-v-4e5eda86>+256</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>文莱</span> <span data-v-4e5eda86>+673</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>委内瑞拉</span> <span data-v-4e5eda86>+58</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>危地马拉</span> <span data-v-4e5eda86>+502</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>叙利亚</span> <span data-v-4e5eda86>+963</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>匈牙利</span> <span data-v-4e5eda86>+36</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>新西兰</span> <span data-v-4e5eda86>+64</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>新喀里多尼亚</span> <span data-v-4e5eda86>+687</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>新加坡</span> <span data-v-4e5eda86>+65</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>希腊</span> <span data-v-4e5eda86>+30</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>西萨摩亚</span> <span data-v-4e5eda86>+685</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>西撒哈拉</span> <span data-v-4e5eda86>+212</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>西班牙</span> <span data-v-4e5eda86>+34</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>越南</span> <span data-v-4e5eda86>+84</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>约旦</span> <span data-v-4e5eda86>+962</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>英属维尔京群岛</span> <span data-v-4e5eda86>+1284</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>英国</span> <span data-v-4e5eda86>+44</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>印度尼西亚</span> <span data-v-4e5eda86>+62</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>印度</span> <span data-v-4e5eda86>+91</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>意大利</span> <span data-v-4e5eda86>+39</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>以色列</span> <span data-v-4e5eda86>+972</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>伊朗</span> <span data-v-4e5eda86>+98</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>伊拉克</span> <span data-v-4e5eda86>+964</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>也门</span> <span data-v-4e5eda86>+967</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>亚美尼亚</span> <span data-v-4e5eda86>+374</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>牙买加</span> <span data-v-4e5eda86>+1876</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>中非</span> <span data-v-4e5eda86>+236</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>智利</span> <span data-v-4e5eda86>+56</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>直布罗陀</span> <span data-v-4e5eda86>+350</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>乍得</span> <span data-v-4e5eda86>+235</span></li><li class="item" data-v-4e5eda86><span data-v-4e5eda86>赞比亚</span> <span data-v-4e5eda86>+260</span></li></ul></div></div> <input maxlength="11" placeholder="请输入要绑定的手机号码" value="" class="input number-input" data-v-06e234c4></div> <div class="input-box vcode-box" data-v-06e234c4></div> <div class="input-box" data-v-06e234c4><input maxlength="4" placeholder="验证码" value="" class="input" data-v-06e234c4> <button class="send-vcode-btn" data-v-06e234c4>
            获取验证码
          </button></div></div> <button st:name="bindBtn" class="btn" data-v-06e234c4>
        绑定手机
      </button></form></div> <!----></div> <!----> <div class="view-container" data-v-6a3e47cf data-v-064b8453><div class="main-header-box" data-v-6a3e47cf><header class="main-header main-header unauthorized visible" data-v-73840133 data-v-6a3e47cf><div class="container" data-v-73840133><a href="/" class="logo" data-v-73840133><img src="//s3.pstatp.com/toutiao/xitu_juejin_web/img/logo.a7995ad.svg" alt="掘金" class="logo-img" data-v-73840133> <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjQ1cHgiIGhlaWdodD0iMzhweCIgdmlld0JveD0iMCAwIDQ1IDM4IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPHRpdGxlPkp1ZWppbjwvdGl0bGU+CiAgICA8ZGVzYz5KdWVqaW4uY248L2Rlc2M+CiAgICA8ZGVmcz48L2RlZnM+CiAgICA8ZyBpZD0iMC4xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iR3JvdXAtMTQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuMDAwMDAwLCA1LjAwMDAwMCkiIGZpbGw9IiMwMDZDRkYiPgogICAgICAgICAgICA8cGF0aCBkPSJNMjEuMjkzNDMyOCwyLjU4MzEzMDQ5IEwxOC4wMTczOTg0LDAgTDE0LjU5NDYyNCwyLjY5ODg3ODAxIEwxNC40MTcyMDc3LDIuODQxODIzMDQgTDE4LjAxNzM5ODQsNS43MTI0MjQ4MyBMMjEuNjI4NjU3OCwyLjg0MTgyMzA0IEwyMS4yOTM0MzI4LDIuNTgzMTMwNDkgWiBNMzMuNzA3ODI4OSwxMi42MDA2Njc0IEwxOC4wMDc5MTA5LDI0Ljk4MDI3NiBMMi4zMTc0ODA0NCwxMi42MDgyNTc0IEwwLDE0LjQ2OTcwNTIgTDE4LjAwNzkxMDksMjguNjY5MDE2NyBMMzYuMDI1NjI1NiwxNC40NjIxMTUyIEwzMy43MDc4Mjg5LDEyLjYwMDY2NzQgWiBNMTguMDA3OTEwOSwxMy42MDUwNzc2IEw5LjQ2NDQxNTU0LDYuODY4NjM1MDUgTDcuMTQ2NjE4ODUsOC43MzAwODI5IEwxOC4wMDc5MTA5LDE3LjI5NDEzNDUgTDI4Ljg3ODM3NDIsOC43MjI0OTI5IEwyNi41NjA1Nzc1LDYuODYxMDQ1MDUgTDE4LjAwNzkxMDksMTMuNjA1MDc3NiBaIiBpZD0iRmlsbC0xLUNvcHkiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==" alt="掘金" class="mobile" data-v-73840133></a> <nav role="navigation" class="main-nav" data-v-73840133><ul class="nav-list" data-v-73840133><li class="main-nav-list" data-v-73840133><div class="phone-show-menu" data-v-73840133><span data-v-73840133>首页</span> <div class="icon ion-arrow-down-b" data-v-73840133></div></div> <ul class="phone-hide" data-v-73840133><li class="nav-item link-item route-active" data-v-73840133><a href="/" data-v-73840133>首页</a></li> <li class="nav-item link-item activities" data-v-73840133><a href="/pins" data-v-73840133>沸点</a></li> <li class="nav-item link-item" data-v-73840133><a href="/topics" data-v-73840133>话题</a></li> <li class="nav-item link-item book" data-v-73840133><a href="/books" data-v-73840133>小册</a></li> <li class="nav-item link-item" data-v-73840133><a href="/events/all" data-v-73840133>活动</a></li> <li class="nav-item link-item" data-v-73840133><a href="/academy" data-v-73840133>字学</a></li></ul></li> <li class="nav-item search" data-v-73840133><form role="search" class="search-form" data-v-73840133><input type="search" maxlength="32" placeholder="探索掘金" value="" class="search-input" data-v-73840133> <img src="//s3.pstatp.com/toutiao/xitu_juejin_web/img/juejin-search-icon.6f8ba1b.svg" alt="搜索" class="search-icon" data-v-73840133></form></li> <li class="nav-item add" data-v-73840133><div class="add-group" data-v-73840133><button class="add-btn" data-v-73840133>写文章</button> <div class="more" data-v-73840133><i class="more-icon ion-android-arrow-dropdown" data-v-73840133></i></div> <ul class="more-list" data-v-73840133><li class="item" data-v-73840133>发布沸点</li> <!----></ul></div> <!----></li> <!----> <!----> <li class="nav-item auth" data-v-73840133><button class="login-button" data-v-73840133>登录</button></li></ul></nav></div></header></div>  <main class="container main-container" style="max-width:;" data-v-6a3e47cf><div class="view column-view" data-v-6a3e47cf data-v-064b8453><div class="main-area article-area shadow" data-v-6a3e47cf data-v-064b8453><article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="6844903502196506631" data-draft-id="6845075308366823437" class="article" data-v-064b8453><meta itemprop="url" content="https://juejin.im/post/6844903502196506631"> <meta itemprop="headline" content="聊聊Vue.js的template编译"> <meta itemprop="keywords" content="Vue.js,GitHub,前端,编译器"> <meta itemprop="datePublished" content="2017-10-08T12:49:37.000Z"> <meta itemprop="image" content="https://b-gold-cdn.xitu.io/icon/icon-128.png"> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="染陌同学"> <meta itemprop="url" content="https://juejin.cn/user/289926769027053"></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://b-gold-cdn.xitu.io/icon/icon-white-180.png"> <meta itemprop="width" content="180"> <meta itemprop="height" content="180"></div></div> <div class="author-info-block" data-v-064b8453><a href="/user/289926769027053" target="_blank" rel="" class="avatar-link" data-v-064b8453><div data-src="https://mirror-gold-cdn.xitu.io/168e0848e3909ec96a7?imageView2/1/w/100/h/100/q/85/interlace/1" class="lazy avatar avatar" style="background-image:none;" data-v-47cc2604 data-v-1c418ef0 data-v-064b8453></div></a> <div class="author-info-box" data-v-064b8453><!----> <div class="meta-box" data-v-064b8453><time datetime="2017-10-08T12:49:37.000Z" title="Sun Oct 08 2017 20:49:37 GMT+0800 (China Standard Time)" class="time" data-v-064b8453>
                  2017年10月08日
                </time> <span class="views-count" data-v-064b8453>阅读 7962</span> <!----></div></div> <button class="follow-button follow" data-v-06c7d5b3 data-v-064b8453><span data-v-06c7d5b3>关注</span></button></div> <!----> <h1 class="article-title" data-v-064b8453><!---->
            聊聊Vue.js的template编译
          </h1> <div itemprop="articleBody" class="article-content" data-v-064b8453><div class="markdown-body"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre>code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote>p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><h2 id="user-content--" data-id="heading-0">写在前面</h2>
<p>因为对Vue.js很感兴趣，而且平时工作的技术栈也是Vue.js，这几个月花了些时间研究学习了一下Vue.js源码，并做了总结与输出。</p>
<p>文章的原地址：<a href="https://github.com/answershuto/learnVue" target="_blank" rel="nofollow noopener noreferrer">github.com/answershuto…</a>。</p>
<p>在学习过程中，为Vue加上了中文的注释<a href="https://github.com/answershuto/learnVue/tree/master/vue-src" target="_blank" rel="nofollow noopener noreferrer">github.com/answershuto…</a>，希望可以对其他想学习Vue源码的小伙伴有所帮助。</p>
<p>可能会有理解存在偏差的地方，欢迎提issue指出，共同学习，共同进步。</p>
<h2 id="user-content--mount" data-id="heading-1">$mount</h2>
<p>首先看一下mount的代码</p>
<pre><code class="hljs javascript copyable"><span class="hljs-comment">/*把原本不带编译的$mount方法保存下来，在最后会调用。*/</span>
<span class="hljs-keyword">const</span> mount = Vue.prototype.$mount
<span class="hljs-comment">/*挂载组件，带模板编译*/</span>
Vue.prototype.$mount = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">
  el?: string | Element,
  hydrating?: boolean
</span>): <span class="hljs-title">Component</span> </span>{
  el = el &#x26;&#x26; query(el)

  <span class="hljs-comment">/* istanbul ignore if */</span>
  <span class="hljs-keyword">if</span> (el === <span class="hljs-built_in">document</span>.body || el === <span class="hljs-built_in">document</span>.documentElement) {
    process.env.NODE_ENV !== <span class="hljs-string">'production'</span> &#x26;&#x26; warn(
      <span class="hljs-string">`Do not mount Vue to &#x3C;html> or &#x3C;body> - mount to normal elements instead.`</span>
    )
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
  }

  <span class="hljs-keyword">const</span> options = <span class="hljs-keyword">this</span>.$options
  <span class="hljs-comment">// resolve template/el and convert to render function</span>
  <span class="hljs-comment">/*处理模板templete，编译成render函数，render不存在的时候才会编译template，否则优先使用render*/</span>
  <span class="hljs-keyword">if</span> (!options.render) {
    <span class="hljs-keyword">let</span> template = options.template
    <span class="hljs-comment">/*template存在的时候取template，不存在的时候取el的outerHTML*/</span>
    <span class="hljs-keyword">if</span> (template) {
      <span class="hljs-comment">/*当template是字符串的时候*/</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> template === <span class="hljs-string">'string'</span>) {
        <span class="hljs-keyword">if</span> (template.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">'#'</span>) {
          template = idToTemplate(template)
          <span class="hljs-comment">/* istanbul ignore if */</span>
          <span class="hljs-keyword">if</span> (process.env.NODE_ENV !== <span class="hljs-string">'production'</span> &#x26;&#x26; !template) {
            warn(
              <span class="hljs-string">`Template element not found or is empty: <span class="hljs-subst">${options.template}</span>`</span>,
              <span class="hljs-keyword">this</span>
            )
          }
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (template.nodeType) {
        <span class="hljs-comment">/*当template为DOM节点的时候*/</span>
        template = template.innerHTML
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">/*报错*/</span>
        <span class="hljs-keyword">if</span> (process.env.NODE_ENV !== <span class="hljs-string">'production'</span>) {
          warn(<span class="hljs-string">'invalid template option:'</span> + template, <span class="hljs-keyword">this</span>)
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (el) {
      <span class="hljs-comment">/*获取element的outerHTML*/</span>
      template = getOuterHTML(el)
    }
    <span class="hljs-keyword">if</span> (template) {
      <span class="hljs-comment">/* istanbul ignore if */</span>
      <span class="hljs-keyword">if</span> (process.env.NODE_ENV !== <span class="hljs-string">'production'</span> &#x26;&#x26; config.performance &#x26;&#x26; mark) {
        mark(<span class="hljs-string">'compile'</span>)
      }

      <span class="hljs-comment">/*将template编译成render函数，这里会有render以及staticRenderFns两个返回，这是vue的编译时优化，static静态不需要在VNode更新时进行patch，优化性能*/</span>
      <span class="hljs-keyword">const</span> { render, staticRenderFns } = compileToFunctions(template, {
        shouldDecodeNewlines,
        <span class="hljs-attr">delimiters</span>: options.delimiters
      }, <span class="hljs-keyword">this</span>)
      options.render = render
      options.staticRenderFns = staticRenderFns

      <span class="hljs-comment">/* istanbul ignore if */</span>
      <span class="hljs-keyword">if</span> (process.env.NODE_ENV !== <span class="hljs-string">'production'</span> &#x26;&#x26; config.performance &#x26;&#x26; mark) {
        mark(<span class="hljs-string">'compile end'</span>)
        measure(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>._name}</span> compile`</span>, <span class="hljs-string">'compile'</span>, <span class="hljs-string">'compile end'</span>)
      }
    }
  }
  <span class="hljs-comment">/*Github:https://github.com/answershuto*/</span>
  <span class="hljs-comment">/*调用const mount = Vue.prototype.$mount保存下来的不带编译的mount*/</span>
  <span class="hljs-keyword">return</span> mount.call(<span class="hljs-keyword">this</span>, el, hydrating)
}<span class="copy-code-btn">复制代码</span></code></pre><p>通过mount代码我们可以看到，在mount的过程中，如果render函数不存在（render函数存在会优先使用render）会将template进行compileToFunctions得到render以及staticRenderFns。譬如说手写组件时加入了template的情况都会在运行时进行编译。而render function在运行后会返回VNode节点，供页面的渲染以及在update的时候patch。接下来我们来看一下template是如何编译的。</p>
<h2 id="user-content--" data-id="heading-2">一些基础</h2>
<p>首先，template会被编译成AST语法树，那么AST是什么？</p>
<p>在计算机科学中，抽象语法树（abstract syntax tree或者缩写为AST），或者语法树（syntax tree），是源代码的抽象语法结构的树状表现形式，这里特指编程语言的源代码。具体可以查看<a href="https://zh.wikipedia.org/wiki/%E6%8A%BD%E8%B1%A1%E8%AA%9E%E6%B3%95%E6%A8%B9" target="_blank" rel="nofollow noopener noreferrer">抽象语法树</a>。</p>
<p>AST会经过generate得到render函数，render的返回值是VNode，VNode是Vue的虚拟DOM节点，具体定义如下：</p>
<pre><code class="hljs javascript copyable"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VNode</span> </span>{
  tag: string | <span class="hljs-keyword">void</span>;
  data: VNodeData | <span class="hljs-keyword">void</span>;
  children: ?<span class="hljs-built_in">Array</span>&#x3C;VNode>;
  text: string | <span class="hljs-keyword">void</span>;
  elm: Node | <span class="hljs-keyword">void</span>;
  ns: string | <span class="hljs-keyword">void</span>;
  context: Component | <span class="hljs-keyword">void</span>; <span class="hljs-comment">// rendered in this component's scope</span>
  functionalContext: Component | <span class="hljs-keyword">void</span>; <span class="hljs-comment">// only for functional component root nodes</span>
  key: string | number | <span class="hljs-keyword">void</span>;
  componentOptions: VNodeComponentOptions | <span class="hljs-keyword">void</span>;
  componentInstance: Component | <span class="hljs-keyword">void</span>; <span class="hljs-comment">// component instance</span>
  parent: VNode | <span class="hljs-keyword">void</span>; <span class="hljs-comment">// component placeholder node</span>
  raw: boolean; <span class="hljs-comment">// contains raw HTML? (server only)</span>
  isStatic: boolean; <span class="hljs-comment">// hoisted static node</span>
  isRootInsert: boolean; <span class="hljs-comment">// necessary for enter transition check</span>
  isComment: boolean; <span class="hljs-comment">// empty comment placeholder?</span>
  isCloned: boolean; <span class="hljs-comment">// is a cloned node?</span>
  isOnce: boolean; <span class="hljs-comment">// is a v-once node?</span>
  <span class="hljs-comment">/*Github:https://github.com/answershuto*/</span>

  <span class="hljs-keyword">constructor</span> (
    tag?: string,
    data?: VNodeData,
    children?: ?Array&#x3C;VNode>,
    text?: string,
    elm?: Node,
    context?: Component,
    componentOptions?: VNodeComponentOptions
  ) {
    <span class="hljs-comment">/*当前节点的标签名*/</span>
    <span class="hljs-keyword">this</span>.tag = tag
    <span class="hljs-comment">/*当前节点对应的对象，包含了具体的一些数据信息，是一个VNodeData类型，可以参考VNodeData类型中的数据信息*/</span>
    <span class="hljs-keyword">this</span>.data = data
    <span class="hljs-comment">/*当前节点的子节点，是一个数组*/</span>
    <span class="hljs-keyword">this</span>.children = children
    <span class="hljs-comment">/*当前节点的文本*/</span>
    <span class="hljs-keyword">this</span>.text = text
    <span class="hljs-comment">/*当前虚拟节点对应的真实dom节点*/</span>
    <span class="hljs-keyword">this</span>.elm = elm
    <span class="hljs-comment">/*当前节点的名字空间*/</span>
    <span class="hljs-keyword">this</span>.ns = <span class="hljs-literal">undefined</span>
    <span class="hljs-comment">/*编译作用域*/</span>
    <span class="hljs-keyword">this</span>.context = context
    <span class="hljs-comment">/*函数化组件作用域*/</span>
    <span class="hljs-keyword">this</span>.functionalContext = <span class="hljs-literal">undefined</span>
    <span class="hljs-comment">/*节点的key属性，被当作节点的标志，用以优化*/</span>
    <span class="hljs-keyword">this</span>.key = data &#x26;&#x26; data.key
    <span class="hljs-comment">/*组件的option选项*/</span>
    <span class="hljs-keyword">this</span>.componentOptions = componentOptions
    <span class="hljs-comment">/*当前节点对应的组件的实例*/</span>
    <span class="hljs-keyword">this</span>.componentInstance = <span class="hljs-literal">undefined</span>
    <span class="hljs-comment">/*当前节点的父节点*/</span>
    <span class="hljs-keyword">this</span>.parent = <span class="hljs-literal">undefined</span>
    <span class="hljs-comment">/*简而言之就是是否为原生HTML或只是普通文本，innerHTML的时候为true，textContent的时候为false*/</span>
    <span class="hljs-keyword">this</span>.raw = <span class="hljs-literal">false</span>
    <span class="hljs-comment">/*静态节点标志*/</span>
    <span class="hljs-keyword">this</span>.isStatic = <span class="hljs-literal">false</span>
    <span class="hljs-comment">/*是否作为跟节点插入*/</span>
    <span class="hljs-keyword">this</span>.isRootInsert = <span class="hljs-literal">true</span>
    <span class="hljs-comment">/*是否为注释节点*/</span>
    <span class="hljs-keyword">this</span>.isComment = <span class="hljs-literal">false</span>
    <span class="hljs-comment">/*是否为克隆节点*/</span>
    <span class="hljs-keyword">this</span>.isCloned = <span class="hljs-literal">false</span>
    <span class="hljs-comment">/*是否有v-once指令*/</span>
    <span class="hljs-keyword">this</span>.isOnce = <span class="hljs-literal">false</span>
  }

  <span class="hljs-comment">// DEPRECATED: alias for componentInstance for backwards compat.</span>
  <span class="hljs-comment">/* istanbul ignore next */</span>
  get child (): Component | <span class="hljs-keyword">void</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.componentInstance
  }
}<span class="copy-code-btn">复制代码</span></code></pre><p>关于VNode的一些细节，请参考<a href="https://github.com/answershuto/learnVue/blob/master/docs/VNode%E8%8A%82%E7%82%B9.MarkDown" target="_blank" rel="nofollow noopener noreferrer">VNode节点</a>。</p>
<h2 id="user-content-createcompiler" data-id="heading-3">createCompiler</h2>
<p>createCompiler用以创建编译器，返回值是compile以及compileToFunctions。compile是一个编译器，它会将传入的template转换成对应的AST树、render函数以及staticRenderFns函数。而compileToFunctions则是带缓存的编译器，同时staticRenderFns以及render函数会被转换成Funtion对象。</p>
<p>因为不同平台有一些不同的options，所以createCompiler会根据平台区分传入一个baseOptions，会与compile本身传入的options合并得到最终的finalOptions。</p>
<h2 id="user-content-compiletofunctions" data-id="heading-4">compileToFunctions</h2>
<p>首先还是贴一下compileToFunctions的代码。</p>
<pre><code class="hljs javascript copyable">  <span class="hljs-comment">/*带缓存的编译器，同时staticRenderFns以及render函数会被转换成Funtion对象*/</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileToFunctions</span> (<span class="hljs-params">
    template: string,
    options?: CompilerOptions,
    vm?: Component
  </span>): <span class="hljs-title">CompiledFunctionResult</span> </span>{
    options = options || {}

    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (process.env.NODE_ENV !== <span class="hljs-string">'production'</span>) {
      <span class="hljs-comment">// detect possible CSP restriction</span>
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">new</span> <span class="hljs-built_in">Function</span>(<span class="hljs-string">'return 1'</span>)
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-keyword">if</span> (e.toString().match(<span class="hljs-regexp">/unsafe-eval|CSP/</span>)) {
          warn(
            <span class="hljs-string">'It seems you are using the standalone build of Vue.js in an '</span> +
            <span class="hljs-string">'environment with Content Security Policy that prohibits unsafe-eval. '</span> +
            <span class="hljs-string">'The template compiler cannot work in this environment. Consider '</span> +
            <span class="hljs-string">'relaxing the policy to allow unsafe-eval or pre-compiling your '</span> +
            <span class="hljs-string">'templates into render functions.'</span>
          )
        }
      }
    }
    <span class="hljs-comment">/*Github:https://github.com/answershuto*/</span>
    <span class="hljs-comment">// check cache</span>
    <span class="hljs-comment">/*有缓存的时候直接取出缓存中的结果即可*/</span>
    <span class="hljs-keyword">const</span> key = options.delimiters
      ? <span class="hljs-built_in">String</span>(options.delimiters) + template
      : template
    <span class="hljs-keyword">if</span> (functionCompileCache[key]) {
      <span class="hljs-keyword">return</span> functionCompileCache[key]
    }

    <span class="hljs-comment">// compile</span>
    <span class="hljs-comment">/*编译*/</span>
    <span class="hljs-keyword">const</span> compiled = compile(template, options)

    <span class="hljs-comment">// check compilation errors/tips</span>
    <span class="hljs-keyword">if</span> (process.env.NODE_ENV !== <span class="hljs-string">'production'</span>) {
      <span class="hljs-keyword">if</span> (compiled.errors &#x26;&#x26; compiled.errors.length) {
        warn(
          <span class="hljs-string">`Error compiling template:\n\n<span class="hljs-subst">${template}</span>\n\n`</span> +
          compiled.errors.map(<span class="hljs-function"><span class="hljs-params">e</span> =></span> <span class="hljs-string">`- <span class="hljs-subst">${e}</span>`</span>).join(<span class="hljs-string">'\n'</span>) + <span class="hljs-string">'\n'</span>,
          vm
        )
      }
      <span class="hljs-keyword">if</span> (compiled.tips &#x26;&#x26; compiled.tips.length) {
        compiled.tips.forEach(<span class="hljs-function"><span class="hljs-params">msg</span> =></span> tip(msg, vm))
      }
    }

    <span class="hljs-comment">// turn code into functions</span>
    <span class="hljs-keyword">const</span> res = {}
    <span class="hljs-keyword">const</span> fnGenErrors = []
    <span class="hljs-comment">/*将render转换成Funtion对象*/</span>
    res.render = makeFunction(compiled.render, fnGenErrors)
    <span class="hljs-comment">/*将staticRenderFns全部转化成Funtion对象 */</span>
    <span class="hljs-keyword">const</span> l = compiled.staticRenderFns.length
    res.staticRenderFns = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(l)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &#x3C; l; i++) {
      res.staticRenderFns[i] = makeFunction(compiled.staticRenderFns[i], fnGenErrors)
    }

    <span class="hljs-comment">// check function generation errors.</span>
    <span class="hljs-comment">// this should only happen if there is a bug in the compiler itself.</span>
    <span class="hljs-comment">// mostly for codegen development use</span>
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (process.env.NODE_ENV !== <span class="hljs-string">'production'</span>) {
      <span class="hljs-keyword">if</span> ((!compiled.errors || !compiled.errors.length) &#x26;&#x26; fnGenErrors.length) {
        warn(
          <span class="hljs-string">`Failed to generate render function:\n\n`</span> +
          fnGenErrors.map(<span class="hljs-function">(<span class="hljs-params">{ err, code }</span>) =></span> <span class="hljs-string">`<span class="hljs-subst">${err.toString()}</span> in\n\n<span class="hljs-subst">${code}</span>\n`</span>).join(<span class="hljs-string">'\n'</span>),
          vm
        )
      }
    }

    <span class="hljs-comment">/*存放在缓存中，以免每次都重新编译*/</span>
    <span class="hljs-keyword">return</span> (functionCompileCache[key] = res) 
  }<span class="copy-code-btn">复制代码</span></code></pre><p>我们可以发现，在闭包中，会有一个functionCompileCache对象作为缓存器。</p>
<pre><code class="hljs javascript copyable">  <span class="hljs-comment">/*作为缓存，防止每次都重新编译*/</span>
  <span class="hljs-keyword">const</span> functionCompileCache: {
    [key: string]: CompiledFunctionResult;
  } = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>)<span class="copy-code-btn">复制代码</span></code></pre><p>在进入compileToFunctions以后，会先检查缓存中是否有已经编译好的结果，如果有结果则直接从缓存中读取。这样做防止每次同样的模板都要进行重复的编译工作。</p>
<pre><code class="hljs javascript copyable">    <span class="hljs-comment">// check cache</span>
    <span class="hljs-comment">/*有缓存的时候直接取出缓存中的结果即可*/</span>
    <span class="hljs-keyword">const</span> key = options.delimiters
      ? <span class="hljs-built_in">String</span>(options.delimiters) + template
      : template
    <span class="hljs-keyword">if</span> (functionCompileCache[key]) {
      <span class="hljs-keyword">return</span> functionCompileCache[key]
    }<span class="copy-code-btn">复制代码</span></code></pre><p>在compileToFunctions的末尾会将编译结果进行缓存</p>
<pre><code class="hljs javascript copyable">  <span class="hljs-comment">/*存放在缓存中，以免每次都重新编译*/</span>
  <span class="hljs-keyword">return</span> (functionCompileCache[key] = res)<span class="copy-code-btn">复制代码</span></code></pre><h2 id="user-content-compile" data-id="heading-5">compile</h2>
<pre><code class="hljs javascript copyable">  <span class="hljs-comment">/*编译，将模板template编译成AST树、render函数以及staticRenderFns函数*/</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compile</span> (<span class="hljs-params">
    template: string,
    options?: CompilerOptions
  </span>): <span class="hljs-title">CompiledResult</span> </span>{
    <span class="hljs-keyword">const</span> finalOptions = <span class="hljs-built_in">Object</span>.create(baseOptions)
    <span class="hljs-keyword">const</span> errors = []
    <span class="hljs-keyword">const</span> tips = []
    finalOptions.warn = <span class="hljs-function">(<span class="hljs-params">msg, tip</span>) =></span> {
      (tip ? tips : errors).push(msg)
    }

    <span class="hljs-comment">/*做下面这些merge的目的因为不同平台可以提供自己本身平台的一个baseOptions，内部封装了平台自己的实现，然后把共同的部分抽离开来放在这层compiler中，所以在这里需要merge一下*/</span>
    <span class="hljs-keyword">if</span> (options) {
      <span class="hljs-comment">// merge custom modules</span>
      <span class="hljs-comment">/*合并modules*/</span>
      <span class="hljs-keyword">if</span> (options.modules) {
        finalOptions.modules = (baseOptions.modules || []).concat(options.modules)
      }
      <span class="hljs-comment">// merge custom directives</span>
      <span class="hljs-keyword">if</span> (options.directives) {
        <span class="hljs-comment">/*合并directives*/</span>
        finalOptions.directives = extend(
          <span class="hljs-built_in">Object</span>.create(baseOptions.directives),
          options.directives
        )
      }
      <span class="hljs-comment">// copy other options</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> options) {
        <span class="hljs-comment">/*合并其余的options，modules与directives已经在上面做了特殊处理了*/</span>
        <span class="hljs-keyword">if</span> (key !== <span class="hljs-string">'modules'</span> &#x26;&#x26; key !== <span class="hljs-string">'directives'</span>) {
          finalOptions[key] = options[key]
        }
      }
    }

    <span class="hljs-comment">/*基础模板编译，得到编译结果*/</span>
    <span class="hljs-keyword">const</span> compiled = baseCompile(template, finalOptions)
    <span class="hljs-keyword">if</span> (process.env.NODE_ENV !== <span class="hljs-string">'production'</span>) {
      errors.push.apply(errors, detectErrors(compiled.ast))
    }
    compiled.errors = errors
    compiled.tips = tips
    <span class="hljs-keyword">return</span> compiled
  }<span class="copy-code-btn">复制代码</span></code></pre><p>compile主要做了两件事，一件是合并option（前面说的将平台自有的option与传入的option进行合并），另一件是baseCompile，进行模板template的编译。</p>
<p>来看一下baseCompile</p>
<h2 id="user-content-basecompile" data-id="heading-6">baseCompile</h2>
<pre><code class="hljs javascript copyable"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">baseCompile</span> (<span class="hljs-params">
  template: string,
  options: CompilerOptions
</span>): <span class="hljs-title">CompiledResult</span> </span>{
  <span class="hljs-comment">/*parse解析得到ast树*/</span>
  <span class="hljs-keyword">const</span> ast = parse(template.trim(), options)
  <span class="hljs-comment">/*
    将AST树进行优化
    优化的目标：生成模板AST树，检测不需要进行DOM改变的静态子树。
    一旦检测到这些静态树，我们就能做以下这些事情：
    1.把它们变成常数，这样我们就再也不需要每次重新渲染时创建新的节点了。
    2.在patch的过程中直接跳过。
 */</span>
  optimize(ast, options)
  <span class="hljs-comment">/*根据ast树生成所需的code（内部包含render与staticRenderFns）*/</span>
  <span class="hljs-keyword">const</span> code = generate(ast, options)
  <span class="hljs-keyword">return</span> {
    ast,
    <span class="hljs-attr">render</span>: code.render,
    <span class="hljs-attr">staticRenderFns</span>: code.staticRenderFns
  }
}<span class="copy-code-btn">复制代码</span></code></pre><p>baseCompile首先会将模板template进行parse得到一个AST语法树，再通过optimize做一些优化，最后通过generate得到render以及staticRenderFns。</p>
<h3 id="user-content-parse" data-id="heading-7">parse</h3>
<p>parse的源码可以参见<a href="https://github.com/answershuto/learnVue/blob/master/vue-src/compiler/parser/index.js#L53" target="_blank" rel="nofollow noopener noreferrer">github.com/answershuto…</a>。</p>
<p>parse会用正则等方式解析template模板中的指令、class、style等数据，形成AST语法树。</p>
<h3 id="user-content-optimize" data-id="heading-8">optimize</h3>
<p>optimize的主要作用是标记static静态节点，这是Vue在编译过程中的一处优化，后面当update更新界面时，会有一个patch的过程，diff算法会直接跳过静态节点，从而减少了比较的过程，优化了patch的性能。</p>
<h3 id="user-content-generate" data-id="heading-9">generate</h3>
<p>generate是将AST语法树转化成render funtion字符串的过程，得到结果是render的字符串以及staticRenderFns字符串。</p>
<hr>
<p>至此，我们的template模板已经被转化成了我们所需的AST语法树、render function字符串以及staticRenderFns字符串。</p>
<h2 id="user-content--" data-id="heading-10">举个例子</h2>
<p>来看一下这段代码的编译结果</p>
<pre><code class="hljs html copyable"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"main"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"bindClass"</span>></span>
    <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>{{text}}<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
    <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>hello world<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
    <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item, index) in arr"</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>{{item.name}}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>{{item.value}}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>{{index}}<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>---<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
    <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"text"</span>></span>
        {{text}}
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
    <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">v-else</span>></span><span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span><span class="copy-code-btn">复制代码</span></code></pre><p>转化后得到AST树，如下图：</p>
<p></p><figure><img alt="img" class="lazyload" data-src="https://user-gold-cdn.xitu.io/2017/10/8/936953ce3bdbfd3f42852ef10c7ae13e?imageView2/0/w/1280/h/960/ignore-error/1" data-width="800" data-height="600"><figcaption>img</figcaption></figure><p></p>
<p>我们可以看到最外层的div是这颗AST树的根节点，节点上有许多数据代表这个节点的形态，比如static表示是否是静态节点，staticClass表示静态class属性（非bind:class）。children代表该节点的子节点，可以看到children是一个长度为4的数组，里面包含的是该节点下的四个div子节点。children里面的节点与父节点的结构类似，层层往下形成一棵AST语法树。</p>
<p>再来看看由AST得到的render函数</p>
<pre><code class="hljs javascript copyable">with(this){
    return _c(  'div',
                {
                    /*static class*/
                    staticClass:"main",
                    /*bind class*/
                    class:bindClass
                },
                [
                    _c( 'div', [_v(_s(text))]),
                    _c('div',[_v("hello world")]),
                    /*这是一个v-for循环*/
                    _l(
                        (arr),
                        function(item,index){
                            return _c(  'div',
                                        [_c('p',[_v(_s(item.name))]),
                                        _c('p',[_v(_s(item.value))]),
                                        _c('p',[_v(_s(index))]),
                                        _c('p',[_v("---")])]
                                    )
                        }
                    ),
                    /*这是v-if*/
                    (text)?_c('div',[_v(_s(text))]):_c('div',[_v("no text")])],
                    2
            )
}<span class="copy-code-btn">复制代码</span></code></pre><h2 id="user-content--_c-_v-_s-_q" data-id="heading-11">_c，_v，_s，_q</h2>
<p>看了render function字符串，发现有大量的_c，_v，_s，_q，这些函数究竟是什么？</p>
<p>带着问题，我们来看一下<a href="https://github.com/answershuto/learnVue/blob/master/vue-src/core/instance/render.js#L124" target="_blank" rel="nofollow noopener noreferrer">core/instance/render</a>。</p>
<pre><code class="hljs javascript copyable"><span class="hljs-comment">/*处理v-once的渲染函数*/</span>
  Vue.prototype._o = markOnce
  <span class="hljs-comment">/*将字符串转化为数字，如果转换失败会返回原字符串*/</span>
  Vue.prototype._n = toNumber
  <span class="hljs-comment">/*将val转化成字符串*/</span>
  Vue.prototype._s = toString
  <span class="hljs-comment">/*处理v-for列表渲染*/</span>
  Vue.prototype._l = renderList
  <span class="hljs-comment">/*处理slot的渲染*/</span>
  Vue.prototype._t = renderSlot
  <span class="hljs-comment">/*检测两个变量是否相等*/</span>
  Vue.prototype._q = looseEqual
  <span class="hljs-comment">/*检测arr数组中是否包含与val变量相等的项*/</span>
  Vue.prototype._i = looseIndexOf
  <span class="hljs-comment">/*处理static树的渲染*/</span>
  Vue.prototype._m = renderStatic
  <span class="hljs-comment">/*处理filters*/</span>
  Vue.prototype._f = resolveFilter
  <span class="hljs-comment">/*从config配置中检查eventKeyCode是否存在*/</span>
  Vue.prototype._k = checkKeyCodes
  <span class="hljs-comment">/*合并v-bind指令到VNode中*/</span>
  Vue.prototype._b = bindObjectProps
  <span class="hljs-comment">/*创建一个文本节点*/</span>
  Vue.prototype._v = createTextVNode
  <span class="hljs-comment">/*创建一个空VNode节点*/</span>
  Vue.prototype._e = createEmptyVNode
  <span class="hljs-comment">/*处理ScopedSlots*/</span>
  Vue.prototype._u = resolveScopedSlots

  <span class="hljs-comment">/*创建VNode节点*/</span>
  vm._c = <span class="hljs-function">(<span class="hljs-params">a, b, c, d</span>) =></span> createElement(vm, a, b, c, d, <span class="hljs-literal">false</span>)<span class="copy-code-btn">复制代码</span></code></pre><p>通过这些函数，render函数最后会返回一个VNode节点，在_update的时候，经过patch与之前的VNode节点进行比较，得出差异后将这些差异渲染到真实的DOM上。</p>
<h2 id="user-content--" data-id="heading-12">关于</h2>
<p>作者：染陌 </p>
<p>Email：answershuto@gmail.com  or  answershuto@126.com</p>
<p>Github:  <a href="https://github.com/answershuto" target="_blank" rel="nofollow noopener noreferrer">github.com/answershuto</a></p>
<p>Blog：<a href="http://answershuto.github.io/" target="_blank" rel="nofollow noopener noreferrer">answershuto.github.io/</a></p>
<p>知乎主页：<a href="https://www.zhihu.com/people/cao-yang-49/activities" target="_blank" rel="nofollow noopener noreferrer">www.zhihu.com/people/cao-…</a></p>
<p>知乎专栏：<a href="https://zhuanlan.zhihu.com/ranmo" target="_blank" rel="nofollow noopener noreferrer">zhuanlan.zhihu.com/ranmo</a></p>
<p>掘金： <a href="https://juejin.im/user/289926769027053" target="_blank" rel="nofollow noopener noreferrer">juejin.im/user/289926…</a></p>
<p>osChina：<a href="https://my.oschina.net/u/3161824/blog" target="_blank" rel="nofollow noopener noreferrer">my.oschina.net/u/3161824/b…</a></p>
<p>转载请注明出处，谢谢。</p>
<p>欢迎关注我的公众号</p>
<p></p><figure><img alt="" class="lazyload" data-src="https://user-gold-cdn.xitu.io/2017/9/24/99de30e7ef948aabf132e91d543807a0?imageView2/0/w/1280/h/960/ignore-error/1" data-width="800" data-height="600"><figcaption></figcaption></figure><p></p>
</div> <div class="image-viewer-box" data-v-78c9b824><!----></div></div></article> <!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></div> <!----> <!----> <div class="article-suspended-panel article-suspended-panel" data-v-19356a56 data-v-064b8453><div badge="179" class="like-btn panel-btn like-adjust with-badge" data-v-19356a56></div> <div badge="2" class="comment-btn panel-btn comment-adjust with-badge" data-v-19356a56></div> <div class="collect-btn panel-btn" data-v-19356a56><!----></div> <div class="share-title" data-v-19356a56>分享</div> <div class="weibo-btn share-btn panel-btn" data-v-19356a56></div> <div class="qq-btn share-btn panel-btn" data-v-19356a56></div> <div class="wechat-btn share-btn panel-btn" data-v-19356a56><img src="" class="wechat-qr-code-img shadow" style="display:none;" data-v-19356a56></div></div></div></main></div> <!----></div></div></div><script>window.__NUXT__=(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){return {layout:"default",data:[{}],fetch:[],error:b,state:{view:{activityIndex:{activityList:[],pageInfo:{hasNextPage:a,endCursor:e},afterPosition:e,activityListIsLoading:c,activityListIsError:a,userActivityList:[],placeholder:e,actionType:{FETCH:"@\u002Fview\u002Factivity-index\u002FFETCH",FETCH_RECOMMEND_LIST:"@\u002Fview\u002Factivity-index\u002FFETCH_RECOMMEND_LIST",RESET_ACTIVITY_LIST:"@\u002Fview\u002Factivity-index\u002FRESET_ACTIVITY_LIST",FETCH_USER_ACTIVITY_LIST:"@\u002Fview\u002Factivity-index\u002FFETCH_USER_ACTIVITY_LIST",FETCH_NEW_COUNT:"@\u002Fview\u002Factivity-index\u002FFETCH_NEW_COUNT",DELETE_ACTIVITY:"@\u002Fview\u002Factivity-index\u002FDELETE_ACTIVITY",TOGGLE_FOLLOW_USER:"@\u002Fview\u002Factivity-index\u002FTOGGLE_FOLLOW_USER",FETCH_ENTRY_COMMENT_LIST:"@\u002Fview\u002Factivity-index\u002FFETCH_ENTRY_COMMENT_LIST",UPDATE_LIST_LOADING:"@\u002Fview\u002Factivity-index\u002FUPDATE_LIST_LOADING",RESET:"@\u002Fview\u002Factivity-index\u002FRESET"},hotList:{list:[],after:e,loading:a,hasNextPage:a,actionType:{UPDATE_STATE:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FFETCH",RESET:"@\u002Fview\u002Factivity-index\u002Fhot-list\u002FRESET"}},sidebar:{bannerList:[],actionType:{RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002FRESET",UPDATE_STATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002FUPDATE_STATE",FETCH_BANNER:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002FFETCH_BANNER"},recommend:{pageSize:g,page:d,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FUPDATE",FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FFETCH_MORE",RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-topic-list\u002FRESET"},after:d},followed:{pageSize:g,page:d,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FUPDATE",FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FFETCH_MORE",RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Ffollowed-topic-list\u002FRESET"},after:d},recommendPin:{list:[],after:e,loading:a,hasNextPage:c,actionType:{UPDATE_STATE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FFETCH",RESET:"@\u002Fview\u002Factivity-index\u002Fsidebar\u002Frecommend-pin-list\u002FRESET"}}},topicPinList:{pageSize:g,page:h,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FUPDATE",FETCH:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FFETCH_MORE",RESET:"@\u002Fview\u002Factivity-index\u002Ftopic-pin-list\u002FRESET"},topicId:e,navList:[{type:j,name:j,title:"推荐 ",id:j},{type:k,name:k,title:"热门 ",id:k},{type:l,name:l,title:"关注 ",id:l},{type:i,name:"opensource",title:"开源推荐 ",id:"5c09ea2b092dcb42c740fe73"},{type:i,name:"recruitment",title:"内推招聘",id:"5abb61e1092dcb4620ca3322"},{type:i,name:"dating",title:"掘金相亲",id:"5abcaa67092dcb4620ca335c"},{type:i,name:"slacking",title:"上班摸鱼",id:"5c106be9092dcb2cc5de7257"},{type:i,name:"app",title:"应用安利",id:"5b514af1092dcb61bd72800d"},{type:i,name:"tool",title:"开发工具",id:"5abb67d2092dcb4620ca3324"},{type:i,name:"news",title:"New资讯",id:"5c46a17f092dcb4737217152"}],sortType:m}},search:{list:[],linkList:[],query:e,period:n,type:n,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fsearch\u002FFETCH",FETCH_MORE:"@\u002Fview\u002Fsearch\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fsearch\u002FRESET"}},columnIndex:{list:{pageSize:g,page:h,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002FcolumnIndex\u002Flist\u002FRESET"},sort:o,category:n},hotList:{pageSize:g,page:h,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FUPDATE",FETCH:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FFETCH_MORE",RESET:"@\u002Fview\u002FcolumnIndex\u002FhotList\u002FRESET"}}},timelineIndex:{categoryNavList:[],tagNavList:[],splitTagList:[],timelineAdList:[],list:[],sort:m,category:j,categoryId:e,tagId:e,tag:"全部",actionType:{FETCH_TIMELINE_LIST:"@\u002Fview\u002FtimelineIndex\u002FFETCH_TIMELINE_LIST",FETCH_CATEGORY_LIST:"@\u002Fview\u002FtimelineIndex\u002FFETCH_CATEGORY_LIST",FETCH_TAG_LIST:"@\u002Fview\u002FtimelineIndex\u002FFETCH_TAG_LIST",DELETE_ENTRY:"@\u002Fview\u002FtimelineIndex\u002FDELETE_ENTRY",FETCH_MORE:"@\u002Fview\u002FtimelineIndex\u002FFETCH_MORE",FETCH:"@\u002Fview\u002FtimelineIndex\u002FFETCH",RESET:"@\u002Fview\u002FtimelineIndex\u002FRESET"},timelineList:{list:[],cursor:f,skeleton:a,loading:a,hasMore:a,categoryId:e,tagId:e,sort:e,actionType:{UPDATE_STATE:"timeline-list\u002FUPDATE_STATE",FETCH_MORE:"timeline-list\u002FFETCH_MORE",FETCH:"timeline-list\u002FFETCH",RESET:"timeline-list\u002FRESET"}},recommendList:{list:[],cursor:f,loading:a,hasMore:a,skeleton:a,actionType:{UPDATE_STATE:"recommend-list\u002FUPDATE_STATE",FETCH_MORE:"recommend-list\u002FFETCH_MORE",FETCH:"recommend-list\u002FFETCH",RESET:"recommend-list\u002FRESET"}},followingList:{list:[],cursor:f,skeleton:a,loading:a,hasMore:c,actionType:{UPDATE_STATE:"following-list\u002FUPDATE_STATE",FETCH_MORE:"following-list\u002FFETCH_MORE",FETCH:"following-list\u002FFETCH",RESET:"following-list\u002FRESET"}}},subscribe:{subscribed:{list:[],cursor:f,skeleton:c,loading:a,hasMore:a,actionType:{UPDATE_STATE:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FUPDATE_STATE",FETCH_MORE:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FFETCH_MORE",FETCH:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FFETCH",RESET:"view\u002Fsubscribe\u002Fsubscribed\u002Flist\u002FRESET"}},all:{list:[],cursor:f,loading:a,skeleton:c,hasMore:a,linkList:e,actionType:{UPDATE_STATE:"view\u002Fsubscribe\u002Fall\u002Flist\u002FUPDATE_STATE",FETCH_MORE:"view\u002Fsubscribe\u002Fall\u002Flist\u002FFETCH_MORE",FETCH:"view\u002Fsubscribe\u002Fall\u002Flist\u002FFETCH",RESET:"view\u002Fsubscribe\u002Fall\u002Flist\u002FRESET"}}},entryPublic:{entry:{user:{}},relatedEntryList:[],relatedCollectionList:[],actionType:{FETCH:"@\u002Fview\u002FentryPublic\u002FFETCH",RESET:"@\u002Fview\u002FentryPublic\u002FRESET"}},user:{user:{},actionType:{FETCH:"@\u002Fview\u002Fuser\u002FFETCH",RESET:"@\u002Fview\u002Fuser\u002FRESET",UPDATE:"@\u002Fview\u002Fuser\u002FUPDATE"},detailList:{actionType:{RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FRESET"},likeList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:c,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FlikePostList\u002FRESET"}},postList:{list:[],hasMore:a,skeleton:a,loading:a,sort:o,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FpostList\u002FRESET"}},tagList:{list:[],loading:a,skeleton:c,hasMore:a,cursor:f,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FtagList\u002FRESET"}},collectionList:{list:[],userId:e,skeleton:c,hasMore:a,cursor:f,type:"created",loading:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FcollectionList\u002FRESET"}},followerList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowerList\u002FRESET"}},followingList:{list:[],cursor:f,hasMore:a,skeleton:a,loading:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FfollowingList\u002FRESET"}},activityList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FactivityList\u002FRESET"}},bookList:{list:[],cursor:f,skeleton:c,hasMore:a,loading:a,type:"bought",actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FbookList\u002FRESET"}},pinList:{list:[],hasMore:a,loading:a,skeleton:c,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinList\u002FRESET"}},courseList:{list:[],hasMore:a,loading:a,skeleton:c,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FcourseList\u002FRESET"}},pinPraisedList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:c,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FpinPraisedList\u002FRESET"}},eventList:{list:[],cursor:f,hasMore:a,loading:a,skeleton:a,actionType:{FETCH:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fuser\u002FdetailList\u002FeventList\u002FRESET"}}}},tag:{tag:{},actionType:{FETCH:"@\u002Fview\u002Ftag\u002FFETCH",FETCH_LIST:"@\u002Fview\u002Ftag\u002FFETCH_LIST",RESET:"@\u002Fview\u002Ftag\u002FRESET"},list:{list:[],cursor:f,loading:a,skeleton:a,hasMore:a,actionType:{UPDATE_STATE:"@\u002Fview\u002Ftag\u002Flist\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Ftag\u002Flist\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Ftag\u002Flist\u002FFETCH",RESET:"@\u002Fview\u002Ftag\u002Flist\u002FRESET"}}},notification:{user:{actionType:{READ_ALL:"@\u002Fview\u002Fnotification\u002Fuser\u002FREAD_ALL",RESET:"@\u002Fview\u002Fnotification\u002Fuser\u002FRESET"},listState:{list:[],cursor:f,hasMore:a,isLoading:a,messageType:3,msgTotal:d,msgSubMap:{"1":d,"2":d,"3":d,"4":d}},list:{pageSize:g,page:h,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fnotification\u002Fuser\u002Flist\u002FRESET"}}},system:{actionType:{READ_ALL:"@\u002Fview\u002Fnotification\u002Fsystem\u002FREAD_ALL",RESET:"@\u002Fview\u002Fnotification\u002Fsystem\u002FRESET"},list:{pageSize:g,page:h,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fnotification\u002Fsystem\u002Flist\u002FRESET"}}}},column:{column:{id:q},entry:{id:q,screenshot:void 0,liked:a,article_id:q,article_info:{article_id:q,user_id:"289926769027053",category_id:"6809637767543259144",tag_ids:[6809640369764958000,6809640375880253000,6809640407484334000,6809640583162757000],visible_level:d,link_url:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F6844903502196506631",cover_image:e,is_gfw:d,title:"聊聊Vue.js的template编译",brief_content:"因为对Vue.js很感兴趣，而且平时工作的技术栈也是Vue.js，这几个月花了些时间研究学习了一下Vue.js源码，并做了总结与输出。 文章的原地址：https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue。 在学习过程中，为Vue加上了中文的注释http…",is_english:d,is_original:h,user_index:d,original_type:d,original_author:e,content:"\u003Ch2 id=\"-\"\u003E写在前面\u003C\u002Fh2\u003E\n\u003Cp\u003E因为对Vue.js很感兴趣，而且平时工作的技术栈也是Vue.js，这几个月花了些时间研究学习了一下Vue.js源码，并做了总结与输出。\u003C\u002Fp\u003E\n\u003Cp\u003E文章的原地址：\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u003C\u002Fa\u003E。\u003C\u002Fp\u003E\n\u003Cp\u003E在学习过程中，为Vue加上了中文的注释\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Ftree\u002Fmaster\u002Fvue-src\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Ftree\u002Fmaster\u002Fvue-src\u003C\u002Fa\u003E，希望可以对其他想学习Vue源码的小伙伴有所帮助。\u003C\u002Fp\u003E\n\u003Cp\u003E可能会有理解存在偏差的地方，欢迎提issue指出，共同学习，共同进步。\u003C\u002Fp\u003E\n\u003Ch2 id=\"-mount\"\u003E$mount\u003C\u002Fh2\u003E\n\u003Cp\u003E首先看一下mount的代码\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E\u003Cspan class=\"hljs-comment\"\u003E\u002F*把原本不带编译的$mount方法保存下来，在最后会调用。*\u002F\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E mount = Vue.prototype.$mount\n\u003Cspan class=\"hljs-comment\"\u003E\u002F*挂载组件，带模板编译*\u002F\u003C\u002Fspan\u003E\nVue.prototype.$mount = \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-params\"\u003E\n  el?: string | Element,\n  hydrating?: boolean\n\u003C\u002Fspan\u003E): \u003Cspan class=\"hljs-title\"\u003EComponent\u003C\u002Fspan\u003E \u003C\u002Fspan\u003E{\n  el = el &amp;&amp; query(el)\n\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (el === \u003Cspan class=\"hljs-built_in\"\u003Edocument\u003C\u002Fspan\u003E.body || el === \u003Cspan class=\"hljs-built_in\"\u003Edocument\u003C\u002Fspan\u003E.documentElement) {\n    process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E &amp;&amp; warn(\n      \u003Cspan class=\"hljs-string\"\u003E`Do not mount Vue to &lt;html&gt; or &lt;body&gt; - mount to normal elements instead.`\u003C\u002Fspan\u003E\n    )\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E\n  }\n\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E options = \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.$options\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F resolve template\u002Fel and convert to render function\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理模板templete，编译成render函数，render不存在的时候才会编译template，否则优先使用render*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (!options.render) {\n    \u003Cspan class=\"hljs-keyword\"\u003Elet\u003C\u002Fspan\u003E template = options.template\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*template存在的时候取template，不存在的时候取el的outerHTML*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (template) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F*当template是字符串的时候*\u002F\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-keyword\"\u003Etypeof\u003C\u002Fspan\u003E template === \u003Cspan class=\"hljs-string\"\u003E'string'\u003C\u002Fspan\u003E) {\n        \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (template.charAt(\u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E) === \u003Cspan class=\"hljs-string\"\u003E'#'\u003C\u002Fspan\u003E) {\n          template = idToTemplate(template)\n          \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n          \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E &amp;&amp; !template) {\n            warn(\n              \u003Cspan class=\"hljs-string\"\u003E`Template element not found or is empty: \u003Cspan class=\"hljs-subst\"\u003E${options.template}\u003C\u002Fspan\u003E`\u003C\u002Fspan\u003E,\n              \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E\n            )\n          }\n        }\n      } \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (template.nodeType) {\n        \u003Cspan class=\"hljs-comment\"\u003E\u002F*当template为DOM节点的时候*\u002F\u003C\u002Fspan\u003E\n        template = template.innerHTML\n      } \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E {\n        \u003Cspan class=\"hljs-comment\"\u003E\u002F*报错*\u002F\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E) {\n          warn(\u003Cspan class=\"hljs-string\"\u003E'invalid template option:'\u003C\u002Fspan\u003E + template, \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E)\n        }\n        \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E\n      }\n    } \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (el) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F*获取element的outerHTML*\u002F\u003C\u002Fspan\u003E\n      template = getOuterHTML(el)\n    }\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (template) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E &amp;&amp; config.performance &amp;&amp; mark) {\n        mark(\u003Cspan class=\"hljs-string\"\u003E'compile'\u003C\u002Fspan\u003E)\n      }\n\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F*将template编译成render函数，这里会有render以及staticRenderFns两个返回，这是vue的编译时优化，static静态不需要在VNode更新时进行patch，优化性能*\u002F\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E { render, staticRenderFns } = compileToFunctions(template, {\n        shouldDecodeNewlines,\n        \u003Cspan class=\"hljs-attr\"\u003Edelimiters\u003C\u002Fspan\u003E: options.delimiters\n      }, \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E)\n      options.render = render\n      options.staticRenderFns = staticRenderFns\n\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E &amp;&amp; config.performance &amp;&amp; mark) {\n        mark(\u003Cspan class=\"hljs-string\"\u003E'compile end'\u003C\u002Fspan\u003E)\n        measure(\u003Cspan class=\"hljs-string\"\u003E`\u003Cspan class=\"hljs-subst\"\u003E${\u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E._name}\u003C\u002Fspan\u003E compile`\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-string\"\u003E'compile'\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-string\"\u003E'compile end'\u003C\u002Fspan\u003E)\n      }\n    }\n  }\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*Github:https:\u002F\u002Fgithub.com\u002Fanswershuto*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*调用const mount = Vue.prototype.$mount保存下来的不带编译的mount*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E mount.call(\u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E, el, hydrating)\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E通过mount代码我们可以看到，在mount的过程中，如果render函数不存在（render函数存在会优先使用render）会将template进行compileToFunctions得到render以及staticRenderFns。譬如说手写组件时加入了template的情况都会在运行时进行编译。而render function在运行后会返回VNode节点，供页面的渲染以及在update的时候patch。接下来我们来看一下template是如何编译的。\u003C\u002Fp\u003E\n\u003Ch2 id=\"-\"\u003E一些基础\u003C\u002Fh2\u003E\n\u003Cp\u003E首先，template会被编译成AST语法树，那么AST是什么？\u003C\u002Fp\u003E\n\u003Cp\u003E在计算机科学中，抽象语法树（abstract syntax tree或者缩写为AST），或者语法树（syntax tree），是源代码的抽象语法结构的树状表现形式，这里特指编程语言的源代码。具体可以查看\u003Ca href=\"https:\u002F\u002Fzh.wikipedia.org\u002Fwiki\u002F%E6%8A%BD%E8%B1%A1%E8%AA%9E%E6%B3%95%E6%A8%B9\"\u003E抽象语法树\u003C\u002Fa\u003E。\u003C\u002Fp\u003E\n\u003Cp\u003EAST会经过generate得到render函数，render的返回值是VNode，VNode是Vue的虚拟DOM节点，具体定义如下：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Edefault\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EVNode\u003C\u002Fspan\u003E \u003C\u002Fspan\u003E{\n  tag: string | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  data: VNodeData | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  children: ?\u003Cspan class=\"hljs-built_in\"\u003EArray\u003C\u002Fspan\u003E&lt;VNode&gt;;\n  text: string | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  elm: Node | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  ns: string | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  context: Component | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F rendered in this component's scope\u003C\u002Fspan\u003E\n  functionalContext: Component | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F only for functional component root nodes\u003C\u002Fspan\u003E\n  key: string | number | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  componentOptions: VNodeComponentOptions | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  componentInstance: Component | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F component instance\u003C\u002Fspan\u003E\n  parent: VNode | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F component placeholder node\u003C\u002Fspan\u003E\n  raw: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F contains raw HTML? (server only)\u003C\u002Fspan\u003E\n  isStatic: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F hoisted static node\u003C\u002Fspan\u003E\n  isRootInsert: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F necessary for enter transition check\u003C\u002Fspan\u003E\n  isComment: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F empty comment placeholder?\u003C\u002Fspan\u003E\n  isCloned: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F is a cloned node?\u003C\u002Fspan\u003E\n  isOnce: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F is a v-once node?\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*Github:https:\u002F\u002Fgithub.com\u002Fanswershuto*\u002F\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"hljs-keyword\"\u003Econstructor\u003C\u002Fspan\u003E (\n    tag?: string,\n    data?: VNodeData,\n    children?: ?Array&lt;VNode&gt;,\n    text?: string,\n    elm?: Node,\n    context?: Component,\n    componentOptions?: VNodeComponentOptions\n  ) {\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点的标签名*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.tag = tag\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点对应的对象，包含了具体的一些数据信息，是一个VNodeData类型，可以参考VNodeData类型中的数据信息*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.data = data\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点的子节点，是一个数组*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.children = children\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点的文本*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.text = text\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前虚拟节点对应的真实dom节点*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.elm = elm\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点的名字空间*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.ns = \u003Cspan class=\"hljs-literal\"\u003Eundefined\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*编译作用域*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.context = context\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*函数化组件作用域*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.functionalContext = \u003Cspan class=\"hljs-literal\"\u003Eundefined\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*节点的key属性，被当作节点的标志，用以优化*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.key = data &amp;&amp; data.key\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*组件的option选项*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.componentOptions = componentOptions\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点对应的组件的实例*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.componentInstance = \u003Cspan class=\"hljs-literal\"\u003Eundefined\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点的父节点*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.parent = \u003Cspan class=\"hljs-literal\"\u003Eundefined\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*简而言之就是是否为原生HTML或只是普通文本，innerHTML的时候为true，textContent的时候为false*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.raw = \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*静态节点标志*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.isStatic = \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*是否作为跟节点插入*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.isRootInsert = \u003Cspan class=\"hljs-literal\"\u003Etrue\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*是否为注释节点*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.isComment = \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*是否为克隆节点*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.isCloned = \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*是否有v-once指令*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.isOnce = \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E\n  }\n\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F DEPRECATED: alias for componentInstance for backwards compat.\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore next *\u002F\u003C\u002Fspan\u003E\n  get child (): Component | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E {\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.componentInstance\n  }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E关于VNode的一些细节，请参考\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Fblob\u002Fmaster\u002Fdocs\u002FVNode%E8%8A%82%E7%82%B9.MarkDown\"\u003EVNode节点\u003C\u002Fa\u003E。\u003C\u002Fp\u003E\n\u003Ch2 id=\"createcompiler\"\u003EcreateCompiler\u003C\u002Fh2\u003E\n\u003Cp\u003EcreateCompiler用以创建编译器，返回值是compile以及compileToFunctions。compile是一个编译器，它会将传入的template转换成对应的AST树、render函数以及staticRenderFns函数。而compileToFunctions则是带缓存的编译器，同时staticRenderFns以及render函数会被转换成Funtion对象。\u003C\u002Fp\u003E\n\u003Cp\u003E因为不同平台有一些不同的options，所以createCompiler会根据平台区分传入一个baseOptions，会与compile本身传入的options合并得到最终的finalOptions。\u003C\u002Fp\u003E\n\u003Ch2 id=\"compiletofunctions\"\u003EcompileToFunctions\u003C\u002Fh2\u003E\n\u003Cp\u003E首先还是贴一下compileToFunctions的代码。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E  \u003Cspan class=\"hljs-comment\"\u003E\u002F*带缓存的编译器，同时staticRenderFns以及render函数会被转换成Funtion对象*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EcompileToFunctions\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-params\"\u003E\n    template: string,\n    options?: CompilerOptions,\n    vm?: Component\n  \u003C\u002Fspan\u003E): \u003Cspan class=\"hljs-title\"\u003ECompiledFunctionResult\u003C\u002Fspan\u003E \u003C\u002Fspan\u003E{\n    options = options || {}\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F detect possible CSP restriction\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Etry\u003C\u002Fspan\u003E {\n        \u003Cspan class=\"hljs-keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-built_in\"\u003EFunction\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-string\"\u003E'return 1'\u003C\u002Fspan\u003E)\n      } \u003Cspan class=\"hljs-keyword\"\u003Ecatch\u003C\u002Fspan\u003E (e) {\n        \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (e.toString().match(\u003Cspan class=\"hljs-regexp\"\u003E\u002Funsafe-eval|CSP\u002F\u003C\u002Fspan\u003E)) {\n          warn(\n            \u003Cspan class=\"hljs-string\"\u003E'It seems you are using the standalone build of Vue.js in an '\u003C\u002Fspan\u003E +\n            \u003Cspan class=\"hljs-string\"\u003E'environment with Content Security Policy that prohibits unsafe-eval. '\u003C\u002Fspan\u003E +\n            \u003Cspan class=\"hljs-string\"\u003E'The template compiler cannot work in this environment. Consider '\u003C\u002Fspan\u003E +\n            \u003Cspan class=\"hljs-string\"\u003E'relaxing the policy to allow unsafe-eval or pre-compiling your '\u003C\u002Fspan\u003E +\n            \u003Cspan class=\"hljs-string\"\u003E'templates into render functions.'\u003C\u002Fspan\u003E\n          )\n        }\n      }\n    }\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*Github:https:\u002F\u002Fgithub.com\u002Fanswershuto*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F check cache\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*有缓存的时候直接取出缓存中的结果即可*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E key = options.delimiters\n      ? \u003Cspan class=\"hljs-built_in\"\u003EString\u003C\u002Fspan\u003E(options.delimiters) + template\n      : template\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (functionCompileCache[key]) {\n      \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E functionCompileCache[key]\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F compile\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*编译*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E compiled = compile(template, options)\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F check compilation errors\u002Ftips\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E) {\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (compiled.errors &amp;&amp; compiled.errors.length) {\n        warn(\n          \u003Cspan class=\"hljs-string\"\u003E`Error compiling template:\\n\\n\u003Cspan class=\"hljs-subst\"\u003E${template}\u003C\u002Fspan\u003E\\n\\n`\u003C\u002Fspan\u003E +\n          compiled.errors.map(\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-params\"\u003Ee\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E`- \u003Cspan class=\"hljs-subst\"\u003E${e}\u003C\u002Fspan\u003E`\u003C\u002Fspan\u003E).join(\u003Cspan class=\"hljs-string\"\u003E'\\n'\u003C\u002Fspan\u003E) + \u003Cspan class=\"hljs-string\"\u003E'\\n'\u003C\u002Fspan\u003E,\n          vm\n        )\n      }\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (compiled.tips &amp;&amp; compiled.tips.length) {\n        compiled.tips.forEach(\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-params\"\u003Emsg\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E tip(msg, vm))\n      }\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F turn code into functions\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E res = {}\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E fnGenErrors = []\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*将render转换成Funtion对象*\u002F\u003C\u002Fspan\u003E\n    res.render = makeFunction(compiled.render, fnGenErrors)\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*将staticRenderFns全部转化成Funtion对象 *\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E l = compiled.staticRenderFns.length\n    res.staticRenderFns = \u003Cspan class=\"hljs-keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-built_in\"\u003EArray\u003C\u002Fspan\u003E(l)\n    \u003Cspan class=\"hljs-keyword\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-keyword\"\u003Elet\u003C\u002Fspan\u003E i = \u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E; i &lt; l; i++) {\n      res.staticRenderFns[i] = makeFunction(compiled.staticRenderFns[i], fnGenErrors)\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F check function generation errors.\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F this should only happen if there is a bug in the compiler itself.\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F mostly for codegen development use\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E) {\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E ((!compiled.errors || !compiled.errors.length) &amp;&amp; fnGenErrors.length) {\n        warn(\n          \u003Cspan class=\"hljs-string\"\u003E`Failed to generate render function:\\n\\n`\u003C\u002Fspan\u003E +\n          fnGenErrors.map(\u003Cspan class=\"hljs-function\"\u003E(\u003Cspan class=\"hljs-params\"\u003E{ err, code }\u003C\u002Fspan\u003E) =&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E`\u003Cspan class=\"hljs-subst\"\u003E${err.toString()}\u003C\u002Fspan\u003E in\\n\\n\u003Cspan class=\"hljs-subst\"\u003E${code}\u003C\u002Fspan\u003E\\n`\u003C\u002Fspan\u003E).join(\u003Cspan class=\"hljs-string\"\u003E'\\n'\u003C\u002Fspan\u003E),\n          vm\n        )\n      }\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*存放在缓存中，以免每次都重新编译*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E (functionCompileCache[key] = res) \n  }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E我们可以发现，在闭包中，会有一个functionCompileCache对象作为缓存器。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E  \u003Cspan class=\"hljs-comment\"\u003E\u002F*作为缓存，防止每次都重新编译*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E functionCompileCache: {\n    [key: string]: CompiledFunctionResult;\n  } = \u003Cspan class=\"hljs-built_in\"\u003EObject\u003C\u002Fspan\u003E.create(\u003Cspan class=\"hljs-literal\"\u003Enull\u003C\u002Fspan\u003E)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E在进入compileToFunctions以后，会先检查缓存中是否有已经编译好的结果，如果有结果则直接从缓存中读取。这样做防止每次同样的模板都要进行重复的编译工作。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F check cache\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*有缓存的时候直接取出缓存中的结果即可*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E key = options.delimiters\n      ? \u003Cspan class=\"hljs-built_in\"\u003EString\u003C\u002Fspan\u003E(options.delimiters) + template\n      : template\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (functionCompileCache[key]) {\n      \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E functionCompileCache[key]\n    }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E在compileToFunctions的末尾会将编译结果进行缓存\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E  \u003Cspan class=\"hljs-comment\"\u003E\u002F*存放在缓存中，以免每次都重新编译*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E (functionCompileCache[key] = res)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2 id=\"compile\"\u003Ecompile\u003C\u002Fh2\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E  \u003Cspan class=\"hljs-comment\"\u003E\u002F*编译，将模板template编译成AST树、render函数以及staticRenderFns函数*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Ecompile\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-params\"\u003E\n    template: string,\n    options?: CompilerOptions\n  \u003C\u002Fspan\u003E): \u003Cspan class=\"hljs-title\"\u003ECompiledResult\u003C\u002Fspan\u003E \u003C\u002Fspan\u003E{\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E finalOptions = \u003Cspan class=\"hljs-built_in\"\u003EObject\u003C\u002Fspan\u003E.create(baseOptions)\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E errors = []\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E tips = []\n    finalOptions.warn = \u003Cspan class=\"hljs-function\"\u003E(\u003Cspan class=\"hljs-params\"\u003Emsg, tip\u003C\u002Fspan\u003E) =&gt;\u003C\u002Fspan\u003E {\n      (tip ? tips : errors).push(msg)\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*做下面这些merge的目的因为不同平台可以提供自己本身平台的一个baseOptions，内部封装了平台自己的实现，然后把共同的部分抽离开来放在这层compiler中，所以在这里需要merge一下*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (options) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F merge custom modules\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F*合并modules*\u002F\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (options.modules) {\n        finalOptions.modules = (baseOptions.modules || []).concat(options.modules)\n      }\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F merge custom directives\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (options.directives) {\n        \u003Cspan class=\"hljs-comment\"\u003E\u002F*合并directives*\u002F\u003C\u002Fspan\u003E\n        finalOptions.directives = extend(\n          \u003Cspan class=\"hljs-built_in\"\u003EObject\u003C\u002Fspan\u003E.create(baseOptions.directives),\n          options.directives\n        )\n      }\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F copy other options\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E key \u003Cspan class=\"hljs-keyword\"\u003Ein\u003C\u002Fspan\u003E options) {\n        \u003Cspan class=\"hljs-comment\"\u003E\u002F*合并其余的options，modules与directives已经在上面做了特殊处理了*\u002F\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (key !== \u003Cspan class=\"hljs-string\"\u003E'modules'\u003C\u002Fspan\u003E &amp;&amp; key !== \u003Cspan class=\"hljs-string\"\u003E'directives'\u003C\u002Fspan\u003E) {\n          finalOptions[key] = options[key]\n        }\n      }\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*基础模板编译，得到编译结果*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E compiled = baseCompile(template, finalOptions)\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E) {\n      errors.push.apply(errors, detectErrors(compiled.ast))\n    }\n    compiled.errors = errors\n    compiled.tips = tips\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E compiled\n  }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Ecompile主要做了两件事，一件是合并option（前面说的将平台自有的option与传入的option进行合并），另一件是baseCompile，进行模板template的编译。\u003C\u002Fp\u003E\n\u003Cp\u003E来看一下baseCompile\u003C\u002Fp\u003E\n\u003Ch2 id=\"basecompile\"\u003EbaseCompile\u003C\u002Fh2\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EbaseCompile\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-params\"\u003E\n  template: string,\n  options: CompilerOptions\n\u003C\u002Fspan\u003E): \u003Cspan class=\"hljs-title\"\u003ECompiledResult\u003C\u002Fspan\u003E \u003C\u002Fspan\u003E{\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*parse解析得到ast树*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E ast = parse(template.trim(), options)\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*\n    将AST树进行优化\n    优化的目标：生成模板AST树，检测不需要进行DOM改变的静态子树。\n    一旦检测到这些静态树，我们就能做以下这些事情：\n    1.把它们变成常数，这样我们就再也不需要每次重新渲染时创建新的节点了。\n    2.在patch的过程中直接跳过。\n *\u002F\u003C\u002Fspan\u003E\n  optimize(ast, options)\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*根据ast树生成所需的code（内部包含render与staticRenderFns）*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E code = generate(ast, options)\n  \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E {\n    ast,\n    \u003Cspan class=\"hljs-attr\"\u003Erender\u003C\u002Fspan\u003E: code.render,\n    \u003Cspan class=\"hljs-attr\"\u003EstaticRenderFns\u003C\u002Fspan\u003E: code.staticRenderFns\n  }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EbaseCompile首先会将模板template进行parse得到一个AST语法树，再通过optimize做一些优化，最后通过generate得到render以及staticRenderFns。\u003C\u002Fp\u003E\n\u003Ch3 id=\"parse\"\u003Eparse\u003C\u002Fh3\u003E\n\u003Cp\u003Eparse的源码可以参见\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Fblob\u002Fmaster\u002Fvue-src\u002Fcompiler\u002Fparser\u002Findex.js#L53\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Fblob\u002Fmaster\u002Fvue-src\u002Fcompiler\u002Fparser\u002Findex.js#L53\u003C\u002Fa\u003E。\u003C\u002Fp\u003E\n\u003Cp\u003Eparse会用正则等方式解析template模板中的指令、class、style等数据，形成AST语法树。\u003C\u002Fp\u003E\n\u003Ch3 id=\"optimize\"\u003Eoptimize\u003C\u002Fh3\u003E\n\u003Cp\u003Eoptimize的主要作用是标记static静态节点，这是Vue在编译过程中的一处优化，后面当update更新界面时，会有一个patch的过程，diff算法会直接跳过静态节点，从而减少了比较的过程，优化了patch的性能。\u003C\u002Fp\u003E\n\u003Ch3 id=\"generate\"\u003Egenerate\u003C\u002Fh3\u003E\n\u003Cp\u003Egenerate是将AST语法树转化成render funtion字符串的过程，得到结果是render的字符串以及staticRenderFns字符串。\u003C\u002Fp\u003E\n\u003Chr\u003E\n\u003Cp\u003E至此，我们的template模板已经被转化成了我们所需的AST语法树、render function字符串以及staticRenderFns字符串。\u003C\u002Fp\u003E\n\u003Ch2 id=\"-\"\u003E举个例子\u003C\u002Fh2\u003E\n\u003Cp\u003E来看一下这段代码的编译结果\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs html\"\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Eclass\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E\"main\"\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003E:class\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E\"bindClass\"\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E{{text}}\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003Ehello world\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Ev-for\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E\"(item, index) in arr\"\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E{{item.name}}\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E{{item.value}}\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E{{index}}\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E---\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Ev-if\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E\"text\"\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n        {{text}}\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Ev-else\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E转化后得到AST树，如下图：\u003C\u002Fp\u003E\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cfigure\u003E\u003Cimg alt=\"img\" src=\"https:\u002F\u002Fuser-gold-cdn.xitu.io\u002F2017\u002F10\u002F8\u002F936953ce3bdbfd3f42852ef10c7ae13e\"\u003E\u003Cfigcaption\u003Eimg\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E我们可以看到最外层的div是这颗AST树的根节点，节点上有许多数据代表这个节点的形态，比如static表示是否是静态节点，staticClass表示静态class属性（非bind:class）。children代表该节点的子节点，可以看到children是一个长度为4的数组，里面包含的是该节点下的四个div子节点。children里面的节点与父节点的结构类似，层层往下形成一棵AST语法树。\u003C\u002Fp\u003E\n\u003Cp\u003E再来看看由AST得到的render函数\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003Ewith(this){\n    return _c(  'div',\n                {\n                    \u002F*static class*\u002F\n                    staticClass:\"main\",\n                    \u002F*bind class*\u002F\n                    class:bindClass\n                },\n                [\n                    _c( 'div', [_v(_s(text))]),\n                    _c('div',[_v(\"hello world\")]),\n                    \u002F*这是一个v-for循环*\u002F\n                    _l(\n                        (arr),\n                        function(item,index){\n                            return _c(  'div',\n                                        [_c('p',[_v(_s(item.name))]),\n                                        _c('p',[_v(_s(item.value))]),\n                                        _c('p',[_v(_s(index))]),\n                                        _c('p',[_v(\"---\")])]\n                                    )\n                        }\n                    ),\n                    \u002F*这是v-if*\u002F\n                    (text)?_c('div',[_v(_s(text))]):_c('div',[_v(\"no text\")])],\n                    2\n            )\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2 id=\"-_c-_v-_s-_q\"\u003E_c，_v，_s，_q\u003C\u002Fh2\u003E\n\u003Cp\u003E看了render function字符串，发现有大量的_c，_v，_s，_q，这些函数究竟是什么？\u003C\u002Fp\u003E\n\u003Cp\u003E带着问题，我们来看一下\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Fblob\u002Fmaster\u002Fvue-src\u002Fcore\u002Finstance\u002Frender.js#L124\"\u003Ecore\u002Finstance\u002Frender\u003C\u002Fa\u003E。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E\u003Cspan class=\"hljs-comment\"\u003E\u002F*处理v-once的渲染函数*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._o = markOnce\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*将字符串转化为数字，如果转换失败会返回原字符串*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._n = toNumber\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*将val转化成字符串*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._s = toString\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理v-for列表渲染*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._l = renderList\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理slot的渲染*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._t = renderSlot\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*检测两个变量是否相等*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._q = looseEqual\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*检测arr数组中是否包含与val变量相等的项*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._i = looseIndexOf\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理static树的渲染*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._m = renderStatic\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理filters*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._f = resolveFilter\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*从config配置中检查eventKeyCode是否存在*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._k = checkKeyCodes\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*合并v-bind指令到VNode中*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._b = bindObjectProps\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*创建一个文本节点*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._v = createTextVNode\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*创建一个空VNode节点*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._e = createEmptyVNode\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理ScopedSlots*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._u = resolveScopedSlots\n\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*创建VNode节点*\u002F\u003C\u002Fspan\u003E\n  vm._c = \u003Cspan class=\"hljs-function\"\u003E(\u003Cspan class=\"hljs-params\"\u003Ea, b, c, d\u003C\u002Fspan\u003E) =&gt;\u003C\u002Fspan\u003E createElement(vm, a, b, c, d, \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E通过这些函数，render函数最后会返回一个VNode节点，在_update的时候，经过patch与之前的VNode节点进行比较，得出差异后将这些差异渲染到真实的DOM上。\u003C\u002Fp\u003E\n\u003Ch2 id=\"-\"\u003E关于\u003C\u002Fh2\u003E\n\u003Cp\u003E作者：染陌 \u003C\u002Fp\u003E\n\u003Cp\u003EEmail：answershuto@gmail.com  or  answershuto@126.com\u003C\u002Fp\u003E\n\u003Cp\u003EGithub:  \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fanswershuto\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EBlog：\u003Ca href=\"http:\u002F\u002Fanswershuto.github.io\u002F\"\u003Ehttp:\u002F\u002Fanswershuto.github.io\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E知乎主页：\u003Ca href=\"https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002Fcao-yang-49\u002Factivities\"\u003Ehttps:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002Fcao-yang-49\u002Factivities\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E知乎专栏：\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Franmo\"\u003Ehttps:\u002F\u002Fzhuanlan.zhihu.com\u002Franmo\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E掘金： \u003Ca href=\"https:\u002F\u002Fjuejin.im\u002Fuser\u002F289926769027053\"\u003Ehttps:\u002F\u002Fjuejin.im\u002Fuser\u002F289926769027053\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EosChina：\u003Ca href=\"https:\u002F\u002Fmy.oschina.net\u002Fu\u002F3161824\u002Fblog\"\u003Ehttps:\u002F\u002Fmy.oschina.net\u002Fu\u002F3161824\u002Fblog\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E转载请注明出处，谢谢。\u003C\u002Fp\u003E\n\u003Cp\u003E欢迎关注我的公众号\u003C\u002Fp\u003E\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cfigure\u003E\u003Cimg alt=\"\" src=\"https:\u002F\u002Fuser-gold-cdn.xitu.io\u002F2017\u002F9\u002F24\u002F99de30e7ef948aabf132e91d543807a0\"\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\n",ctime:"1507466977",mtime:"1599320703",rtime:"1507466977",draft_id:"6845075308366823437",view_count:7962,collect_count:d,digg_count:179,comment_count:2,hot_index:579,is_hot:d,rank_index:.00012797,status:2,verify_status:h,audit_status:2,mark_content:e},author_user_info:{user_id:"289926769027053",user_name:"染陌同学",company:"Alibaba",job_title:"前端工程师",avatar_large:"https:\u002F\u002Fmirror-gold-cdn.xitu.io\u002F168e0848e3909ec96a7",level:3,description:e,followee_count:115,follower_count:9803,post_article_count:28,digg_article_count:154,got_digg_count:3934,got_view_count:163058,post_shortmsg_count:36,digg_shortmsg_count:140,isfollowed:a,favorable_author:h,power:4550,study_point:d,university:b,major:b,student_status:d,select_event_count:d,select_online_course_count:d,identity:d},category:{category_id:"6809637767543259144",category_name:"前端",category_url:"frontend",rank:2,ctime:1457483942,mtime:1432503190,show_type:3,id:"6809637767543259144",name:"前端",title:"前端",alias:"frontend"},tags:[{entriesCount:void 0,subscribed:a,id:"6809640369764958215",tag_id:"6809640369764958215",tag_name:"Vue.js",color:"#41B883",icon:"https:\u002F\u002Flc-gold-cdn.xitu.io\u002F7b5c3eb591b671749fee.png",back_ground:e,show_navi:d,tag_alias:e,post_article_count:20782,concern_user_count:278606,title:"Vue.js",tagId:"6809640369764958215",articleCount:20782,subscribersCount:278606,createdAt:b,updatedAt:b},{entriesCount:void 0,subscribed:a,id:"6809640375880253447",tag_id:"6809640375880253447",tag_name:"GitHub",color:"#616161",icon:"https:\u002F\u002Flc-gold-cdn.xitu.io\u002F0d614af263aa63aa6a77.png",back_ground:e,show_navi:d,tag_alias:e,post_article_count:9056,concern_user_count:348479,title:"GitHub",tagId:"6809640375880253447",articleCount:9056,subscribersCount:348479,createdAt:b,updatedAt:b},{entriesCount:void 0,subscribed:a,id:"6809640407484334093",tag_id:"6809640407484334093",tag_name:"前端",color:"#60ADFF",icon:"https:\u002F\u002Flc-gold-cdn.xitu.io\u002Fbac28828a49181c34110.png",back_ground:e,show_navi:h,tag_alias:e,post_article_count:48642,concern_user_count:477485,title:"前端",tagId:"6809640407484334093",articleCount:48642,subscribersCount:477485,createdAt:b,updatedAt:b},{entriesCount:void 0,subscribed:a,id:"6809640583162757128",tag_id:"6809640583162757128",tag_name:"编译器",color:"#000000",icon:"https:\u002F\u002Flc-gold-cdn.xitu.io\u002F4e6b1fae46570c191c18.png",back_ground:e,show_navi:d,tag_alias:e,post_article_count:1928,concern_user_count:20611,title:"编译器",tagId:"6809640583162757128",articleCount:1928,subscribersCount:20611,createdAt:b,updatedAt:b}],user_interact:{id:6844903502196507000,omitempty:2,user_id:d,is_digg:a,is_follow:a,is_collect:a},title:"聊聊Vue.js的template编译",user:{id:"289926769027053",self_description:void 0,followed:a,viewerIsFollowing:void 0,community:void 0,subscribedTagCount:d,wroteBookCount:d,boughtBookCount:d,isBindedPhone:a,level:3,user_id:"289926769027053",user_name:"染陌同学",company:"Alibaba",job_title:"前端工程师",avatar_large:"https:\u002F\u002Fmirror-gold-cdn.xitu.io\u002F168e0848e3909ec96a7",description:e,followee_count:115,follower_count:9803,post_article_count:28,digg_article_count:154,got_digg_count:3934,got_view_count:163058,post_shortmsg_count:36,digg_shortmsg_count:140,isfollowed:a,favorable_author:h,power:4550,study_point:d,university:b,major:b,student_status:d,select_event_count:d,select_online_course_count:d,identity:d,juejinPower:4550,jobTitle:"前端工程师",roles:{isBookAuthor:a,isFavorableAuthor:c,isCobuilder:a,isAdmin:a},username:"染陌同学",blogAddress:void 0,selfDescription:e,beLikedCount:3934,beReadCount:163058,followerCount:9803,followingCount:115,collectionCount:d,createdCollectionCount:d,followingCollectionCount:d,postedPostsCount:28,pinCount:36,likedArticleCount:154,likedPinCount:140,avatar:"https:\u002F\u002Fmirror-gold-cdn.xitu.io\u002F168e0848e3909ec96a7",latestLoginedInAt:b,createdAt:b,updatedAt:b,phoneNumber:e,titleDescription:e,followeesCount:115,applyEventCount:d},viewCount:void 0,commentsCount:2,isEvent:void 0,abstract:"因为对Vue.js很感兴趣，而且平时工作的技术栈也是Vue.js，这几个月花了些时间研究学习了一下Vue.js源码，并做了总结与输出。 文章的原地址：https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue。 在学习过程中，为Vue加上了中文的注释http…",latestCommentAt:b,createdAt:new Date(1507466977000),updatedAt:b,isTopicEvent:a,likedCount:179,likeCount:179,content:"\u003Ch2 id=\"-\"\u003E写在前面\u003C\u002Fh2\u003E\n\u003Cp\u003E因为对Vue.js很感兴趣，而且平时工作的技术栈也是Vue.js，这几个月花了些时间研究学习了一下Vue.js源码，并做了总结与输出。\u003C\u002Fp\u003E\n\u003Cp\u003E文章的原地址：\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u003C\u002Fa\u003E。\u003C\u002Fp\u003E\n\u003Cp\u003E在学习过程中，为Vue加上了中文的注释\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Ftree\u002Fmaster\u002Fvue-src\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Ftree\u002Fmaster\u002Fvue-src\u003C\u002Fa\u003E，希望可以对其他想学习Vue源码的小伙伴有所帮助。\u003C\u002Fp\u003E\n\u003Cp\u003E可能会有理解存在偏差的地方，欢迎提issue指出，共同学习，共同进步。\u003C\u002Fp\u003E\n\u003Ch2 id=\"-mount\"\u003E$mount\u003C\u002Fh2\u003E\n\u003Cp\u003E首先看一下mount的代码\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E\u003Cspan class=\"hljs-comment\"\u003E\u002F*把原本不带编译的$mount方法保存下来，在最后会调用。*\u002F\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E mount = Vue.prototype.$mount\n\u003Cspan class=\"hljs-comment\"\u003E\u002F*挂载组件，带模板编译*\u002F\u003C\u002Fspan\u003E\nVue.prototype.$mount = \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-params\"\u003E\n  el?: string | Element,\n  hydrating?: boolean\n\u003C\u002Fspan\u003E): \u003Cspan class=\"hljs-title\"\u003EComponent\u003C\u002Fspan\u003E \u003C\u002Fspan\u003E{\n  el = el &amp;&amp; query(el)\n\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (el === \u003Cspan class=\"hljs-built_in\"\u003Edocument\u003C\u002Fspan\u003E.body || el === \u003Cspan class=\"hljs-built_in\"\u003Edocument\u003C\u002Fspan\u003E.documentElement) {\n    process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E &amp;&amp; warn(\n      \u003Cspan class=\"hljs-string\"\u003E`Do not mount Vue to &lt;html&gt; or &lt;body&gt; - mount to normal elements instead.`\u003C\u002Fspan\u003E\n    )\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E\n  }\n\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E options = \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.$options\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F resolve template\u002Fel and convert to render function\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理模板templete，编译成render函数，render不存在的时候才会编译template，否则优先使用render*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (!options.render) {\n    \u003Cspan class=\"hljs-keyword\"\u003Elet\u003C\u002Fspan\u003E template = options.template\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*template存在的时候取template，不存在的时候取el的outerHTML*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (template) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F*当template是字符串的时候*\u002F\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-keyword\"\u003Etypeof\u003C\u002Fspan\u003E template === \u003Cspan class=\"hljs-string\"\u003E'string'\u003C\u002Fspan\u003E) {\n        \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (template.charAt(\u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E) === \u003Cspan class=\"hljs-string\"\u003E'#'\u003C\u002Fspan\u003E) {\n          template = idToTemplate(template)\n          \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n          \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E &amp;&amp; !template) {\n            warn(\n              \u003Cspan class=\"hljs-string\"\u003E`Template element not found or is empty: \u003Cspan class=\"hljs-subst\"\u003E${options.template}\u003C\u002Fspan\u003E`\u003C\u002Fspan\u003E,\n              \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E\n            )\n          }\n        }\n      } \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (template.nodeType) {\n        \u003Cspan class=\"hljs-comment\"\u003E\u002F*当template为DOM节点的时候*\u002F\u003C\u002Fspan\u003E\n        template = template.innerHTML\n      } \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E {\n        \u003Cspan class=\"hljs-comment\"\u003E\u002F*报错*\u002F\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E) {\n          warn(\u003Cspan class=\"hljs-string\"\u003E'invalid template option:'\u003C\u002Fspan\u003E + template, \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E)\n        }\n        \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E\n      }\n    } \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (el) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F*获取element的outerHTML*\u002F\u003C\u002Fspan\u003E\n      template = getOuterHTML(el)\n    }\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (template) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E &amp;&amp; config.performance &amp;&amp; mark) {\n        mark(\u003Cspan class=\"hljs-string\"\u003E'compile'\u003C\u002Fspan\u003E)\n      }\n\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F*将template编译成render函数，这里会有render以及staticRenderFns两个返回，这是vue的编译时优化，static静态不需要在VNode更新时进行patch，优化性能*\u002F\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E { render, staticRenderFns } = compileToFunctions(template, {\n        shouldDecodeNewlines,\n        \u003Cspan class=\"hljs-attr\"\u003Edelimiters\u003C\u002Fspan\u003E: options.delimiters\n      }, \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E)\n      options.render = render\n      options.staticRenderFns = staticRenderFns\n\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E &amp;&amp; config.performance &amp;&amp; mark) {\n        mark(\u003Cspan class=\"hljs-string\"\u003E'compile end'\u003C\u002Fspan\u003E)\n        measure(\u003Cspan class=\"hljs-string\"\u003E`\u003Cspan class=\"hljs-subst\"\u003E${\u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E._name}\u003C\u002Fspan\u003E compile`\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-string\"\u003E'compile'\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-string\"\u003E'compile end'\u003C\u002Fspan\u003E)\n      }\n    }\n  }\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*Github:https:\u002F\u002Fgithub.com\u002Fanswershuto*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*调用const mount = Vue.prototype.$mount保存下来的不带编译的mount*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E mount.call(\u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E, el, hydrating)\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E通过mount代码我们可以看到，在mount的过程中，如果render函数不存在（render函数存在会优先使用render）会将template进行compileToFunctions得到render以及staticRenderFns。譬如说手写组件时加入了template的情况都会在运行时进行编译。而render function在运行后会返回VNode节点，供页面的渲染以及在update的时候patch。接下来我们来看一下template是如何编译的。\u003C\u002Fp\u003E\n\u003Ch2 id=\"-\"\u003E一些基础\u003C\u002Fh2\u003E\n\u003Cp\u003E首先，template会被编译成AST语法树，那么AST是什么？\u003C\u002Fp\u003E\n\u003Cp\u003E在计算机科学中，抽象语法树（abstract syntax tree或者缩写为AST），或者语法树（syntax tree），是源代码的抽象语法结构的树状表现形式，这里特指编程语言的源代码。具体可以查看\u003Ca href=\"https:\u002F\u002Fzh.wikipedia.org\u002Fwiki\u002F%E6%8A%BD%E8%B1%A1%E8%AA%9E%E6%B3%95%E6%A8%B9\"\u003E抽象语法树\u003C\u002Fa\u003E。\u003C\u002Fp\u003E\n\u003Cp\u003EAST会经过generate得到render函数，render的返回值是VNode，VNode是Vue的虚拟DOM节点，具体定义如下：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Edefault\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-class\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EVNode\u003C\u002Fspan\u003E \u003C\u002Fspan\u003E{\n  tag: string | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  data: VNodeData | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  children: ?\u003Cspan class=\"hljs-built_in\"\u003EArray\u003C\u002Fspan\u003E&lt;VNode&gt;;\n  text: string | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  elm: Node | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  ns: string | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  context: Component | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F rendered in this component's scope\u003C\u002Fspan\u003E\n  functionalContext: Component | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F only for functional component root nodes\u003C\u002Fspan\u003E\n  key: string | number | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  componentOptions: VNodeComponentOptions | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E;\n  componentInstance: Component | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F component instance\u003C\u002Fspan\u003E\n  parent: VNode | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F component placeholder node\u003C\u002Fspan\u003E\n  raw: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F contains raw HTML? (server only)\u003C\u002Fspan\u003E\n  isStatic: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F hoisted static node\u003C\u002Fspan\u003E\n  isRootInsert: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F necessary for enter transition check\u003C\u002Fspan\u003E\n  isComment: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F empty comment placeholder?\u003C\u002Fspan\u003E\n  isCloned: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F is a cloned node?\u003C\u002Fspan\u003E\n  isOnce: boolean; \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F is a v-once node?\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*Github:https:\u002F\u002Fgithub.com\u002Fanswershuto*\u002F\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"hljs-keyword\"\u003Econstructor\u003C\u002Fspan\u003E (\n    tag?: string,\n    data?: VNodeData,\n    children?: ?Array&lt;VNode&gt;,\n    text?: string,\n    elm?: Node,\n    context?: Component,\n    componentOptions?: VNodeComponentOptions\n  ) {\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点的标签名*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.tag = tag\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点对应的对象，包含了具体的一些数据信息，是一个VNodeData类型，可以参考VNodeData类型中的数据信息*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.data = data\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点的子节点，是一个数组*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.children = children\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点的文本*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.text = text\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前虚拟节点对应的真实dom节点*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.elm = elm\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点的名字空间*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.ns = \u003Cspan class=\"hljs-literal\"\u003Eundefined\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*编译作用域*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.context = context\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*函数化组件作用域*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.functionalContext = \u003Cspan class=\"hljs-literal\"\u003Eundefined\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*节点的key属性，被当作节点的标志，用以优化*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.key = data &amp;&amp; data.key\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*组件的option选项*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.componentOptions = componentOptions\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点对应的组件的实例*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.componentInstance = \u003Cspan class=\"hljs-literal\"\u003Eundefined\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*当前节点的父节点*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.parent = \u003Cspan class=\"hljs-literal\"\u003Eundefined\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*简而言之就是是否为原生HTML或只是普通文本，innerHTML的时候为true，textContent的时候为false*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.raw = \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*静态节点标志*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.isStatic = \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*是否作为跟节点插入*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.isRootInsert = \u003Cspan class=\"hljs-literal\"\u003Etrue\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*是否为注释节点*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.isComment = \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*是否为克隆节点*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.isCloned = \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*是否有v-once指令*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.isOnce = \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E\n  }\n\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F DEPRECATED: alias for componentInstance for backwards compat.\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore next *\u002F\u003C\u002Fspan\u003E\n  get child (): Component | \u003Cspan class=\"hljs-keyword\"\u003Evoid\u003C\u002Fspan\u003E {\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Ethis\u003C\u002Fspan\u003E.componentInstance\n  }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E关于VNode的一些细节，请参考\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Fblob\u002Fmaster\u002Fdocs\u002FVNode%E8%8A%82%E7%82%B9.MarkDown\"\u003EVNode节点\u003C\u002Fa\u003E。\u003C\u002Fp\u003E\n\u003Ch2 id=\"createcompiler\"\u003EcreateCompiler\u003C\u002Fh2\u003E\n\u003Cp\u003EcreateCompiler用以创建编译器，返回值是compile以及compileToFunctions。compile是一个编译器，它会将传入的template转换成对应的AST树、render函数以及staticRenderFns函数。而compileToFunctions则是带缓存的编译器，同时staticRenderFns以及render函数会被转换成Funtion对象。\u003C\u002Fp\u003E\n\u003Cp\u003E因为不同平台有一些不同的options，所以createCompiler会根据平台区分传入一个baseOptions，会与compile本身传入的options合并得到最终的finalOptions。\u003C\u002Fp\u003E\n\u003Ch2 id=\"compiletofunctions\"\u003EcompileToFunctions\u003C\u002Fh2\u003E\n\u003Cp\u003E首先还是贴一下compileToFunctions的代码。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E  \u003Cspan class=\"hljs-comment\"\u003E\u002F*带缓存的编译器，同时staticRenderFns以及render函数会被转换成Funtion对象*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EcompileToFunctions\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-params\"\u003E\n    template: string,\n    options?: CompilerOptions,\n    vm?: Component\n  \u003C\u002Fspan\u003E): \u003Cspan class=\"hljs-title\"\u003ECompiledFunctionResult\u003C\u002Fspan\u003E \u003C\u002Fspan\u003E{\n    options = options || {}\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F detect possible CSP restriction\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Etry\u003C\u002Fspan\u003E {\n        \u003Cspan class=\"hljs-keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-built_in\"\u003EFunction\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-string\"\u003E'return 1'\u003C\u002Fspan\u003E)\n      } \u003Cspan class=\"hljs-keyword\"\u003Ecatch\u003C\u002Fspan\u003E (e) {\n        \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (e.toString().match(\u003Cspan class=\"hljs-regexp\"\u003E\u002Funsafe-eval|CSP\u002F\u003C\u002Fspan\u003E)) {\n          warn(\n            \u003Cspan class=\"hljs-string\"\u003E'It seems you are using the standalone build of Vue.js in an '\u003C\u002Fspan\u003E +\n            \u003Cspan class=\"hljs-string\"\u003E'environment with Content Security Policy that prohibits unsafe-eval. '\u003C\u002Fspan\u003E +\n            \u003Cspan class=\"hljs-string\"\u003E'The template compiler cannot work in this environment. Consider '\u003C\u002Fspan\u003E +\n            \u003Cspan class=\"hljs-string\"\u003E'relaxing the policy to allow unsafe-eval or pre-compiling your '\u003C\u002Fspan\u003E +\n            \u003Cspan class=\"hljs-string\"\u003E'templates into render functions.'\u003C\u002Fspan\u003E\n          )\n        }\n      }\n    }\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*Github:https:\u002F\u002Fgithub.com\u002Fanswershuto*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F check cache\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*有缓存的时候直接取出缓存中的结果即可*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E key = options.delimiters\n      ? \u003Cspan class=\"hljs-built_in\"\u003EString\u003C\u002Fspan\u003E(options.delimiters) + template\n      : template\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (functionCompileCache[key]) {\n      \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E functionCompileCache[key]\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F compile\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*编译*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E compiled = compile(template, options)\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F check compilation errors\u002Ftips\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E) {\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (compiled.errors &amp;&amp; compiled.errors.length) {\n        warn(\n          \u003Cspan class=\"hljs-string\"\u003E`Error compiling template:\\n\\n\u003Cspan class=\"hljs-subst\"\u003E${template}\u003C\u002Fspan\u003E\\n\\n`\u003C\u002Fspan\u003E +\n          compiled.errors.map(\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-params\"\u003Ee\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E`- \u003Cspan class=\"hljs-subst\"\u003E${e}\u003C\u002Fspan\u003E`\u003C\u002Fspan\u003E).join(\u003Cspan class=\"hljs-string\"\u003E'\\n'\u003C\u002Fspan\u003E) + \u003Cspan class=\"hljs-string\"\u003E'\\n'\u003C\u002Fspan\u003E,\n          vm\n        )\n      }\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (compiled.tips &amp;&amp; compiled.tips.length) {\n        compiled.tips.forEach(\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-params\"\u003Emsg\u003C\u002Fspan\u003E =&gt;\u003C\u002Fspan\u003E tip(msg, vm))\n      }\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F turn code into functions\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E res = {}\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E fnGenErrors = []\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*将render转换成Funtion对象*\u002F\u003C\u002Fspan\u003E\n    res.render = makeFunction(compiled.render, fnGenErrors)\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*将staticRenderFns全部转化成Funtion对象 *\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E l = compiled.staticRenderFns.length\n    res.staticRenderFns = \u003Cspan class=\"hljs-keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-built_in\"\u003EArray\u003C\u002Fspan\u003E(l)\n    \u003Cspan class=\"hljs-keyword\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-keyword\"\u003Elet\u003C\u002Fspan\u003E i = \u003Cspan class=\"hljs-number\"\u003E0\u003C\u002Fspan\u003E; i &lt; l; i++) {\n      res.staticRenderFns[i] = makeFunction(compiled.staticRenderFns[i], fnGenErrors)\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F check function generation errors.\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F this should only happen if there is a bug in the compiler itself.\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F mostly for codegen development use\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F* istanbul ignore if *\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E) {\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E ((!compiled.errors || !compiled.errors.length) &amp;&amp; fnGenErrors.length) {\n        warn(\n          \u003Cspan class=\"hljs-string\"\u003E`Failed to generate render function:\\n\\n`\u003C\u002Fspan\u003E +\n          fnGenErrors.map(\u003Cspan class=\"hljs-function\"\u003E(\u003Cspan class=\"hljs-params\"\u003E{ err, code }\u003C\u002Fspan\u003E) =&gt;\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E`\u003Cspan class=\"hljs-subst\"\u003E${err.toString()}\u003C\u002Fspan\u003E in\\n\\n\u003Cspan class=\"hljs-subst\"\u003E${code}\u003C\u002Fspan\u003E\\n`\u003C\u002Fspan\u003E).join(\u003Cspan class=\"hljs-string\"\u003E'\\n'\u003C\u002Fspan\u003E),\n          vm\n        )\n      }\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*存放在缓存中，以免每次都重新编译*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E (functionCompileCache[key] = res) \n  }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E我们可以发现，在闭包中，会有一个functionCompileCache对象作为缓存器。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E  \u003Cspan class=\"hljs-comment\"\u003E\u002F*作为缓存，防止每次都重新编译*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E functionCompileCache: {\n    [key: string]: CompiledFunctionResult;\n  } = \u003Cspan class=\"hljs-built_in\"\u003EObject\u003C\u002Fspan\u003E.create(\u003Cspan class=\"hljs-literal\"\u003Enull\u003C\u002Fspan\u003E)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E在进入compileToFunctions以后，会先检查缓存中是否有已经编译好的结果，如果有结果则直接从缓存中读取。这样做防止每次同样的模板都要进行重复的编译工作。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F check cache\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*有缓存的时候直接取出缓存中的结果即可*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E key = options.delimiters\n      ? \u003Cspan class=\"hljs-built_in\"\u003EString\u003C\u002Fspan\u003E(options.delimiters) + template\n      : template\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (functionCompileCache[key]) {\n      \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E functionCompileCache[key]\n    }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E在compileToFunctions的末尾会将编译结果进行缓存\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E  \u003Cspan class=\"hljs-comment\"\u003E\u002F*存放在缓存中，以免每次都重新编译*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E (functionCompileCache[key] = res)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2 id=\"compile\"\u003Ecompile\u003C\u002Fh2\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E  \u003Cspan class=\"hljs-comment\"\u003E\u002F*编译，将模板template编译成AST树、render函数以及staticRenderFns函数*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003Ecompile\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-params\"\u003E\n    template: string,\n    options?: CompilerOptions\n  \u003C\u002Fspan\u003E): \u003Cspan class=\"hljs-title\"\u003ECompiledResult\u003C\u002Fspan\u003E \u003C\u002Fspan\u003E{\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E finalOptions = \u003Cspan class=\"hljs-built_in\"\u003EObject\u003C\u002Fspan\u003E.create(baseOptions)\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E errors = []\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E tips = []\n    finalOptions.warn = \u003Cspan class=\"hljs-function\"\u003E(\u003Cspan class=\"hljs-params\"\u003Emsg, tip\u003C\u002Fspan\u003E) =&gt;\u003C\u002Fspan\u003E {\n      (tip ? tips : errors).push(msg)\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*做下面这些merge的目的因为不同平台可以提供自己本身平台的一个baseOptions，内部封装了平台自己的实现，然后把共同的部分抽离开来放在这层compiler中，所以在这里需要merge一下*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (options) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F merge custom modules\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F*合并modules*\u002F\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (options.modules) {\n        finalOptions.modules = (baseOptions.modules || []).concat(options.modules)\n      }\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F merge custom directives\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (options.directives) {\n        \u003Cspan class=\"hljs-comment\"\u003E\u002F*合并directives*\u002F\u003C\u002Fspan\u003E\n        finalOptions.directives = extend(\n          \u003Cspan class=\"hljs-built_in\"\u003EObject\u003C\u002Fspan\u003E.create(baseOptions.directives),\n          options.directives\n        )\n      }\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F copy other options\u003C\u002Fspan\u003E\n      \u003Cspan class=\"hljs-keyword\"\u003Efor\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E key \u003Cspan class=\"hljs-keyword\"\u003Ein\u003C\u002Fspan\u003E options) {\n        \u003Cspan class=\"hljs-comment\"\u003E\u002F*合并其余的options，modules与directives已经在上面做了特殊处理了*\u002F\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (key !== \u003Cspan class=\"hljs-string\"\u003E'modules'\u003C\u002Fspan\u003E &amp;&amp; key !== \u003Cspan class=\"hljs-string\"\u003E'directives'\u003C\u002Fspan\u003E) {\n          finalOptions[key] = options[key]\n        }\n      }\n    }\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F*基础模板编译，得到编译结果*\u002F\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E compiled = baseCompile(template, finalOptions)\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (process.env.NODE_ENV !== \u003Cspan class=\"hljs-string\"\u003E'production'\u003C\u002Fspan\u003E) {\n      errors.push.apply(errors, detectErrors(compiled.ast))\n    }\n    compiled.errors = errors\n    compiled.tips = tips\n    \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E compiled\n  }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Ecompile主要做了两件事，一件是合并option（前面说的将平台自有的option与传入的option进行合并），另一件是baseCompile，进行模板template的编译。\u003C\u002Fp\u003E\n\u003Cp\u003E来看一下baseCompile\u003C\u002Fp\u003E\n\u003Ch2 id=\"basecompile\"\u003EbaseCompile\u003C\u002Fh2\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EbaseCompile\u003C\u002Fspan\u003E (\u003Cspan class=\"hljs-params\"\u003E\n  template: string,\n  options: CompilerOptions\n\u003C\u002Fspan\u003E): \u003Cspan class=\"hljs-title\"\u003ECompiledResult\u003C\u002Fspan\u003E \u003C\u002Fspan\u003E{\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*parse解析得到ast树*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E ast = parse(template.trim(), options)\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*\n    将AST树进行优化\n    优化的目标：生成模板AST树，检测不需要进行DOM改变的静态子树。\n    一旦检测到这些静态树，我们就能做以下这些事情：\n    1.把它们变成常数，这样我们就再也不需要每次重新渲染时创建新的节点了。\n    2.在patch的过程中直接跳过。\n *\u002F\u003C\u002Fspan\u003E\n  optimize(ast, options)\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*根据ast树生成所需的code（内部包含render与staticRenderFns）*\u002F\u003C\u002Fspan\u003E\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E code = generate(ast, options)\n  \u003Cspan class=\"hljs-keyword\"\u003Ereturn\u003C\u002Fspan\u003E {\n    ast,\n    \u003Cspan class=\"hljs-attr\"\u003Erender\u003C\u002Fspan\u003E: code.render,\n    \u003Cspan class=\"hljs-attr\"\u003EstaticRenderFns\u003C\u002Fspan\u003E: code.staticRenderFns\n  }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EbaseCompile首先会将模板template进行parse得到一个AST语法树，再通过optimize做一些优化，最后通过generate得到render以及staticRenderFns。\u003C\u002Fp\u003E\n\u003Ch3 id=\"parse\"\u003Eparse\u003C\u002Fh3\u003E\n\u003Cp\u003Eparse的源码可以参见\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Fblob\u002Fmaster\u002Fvue-src\u002Fcompiler\u002Fparser\u002Findex.js#L53\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Fblob\u002Fmaster\u002Fvue-src\u002Fcompiler\u002Fparser\u002Findex.js#L53\u003C\u002Fa\u003E。\u003C\u002Fp\u003E\n\u003Cp\u003Eparse会用正则等方式解析template模板中的指令、class、style等数据，形成AST语法树。\u003C\u002Fp\u003E\n\u003Ch3 id=\"optimize\"\u003Eoptimize\u003C\u002Fh3\u003E\n\u003Cp\u003Eoptimize的主要作用是标记static静态节点，这是Vue在编译过程中的一处优化，后面当update更新界面时，会有一个patch的过程，diff算法会直接跳过静态节点，从而减少了比较的过程，优化了patch的性能。\u003C\u002Fp\u003E\n\u003Ch3 id=\"generate\"\u003Egenerate\u003C\u002Fh3\u003E\n\u003Cp\u003Egenerate是将AST语法树转化成render funtion字符串的过程，得到结果是render的字符串以及staticRenderFns字符串。\u003C\u002Fp\u003E\n\u003Chr\u003E\n\u003Cp\u003E至此，我们的template模板已经被转化成了我们所需的AST语法树、render function字符串以及staticRenderFns字符串。\u003C\u002Fp\u003E\n\u003Ch2 id=\"-\"\u003E举个例子\u003C\u002Fh2\u003E\n\u003Cp\u003E来看一下这段代码的编译结果\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs html\"\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Eclass\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E\"main\"\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003E:class\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E\"bindClass\"\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E{{text}}\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003Ehello world\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Ev-for\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E\"(item, index) in arr\"\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E{{item.name}}\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E{{item.value}}\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E{{index}}\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n        \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E---\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ep\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Ev-if\u003C\u002Fspan\u003E=\u003Cspan class=\"hljs-string\"\u003E\"text\"\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n        {{text}}\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-tag\"\u003E&lt;\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Ev-else\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-tag\"\u003E&lt;\u002F\u003Cspan class=\"hljs-name\"\u003Ediv\u003C\u002Fspan\u003E&gt;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E转化后得到AST树，如下图：\u003C\u002Fp\u003E\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cfigure\u003E\u003Cimg alt=\"img\" src=\"https:\u002F\u002Fuser-gold-cdn.xitu.io\u002F2017\u002F10\u002F8\u002F936953ce3bdbfd3f42852ef10c7ae13e\"\u003E\u003Cfigcaption\u003Eimg\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E我们可以看到最外层的div是这颗AST树的根节点，节点上有许多数据代表这个节点的形态，比如static表示是否是静态节点，staticClass表示静态class属性（非bind:class）。children代表该节点的子节点，可以看到children是一个长度为4的数组，里面包含的是该节点下的四个div子节点。children里面的节点与父节点的结构类似，层层往下形成一棵AST语法树。\u003C\u002Fp\u003E\n\u003Cp\u003E再来看看由AST得到的render函数\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003Ewith(this){\n    return _c(  'div',\n                {\n                    \u002F*static class*\u002F\n                    staticClass:\"main\",\n                    \u002F*bind class*\u002F\n                    class:bindClass\n                },\n                [\n                    _c( 'div', [_v(_s(text))]),\n                    _c('div',[_v(\"hello world\")]),\n                    \u002F*这是一个v-for循环*\u002F\n                    _l(\n                        (arr),\n                        function(item,index){\n                            return _c(  'div',\n                                        [_c('p',[_v(_s(item.name))]),\n                                        _c('p',[_v(_s(item.value))]),\n                                        _c('p',[_v(_s(index))]),\n                                        _c('p',[_v(\"---\")])]\n                                    )\n                        }\n                    ),\n                    \u002F*这是v-if*\u002F\n                    (text)?_c('div',[_v(_s(text))]):_c('div',[_v(\"no text\")])],\n                    2\n            )\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2 id=\"-_c-_v-_s-_q\"\u003E_c，_v，_s，_q\u003C\u002Fh2\u003E\n\u003Cp\u003E看了render function字符串，发现有大量的_c，_v，_s，_q，这些函数究竟是什么？\u003C\u002Fp\u003E\n\u003Cp\u003E带着问题，我们来看一下\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\u002FlearnVue\u002Fblob\u002Fmaster\u002Fvue-src\u002Fcore\u002Finstance\u002Frender.js#L124\"\u003Ecore\u002Finstance\u002Frender\u003C\u002Fa\u003E。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"hljs javascript\"\u003E\u003Cspan class=\"hljs-comment\"\u003E\u002F*处理v-once的渲染函数*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._o = markOnce\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*将字符串转化为数字，如果转换失败会返回原字符串*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._n = toNumber\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*将val转化成字符串*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._s = toString\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理v-for列表渲染*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._l = renderList\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理slot的渲染*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._t = renderSlot\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*检测两个变量是否相等*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._q = looseEqual\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*检测arr数组中是否包含与val变量相等的项*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._i = looseIndexOf\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理static树的渲染*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._m = renderStatic\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理filters*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._f = resolveFilter\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*从config配置中检查eventKeyCode是否存在*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._k = checkKeyCodes\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*合并v-bind指令到VNode中*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._b = bindObjectProps\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*创建一个文本节点*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._v = createTextVNode\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*创建一个空VNode节点*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._e = createEmptyVNode\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*处理ScopedSlots*\u002F\u003C\u002Fspan\u003E\n  Vue.prototype._u = resolveScopedSlots\n\n  \u003Cspan class=\"hljs-comment\"\u003E\u002F*创建VNode节点*\u002F\u003C\u002Fspan\u003E\n  vm._c = \u003Cspan class=\"hljs-function\"\u003E(\u003Cspan class=\"hljs-params\"\u003Ea, b, c, d\u003C\u002Fspan\u003E) =&gt;\u003C\u002Fspan\u003E createElement(vm, a, b, c, d, \u003Cspan class=\"hljs-literal\"\u003Efalse\u003C\u002Fspan\u003E)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E通过这些函数，render函数最后会返回一个VNode节点，在_update的时候，经过patch与之前的VNode节点进行比较，得出差异后将这些差异渲染到真实的DOM上。\u003C\u002Fp\u003E\n\u003Ch2 id=\"-\"\u003E关于\u003C\u002Fh2\u003E\n\u003Cp\u003E作者：染陌 \u003C\u002Fp\u003E\n\u003Cp\u003EEmail：answershuto@gmail.com  or  answershuto@126.com\u003C\u002Fp\u003E\n\u003Cp\u003EGithub:  \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fanswershuto\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fanswershuto\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EBlog：\u003Ca href=\"http:\u002F\u002Fanswershuto.github.io\u002F\"\u003Ehttp:\u002F\u002Fanswershuto.github.io\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E知乎主页：\u003Ca href=\"https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002Fcao-yang-49\u002Factivities\"\u003Ehttps:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002Fcao-yang-49\u002Factivities\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E知乎专栏：\u003Ca href=\"https:\u002F\u002Fzhuanlan.zhihu.com\u002Franmo\"\u003Ehttps:\u002F\u002Fzhuanlan.zhihu.com\u002Franmo\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E掘金： \u003Ca href=\"https:\u002F\u002Fjuejin.im\u002Fuser\u002F289926769027053\"\u003Ehttps:\u002F\u002Fjuejin.im\u002Fuser\u002F289926769027053\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EosChina：\u003Ca href=\"https:\u002F\u002Fmy.oschina.net\u002Fu\u002F3161824\u002Fblog\"\u003Ehttps:\u002F\u002Fmy.oschina.net\u002Fu\u002F3161824\u002Fblog\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E转载请注明出处，谢谢。\u003C\u002Fp\u003E\n\u003Cp\u003E欢迎关注我的公众号\u003C\u002Fp\u003E\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cfigure\u003E\u003Cimg alt=\"\" src=\"https:\u002F\u002Fuser-gold-cdn.xitu.io\u002F2017\u002F9\u002F24\u002F99de30e7ef948aabf132e91d543807a0\"\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003C\u002Fp\u003E\n",originalUrl:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F6844903502196506631",type:"post",collected:a,viewsCount:7962,username:"染陌同学",viewerHasLiked:a,draftId:"6845075308366823437",collectionCount:d},entryView:{},author:{id:"289926769027053",self_description:void 0,followed:a,viewerIsFollowing:void 0,community:void 0,subscribedTagCount:d,wroteBookCount:d,boughtBookCount:d,isBindedPhone:a,level:3,user_id:"289926769027053",user_name:"染陌同学",company:"Alibaba",job_title:"前端工程师",avatar_large:"https:\u002F\u002Fmirror-gold-cdn.xitu.io\u002F168e0848e3909ec96a7",description:e,followee_count:115,follower_count:9803,post_article_count:28,digg_article_count:154,got_digg_count:3934,got_view_count:163058,post_shortmsg_count:36,digg_shortmsg_count:140,isfollowed:a,favorable_author:h,power:4550,study_point:d,university:b,major:b,student_status:d,select_event_count:d,select_online_course_count:d,identity:d,juejinPower:4550,jobTitle:"前端工程师",roles:{isBookAuthor:a,isFavorableAuthor:c,isCobuilder:a,isAdmin:a},username:"染陌同学",blogAddress:void 0,selfDescription:e,beLikedCount:3934,beReadCount:163058,followerCount:9803,followingCount:115,collectionCount:d,createdCollectionCount:d,followingCollectionCount:d,postedPostsCount:28,pinCount:36,likedArticleCount:154,likedPinCount:140,avatar:"https:\u002F\u002Fmirror-gold-cdn.xitu.io\u002F168e0848e3909ec96a7",latestLoginedInAt:b,createdAt:b,updatedAt:b,phoneNumber:e,titleDescription:e,followeesCount:115,applyEventCount:d},adEntryList:[],relatedEntryList:[],actionType:{FETCH:"view\u002Fcolumn\u002FFETCH",FETCH_ADDITIONAL:"view\u002Fcolumn\u002FFETCH_ADDITIONAL",FETCH_SIDEBAR_ADENTRY:"view\u002Fcolumn\u002FFETCH_SIDEBAR_ADENTRY",RESET:"view\u002Fcolumn\u002FRESET"},recommendedArticleList:{list:[],tagIds:[],cursor:f,loading:a,skeleton:a,hasMore:a,articleId:e,actionType:{UPDATE_STATE:"view\u002Fcolumn\u002Frecommend-List\u002FUPDATE_STATE",FETCH_MORE:"view\u002Fcolumn\u002Frecommend-List\u002FFETCH_MORE",FETCH:"view\u002Fcolumn\u002Frecommend-List\u002FFETCH",RESET:"view\u002Fcolumn\u002Frecommend-List\u002FRESET"}}},collection:{collection:{author:{}},actionType:{FETCH:"@\u002Fview\u002Fcollection\u002FFETCH",REFRESH:"@\u002Fview\u002Fcollection\u002FREFRESH",RESET:"@\u002Fview\u002Fcollection\u002FRESET"},list:{pageSize:g,page:h,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fcollection\u002Flist\u002FUPDATE",FETCH:"@\u002Fview\u002Fcollection\u002Flist\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fcollection\u002Flist\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fcollection\u002Flist\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fcollection\u002Flist\u002FRESET"},id:e,sort:o}},gettingStarted:{category:{},actionType:{UPDATE_STATE:"@\u002Fview\u002FgettingStarted\u002FUPDATE_STATE",FOLLOW:"@\u002Fview\u002FgettingStarted\u002FFOLLOW",RESET:"@\u002Fview\u002FgettingStarted\u002FRESET",UPDATE_CATEGORY:"@\u002Fview\u002FgettingStarted\u002FUPDATE_CATEGORY"}},pin:{pin:{user:{},imageUrlList:[]},pinList:[],actionType:{FETCH:"@\u002Fview\u002Fpin\u002FFETCH",RESET:"@\u002Fview\u002Fpin\u002FRESET"},sidebar:{list:[],after:e,loading:a,isRecommend:a,hasNextPage:c,actionType:{UPDATE_STATE:"@\u002Fview\u002Fpin\u002Fsidebar\u002FUPDATE_STATE",FETCH_MORE:"@\u002Fview\u002Fpin\u002Fsidebar\u002FFETCH_MORE",FETCH:"@\u002Fview\u002Fpin\u002Fsidebar\u002FFETCH",RESET:"@\u002Fview\u002Fpin\u002Fsidebar\u002FRESET"}},commentList:{pageSize:g,page:h,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fpin\u002FcommentList\u002FUPDATE",FETCH:"@\u002Fview\u002Fpin\u002FcommentList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fpin\u002FcommentList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fpin\u002FcommentList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fpin\u002FcommentList\u002FRESET"},pinId:b},subCommentList:{pageSize:g,page:h,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FUPDATE",FETCH:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Fpin\u002FsubCommentList\u002FRESET"},commentId:b}},topic:{topic:e,followedTopicList:[],actionType:{FETCH:"@\u002Fview\u002Ftopic\u002FFETCH",UPDATE_STATE:"@\u002Fview\u002Ftopic\u002FUPDATE_STATE",RESET:"@\u002Fview\u002Ftopic\u002FRESET"},allTopicList:{pageSize:r,page:d,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002FallTopicList\u002FRESET"},sortType:k},pinlist:{pageSize:g,page:h,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002FpinList\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002FpinList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002FpinList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002FpinList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002FpinList\u002FRESET"},sortType:m},sidebar:{actionType:{RESET:"@\u002Fview\u002Ftopic\u002Fsidebar\u002FRESET",UPDATE_STATE:"@\u002Fview\u002Ftopic\u002Fsidebar\u002FUPDATE_STATE"},attender:{pageSize:g,page:h,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002Fsidebar\u002Fattender\u002FRESET"},topicId:b}},followedList:{pageSize:r,page:d,total:d,pointer:b,lastPointer:b,list:[],loading:a,error:b,canPrev:c,canNext:c,linkList:[],lastFetchOnServer:a,actionType:{UPDATE:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FUPDATE",FETCH:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FFETCH",FORCE_FETCH:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FFORCE_FETCH",FETCH_MORE:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FFETCH_MORE",RESET:"@\u002Fview\u002Ftopic\u002FfollowedList\u002FRESET"},after:d}},recommendationIndex:{actionType:{FETCH_USER:"@\u002Fview\u002Frecommendation\u002FFETCH_USER",FETCH_MORE:"@\u002Fview\u002Frecommendation\u002FFETCH_MORE",RESET:"@\u002Fview\u002Frecommendation\u002FRESET",FETCH:"@\u002Fview\u002Frecommendation\u002FFETCH"},cursor:e,hasMore:e,userList:[],loading:a,skeleton:c,category:j,categoryNavList:[]},event:{event:{},loading:a,user:{},actionType:{FETCH:"view\u002Fevent\u002FFETCH",RESET:"view\u002Fevent\u002FRESET"}},academyIndex:{academy:{},bannerList:[],qualitiedList:[],latestList:[],offlineList:[],loading:a,user:{},actionType:{FETCH:"view\u002Facademy\u002FFETCH",RESET:"view\u002Facademy\u002FRESET"}},coursesIndex:{loading:a,list:[],sort:"online",actionType:{FETCH:"view\u002Fcourses\u002FFETCH",RESET:"view\u002Fcourses\u002FRESET",FETCH_MORE:"view\u002Fcourses\u002FFETCH_MORE"}}},component:{indexAside:{bannerList:[],userList:[],actionType:{FETCH_BANNER:"@\u002Fcomponent\u002Faside\u002FFETCH_BANNER",FETCH_USER:"@\u002Fcomponent\u002Faside\u002FFETCH_USER",CLOSE_BANNER:"@\u002Fcomponent\u002Faside\u002FCLOSE_BANNER"}}},auth:{user:b,clientId:e,token:e},tag:{subscribedTagList:[]},entry:{isLikeLoading:a},collection:{},comment:{},bookComment:{},repoComment:{},category:{list:[]},user:{subscribedTagList:[]},notification:{unreadCount:{user:d,system:d,total:d}},follow:{subscribedTagList:[]},error:{location:b,errorView:b,statusCode:200},abTest:{info:{}},suspensionPanel:{needSuspension:c},pinComment:{},pin:{deleteDialogVisible:a,reportDialogVisible:a,targetPin:b,isOnFocus:a},topic:{visible:a},route:{name:"column",path:p,hash:e,query:{},params:{id:q},fullPath:p,meta:{},from:{name:b,path:s,hash:e,query:{},params:{},fullPath:s,meta:{}}}},serverRendered:c,routePath:p,config:{API_HOST:"api.juejin.cn",CAPTCHA_HOST:"verify.snssdk.com",PLATFORM_APPID:{wechat:1277,weibo:1276,github:1045,wechatApp:1070}}}}(false,null,true,0,"","0",20,1,"topic","recommended","hot","following","popular","all","newest","\u002Fpost\u002F6844903502196506631","6844903502196506631",100,"\u002F"));</script><script src="//s3.pstatp.com/toutiao/xitu_juejin_web/runtime.796cbbc.js" defer></script><script src="//s3.pstatp.com/toutiao/xitu_juejin_web/layouts/default.be35d34.js" defer></script><script src="//s3.pstatp.com/toutiao/xitu_juejin_web/commons/layouts.default.57a59a5.js" defer></script><script src="//s3.pstatp.com/toutiao/xitu_juejin_web/17.0da3d5d.js" defer></script><script src="//s3.pstatp.com/toutiao/xitu_juejin_web/commons/.7974887.js" defer></script><script src="//s3.pstatp.com/toutiao/xitu_juejin_web/commons/app.3b100c6.js" defer></script><script src="//s3.pstatp.com/toutiao/xitu_juejin_web/vendors~app.204899d.js" defer></script><script src="//s3.pstatp.com/toutiao/xitu_juejin_web/app.093ff49.js" defer></script>
  </body>
</html>
